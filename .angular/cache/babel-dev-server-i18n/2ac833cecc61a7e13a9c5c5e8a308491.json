{"ast":null,"code":"import { DatePipe } from '@angular/common';\nimport { LOCALE_ID } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { isEqual, map } from 'lodash-es';\nimport { diff } from 'src/app/libraries/diffArrayObjects.interface';\nimport { distinctUntilChanged, take } from 'rxjs/operators';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"src/app/genral.service\";\nimport * as i4 from \"@angular/material/snack-bar\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"../../libraries/numeric.directive\";\nimport * as i8 from \"@angular/material/button\";\n\nfunction MaterialUsageComponent_div_1_ng_container_2_th_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", column_r8.label, \" \");\n  }\n}\n\nfunction MaterialUsageComponent_div_1_ng_container_2_td_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 15);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const element_r12 = ctx.$implicit;\n    const column_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r12[column_r8.name], \" \");\n  }\n}\n\nfunction MaterialUsageComponent_div_1_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0, 12);\n    i0.ɵɵtemplate(1, MaterialUsageComponent_div_1_ng_container_2_th_1_Template, 2, 1, \"th\", 6);\n    i0.ɵɵtemplate(2, MaterialUsageComponent_div_1_ng_container_2_td_2_Template, 2, 1, \"td\", 13);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const column_r8 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"matColumnDef\", column_r8.name);\n  }\n}\n\nfunction MaterialUsageComponent_div_1_th_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 14);\n    i0.ɵɵi18n(1, 16);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MaterialUsageComponent_div_1_td_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 17);\n    i0.ɵɵelementStart(1, \"mat-form-field\", 18);\n    i0.ɵɵelement(2, \"input\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r15 = ctx.index;\n    i0.ɵɵproperty(\"formGroupName\", i_r15);\n  }\n}\n\nfunction MaterialUsageComponent_div_1_th_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"th\", 14);\n  }\n}\n\nfunction MaterialUsageComponent_div_1_td_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵelementStart(1, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function MaterialUsageComponent_div_1_td_8_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const i_r17 = restoredCtx.index;\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return ctx_r18.openDialog(i_r17);\n    });\n    i0.ɵɵi18n(2, 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r17 = ctx.index;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r5.dataSource[i_r17][\"unitAmount\"] === null || ctx_r5.dataSource[i_r17][\"unitAmount\"] === 1);\n  }\n}\n\nfunction MaterialUsageComponent_div_1_tr_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 23);\n  }\n}\n\nfunction MaterialUsageComponent_div_1_tr_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 24);\n  }\n}\n\nfunction MaterialUsageComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelementStart(1, \"table\", 3);\n    i0.ɵɵtemplate(2, MaterialUsageComponent_div_1_ng_container_2_Template, 3, 1, \"ng-container\", 4);\n    i0.ɵɵelementContainerStart(3, 5);\n    i0.ɵɵtemplate(4, MaterialUsageComponent_div_1_th_4_Template, 2, 0, \"th\", 6);\n    i0.ɵɵtemplate(5, MaterialUsageComponent_div_1_td_5_Template, 3, 1, \"td\", 7);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(6, 8);\n    i0.ɵɵtemplate(7, MaterialUsageComponent_div_1_th_7_Template, 1, 0, \"th\", 6);\n    i0.ɵɵtemplate(8, MaterialUsageComponent_div_1_td_8_Template, 3, 1, \"td\", 9);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(9, MaterialUsageComponent_div_1_tr_9_Template, 1, 0, \"tr\", 10);\n    i0.ɵɵtemplate(10, MaterialUsageComponent_div_1_tr_10_Template, 1, 0, \"tr\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.group);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"dataSource\", ctx_r0.dataSource)(\"formArrayName\", ctx_r0.field.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.oneColumns);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r0.displayedColumns);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r0.displayedColumns);\n  }\n}\n\nexport class MaterialUsageComponent {\n  constructor(locale, fb, dialog, genral, _snackBar) {\n    this.locale = locale;\n    this.fb = fb;\n    this.dialog = dialog;\n    this.genral = genral;\n    this._snackBar = _snackBar;\n    this.choosedItems = [];\n    this.productItems = [];\n    this.displayedColumns = [];\n    this.oneColumns = [];\n  }\n\n  ngOnInit() {\n    this.form = this.fb.group({});\n    this.form.addControl('items', this.fb.array([this.fb.group({\n      item: null\n    })]));\n    this.form.get('items').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\n      selectedValue = selectedValue.filter(ele => ele.item && ele.item.id);\n      selectedValue = map(selectedValue, 'item');\n\n      if (selectedValue.length && !isEqual(selectedValue, this.choosedItems)) {\n        var result = diff(this.choosedItems, selectedValue, 'id', {\n          updatedValues: 1\n        });\n        result['added'].forEach(el => {\n          this.genral.getStorageGeneralItem(el.id).pipe(take(1)).subscribe(val => {\n            this.addToForm(val);\n          });\n        });\n        this.choosedItems = selectedValue;\n      }\n    });\n    this.itemConfig = {\n      type: 'bigexpand',\n      name: 'items',\n      label: \"Item\",\n      options: 'aloneInline',\n      collections: [{\n        type: 'select',\n        label: \"Item descrption\",\n        name: 'item',\n        options: this.genral.findAvailableItems(),\n        collections: 'somewhere'\n      }, {\n        type: 'divider',\n        inputType: 'divide'\n      }]\n    };\n    this.dataSource = this.group.get(this.field.name).value;\n    this.columnsSetup(this.field);\n    this.kidSetup(this.field);\n  }\n\n  columnsSetup(tempField) {\n    tempField.collections.forEach(element => {\n      switch (element.type) {\n        case 'selectgroup':\n          this.oneColumns.push(element.collections[0]);\n          this.displayedColumns.push(element.inputType);\n          this.oneColumns.push(element.collections[1]);\n          this.displayedColumns.push(element.collections[1].name);\n          break;\n\n        case 'inputselect':\n          if (element.name) {\n            this.oneColumns.push(element);\n            this.displayedColumns.push(element.name);\n          } else {\n            this.oneColumns.push(element.collections[0]);\n            this.displayedColumns.push(element.collections[0].name);\n            this.oneColumns.push(element.collections[1]);\n            this.displayedColumns.push(element.collections[1].name);\n          }\n\n          break;\n\n        case 'bignotexpand':\n          element.collections.forEach(el => {\n            this.oneColumns.push(el);\n            this.displayedColumns.push(el.name);\n          });\n          break;\n\n        default:\n          this.oneColumns.push(element);\n          this.displayedColumns.push(element.name);\n          break;\n      }\n    });\n    this.displayedColumns.push('inputField');\n    this.displayedColumns.push('weightAmount');\n\n    if (tempField.inputType) {\n      this.group.parent.parent.get('processItemsNormal').valueChanges.pipe(distinctUntilChanged()).subscribe(arr => {\n        arr.forEach(ele => {\n          if (ele && ele['item'] && ele['item']['id'] && !this.productItems.includes(ele['item']['id'])) {\n            this.productItems.push(ele['item']['id']);\n            this.genral.getProductBomInventoryMissing(ele['item']['id']).pipe(take(1)).subscribe(val => {\n              if (val) {\n                this.inputFromParentItem(val);\n              }\n            });\n          }\n        });\n      });\n      this.group.parent.parent.get('processItemsTable').valueChanges.pipe(distinctUntilChanged()).subscribe(arr => {\n        arr.forEach(ele => {\n          if (ele && ele['item'] && ele['item']['id'] && !this.productItems.includes(ele['item']['id'])) {\n            this.productItems.push(ele['item']['id']);\n            this.genral.getProductBomInventoryMissing(ele['item']['id']).pipe(take(1)).subscribe(val => {\n              if (val) {\n                this.inputFromParentItem(val);\n              }\n            });\n          }\n        });\n      });\n    }\n  }\n\n  inputFromParentItem(val) {\n    this.addToForm(val[0]);\n\n    if (val[1].length) {\n      this.genral.getItemsGeneral().pipe(take(1)).subscribe(proucts => {\n        this._snackBar.open(proucts.filter(a => val[1].includes(a['id'])).map(c => c['value']).join(', ') + \" are missing from inventory\", 'ok', {\n          duration: 5000,\n          // panelClass: 'blue-snackbar',\n          verticalPosition: 'top'\n        });\n      });\n    }\n  }\n\n  kidSetup(tempField) {\n    tempField.collections.forEach(element => {\n      switch (element.type) {\n        // case 'array':\n        //     break;\n        case 'select':\n        case 'selectNormal':\n          if (element.inputType === 'multiple') {\n            this.dataSource.forEach(ele => {\n              ele[element.name] = 'arr';\n            });\n          } else {\n            this.dataSource.forEach(ele => {\n              ele[element.name] = ele[element.name] ? ele[element.name]['value'] : '';\n            });\n          }\n\n          break;\n\n        case 'selectgroup':\n          element.collections[0]['name'] = element.inputType;\n          this.dataSource.forEach(ele => {\n            const newGroup = ele[element.collections[1].name];\n            ele[element.collections[0].name] = newGroup[element.inputType];\n            ele[element.collections[1].name] = newGroup.value;\n          });\n          break;\n\n        case 'inputselect':\n          if (element.name) {\n            this.dataSource.forEach(ele => {\n              const newGroup = ele[element.name];\n              ele[element.name] = newGroup[element.collections[0].name] + ' ' + newGroup[element.collections[1].name];\n            });\n          }\n\n          break;\n\n        case 'bignotexpand':\n          this.dataSource.forEach(ele => {\n            const biggroup = ele[element.name];\n            element.collections.forEach(el => {\n              switch (el.type) {\n                case 'select' || 'selectNormal':\n                  if (el.inputType === 'multiple') {\n                    ele[el.name] = 'arr';\n                  } else {\n                    ele[el.name] = biggroup[el.name] ? biggroup[el.name]['value'] : '';\n                  }\n\n                  break;\n\n                case 'inputselect':\n                  if (el.name) {\n                    const newGroup = biggroup[el.name];\n                    ele[el.name] = newGroup[el.collections[0].name] + ' ' + newGroup[el.collections[1].name];\n                  } else {\n                    ele[el.name] = biggroup[el.name];\n                  }\n\n                  break;\n\n                default:\n                  ele[el.name] = biggroup[el.name];\n                  break;\n              }\n            });\n          });\n          break;\n\n        case 'date':\n          this.dataSource.forEach(ele => {\n            ele[element.name] = new DatePipe(this.locale).transform(ele[element.name]);\n          });\n\n        default:\n          break;\n      }\n    });\n  }\n\n  addToForm(val) {\n    const items = this.group.get([this.field.name]);\n    val === null || val === void 0 ? void 0 : val.forEach(element => {\n      if (element['storageForms']) {\n        element['storageForms'].forEach(ele => {\n          var obj = {\n            itemPo: element['poCode'],\n            item: element['item'],\n            itemProcessDate: element['itemProcessDate'],\n            measureUnit: element['measureUnit'],\n            storage: ele\n          };\n          var group2 = this.fb.group({});\n          items.push(group2);\n          this.createItem(group2, this.field, obj);\n        });\n      }\n    });\n    this.dataSource = this.group.get(this.field.name).value;\n    this.kidSetup(this.field);\n  }\n\n  createItem(group2, field, value) {\n    if (value.hasOwnProperty('id')) {\n      group2.addControl('id', this.fb.control(value['id'], null));\n    }\n\n    if (value.hasOwnProperty('version')) {\n      group2.addControl('version', this.fb.control(value['version'], null));\n    }\n\n    field.collections.forEach(kid => {\n      if (kid.type === 'bignotexpand') {\n        group2.addControl(kid.name, this.createBigNotExpand(kid, value.hasOwnProperty([kid.name]) ? value[kid.name] : {}));\n      } else if (kid.type === 'selectgroup') {\n        const control = this.fb.control(value.hasOwnProperty(kid.collections[1].name) ? value[kid.collections[1].name] : kid.value, null);\n        group2.addControl(kid.collections[1].name, control);\n      } else {\n        const control = this.fb.control(value.hasOwnProperty(kid.name) ? value[kid.name] : kid.value, null);\n        group2.addControl(kid.name, control);\n      }\n    });\n    group2.addControl('numberUsedUnits', this.fb.control(null, null));\n  }\n\n  createBigNotExpand(field, value) {\n    var group3 = this.fb.group({});\n\n    if (value.hasOwnProperty('id')) {\n      group3.addControl('id', this.fb.control(value['id'], null));\n    }\n\n    if (value.hasOwnProperty('version')) {\n      group3.addControl('version', this.fb.control(value['version'], null));\n    }\n\n    field.collections.forEach(kid => {\n      const control = this.fb.control(value.hasOwnProperty(kid.name) ? value[kid.name] : kid.value, null);\n      group3.addControl(kid.name, control);\n    });\n    return group3;\n  }\n\n  openDialog(index) {\n    const dialogRef = this.dialog.open(MaterialUsageDialog, {\n      data: {\n        weight: this.dataSource[index]['measureUnit']\n      }\n    });\n    dialogRef.afterClosed().subscribe(result => {\n      if (result) {\n        this.group.get([this.field.name]).at(index).get('numberUsedUnits').setValue(result / +this.dataSource[index]['unitAmount']);\n        this.group.get([this.field.name]).at(index).get('numberUsedUnits').markAsDirty();\n      }\n    });\n  }\n\n}\n\nMaterialUsageComponent.ɵfac = function MaterialUsageComponent_Factory(t) {\n  return new (t || MaterialUsageComponent)(i0.ɵɵdirectiveInject(LOCALE_ID), i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.Genral), i0.ɵɵdirectiveInject(i4.MatSnackBar));\n};\n\nMaterialUsageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MaterialUsageComponent,\n  selectors: [[\"material-usage\"]],\n  decls: 2,\n  vars: 3,\n  consts: function () {\n    let i18n_0;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_6261628999354556206$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___1 = goog.getMsg(\"Amount of units\");\n      i18n_0 = MSG_EXTERNAL_6261628999354556206$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___1;\n    } else {\n      i18n_0 = \"Amount of units\";\n    }\n\n    let i18n_2;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_8767732713336316989$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___3 = goog.getMsg(\"Weight amount\");\n      i18n_2 = MSG_EXTERNAL_8767732713336316989$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___3;\n    } else {\n      i18n_2 = \"Weight amount\";\n    }\n\n    return [[\"dynamicField\", \"\", 3, \"field\", \"group\"], [3, \"formGroup\", 4, \"ngIf\"], [3, \"formGroup\"], [\"mat-table\", \"\", 3, \"dataSource\", \"formArrayName\"], [3, \"matColumnDef\", 4, \"ngFor\", \"ngForOf\"], [\"matColumnDef\", \"inputField\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 3, \"formGroupName\", 4, \"matCellDef\"], [\"matColumnDef\", \"weightAmount\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [3, \"matColumnDef\"], [\"mat-cell\", \"\", \"style\", \"text-align: center\", 4, \"matCellDef\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\", 2, \"text-align\", \"center\"], i18n_0, [\"mat-cell\", \"\", 3, \"formGroupName\"], [1, \"one-field\"], [\"matInput\", \"\", \"formControlName\", \"numberUsedUnits\", \"numeric\", \"\", \"decimals\", \"3\", \"type\", \"text\", \"maxlength\", \"255\"], [\"mat-cell\", \"\"], [\"type\", \"button\", \"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"disabled\", \"click\"], i18n_2, [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]];\n  },\n  template: function MaterialUsageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementContainer(0, 0);\n      i0.ɵɵtemplate(1, MaterialUsageComponent_div_1_Template, 11, 6, \"div\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"field\", ctx.itemConfig)(\"group\", ctx.form);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.dataSource.length);\n    }\n  },\n  encapsulation: 2\n});\nexport class MaterialUsageDialog {\n  constructor(dialogRef, data) {\n    this.dialogRef = dialogRef;\n    this.data = data;\n    this.amountUsed = new FormControl('');\n    this.weight = data.weight;\n  }\n\n  submitAmount() {\n    this.dialogRef.close(this.amountUsed.value);\n  }\n\n  onNoClick() {\n    this.dialogRef.close(null);\n  }\n\n}\n\nMaterialUsageDialog.ɵfac = function MaterialUsageDialog_Factory(t) {\n  return new (t || MaterialUsageDialog)(i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA));\n};\n\nMaterialUsageDialog.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MaterialUsageDialog,\n  selectors: [[\"material-usage-dialog\"]],\n  decls: 10,\n  vars: 2,\n  consts: function () {\n    let i18n_4;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_8295165159424043148$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_5 = goog.getMsg(\"Amount in {$interpolation}\", {\n        \"interpolation\": \"\\uFFFD0\\uFFFD\"\n      });\n      i18n_4 = MSG_EXTERNAL_8295165159424043148$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_5;\n    } else {\n      i18n_4 = \"Amount in \" + \"\\uFFFD0\\uFFFD\" + \"\";\n    }\n\n    let i18n_6;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_3768927257183755959$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_7 = goog.getMsg(\"Save\");\n      i18n_6 = MSG_EXTERNAL_3768927257183755959$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_7;\n    } else {\n      i18n_6 = \"Save\";\n    }\n\n    let i18n_8;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_7819314041543176992$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_9 = goog.getMsg(\"Close\");\n      i18n_8 = MSG_EXTERNAL_7819314041543176992$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_9;\n    } else {\n      i18n_8 = \"Close\";\n    }\n\n    return [[\"mat-dialog-title\", \"\"], i18n_4, [1, \"one-field\"], [\"matInput\", \"\", \"cdkFocusInitial\", \"\", \"numeric\", \"\", \"decimals\", \"3\", \"placeholder\", \"Amount\", \"type\", \"text\", 3, \"formControl\"], [\"align\", \"end\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"click\"], i18n_6, i18n_8];\n  },\n  template: function MaterialUsageDialog_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\", 0);\n      i0.ɵɵi18n(1, 1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"mat-dialog-content\");\n      i0.ɵɵelementStart(3, \"mat-form-field\", 2);\n      i0.ɵɵelement(4, \"input\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"mat-dialog-actions\", 4);\n      i0.ɵɵelementStart(6, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function MaterialUsageDialog_Template_button_click_6_listener() {\n        return ctx.submitAmount();\n      });\n      i0.ɵɵi18n(7, 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function MaterialUsageDialog_Template_button_click_8_listener() {\n        return ctx.onNoClick();\n      });\n      i0.ɵɵi18n(9, 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵi18nExp(ctx.weight);\n      i0.ɵɵi18nApply(1);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"formControl\", ctx.amountUsed);\n    }\n  },\n  directives: [i2.MatDialogTitle, i2.MatDialogContent, i5.MatFormField, i6.MatInput, i1.DefaultValueAccessor, i7.NumericDirective, i1.NgControlStatus, i1.FormControlDirective, i2.MatDialogActions, i8.MatButton],\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/isral/OneDrive/Documents/AVC-FRONT/src/app/components/avc-special/material-usage.component.ts"],"names":["DatePipe","LOCALE_ID","FormControl","isEqual","map","diff","distinctUntilChanged","take","MAT_DIALOG_DATA","i0","i1","i2","i3","i4","i5","i6","i7","i8","MaterialUsageComponent_div_1_ng_container_2_th_1_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","column_r8","ɵɵnextContext","$implicit","ɵɵadvance","ɵɵtextInterpolate1","label","MaterialUsageComponent_div_1_ng_container_2_td_2_Template","element_r12","name","MaterialUsageComponent_div_1_ng_container_2_Template","ɵɵelementContainerStart","ɵɵtemplate","ɵɵelementContainerEnd","ɵɵpropertyInterpolate","MaterialUsageComponent_div_1_th_4_Template","ɵɵi18n","MaterialUsageComponent_div_1_td_5_Template","ɵɵelement","i_r15","index","ɵɵproperty","MaterialUsageComponent_div_1_th_7_Template","MaterialUsageComponent_div_1_td_8_Template","_r19","ɵɵgetCurrentView","ɵɵlistener","MaterialUsageComponent_div_1_td_8_Template_button_click_1_listener","restoredCtx","ɵɵrestoreView","i_r17","ctx_r18","openDialog","ctx_r5","dataSource","MaterialUsageComponent_div_1_tr_9_Template","MaterialUsageComponent_div_1_tr_10_Template","MaterialUsageComponent_div_1_Template","ctx_r0","group","field","oneColumns","displayedColumns","MaterialUsageComponent","constructor","locale","fb","dialog","genral","_snackBar","choosedItems","productItems","ngOnInit","form","addControl","array","item","get","valueChanges","pipe","subscribe","selectedValue","filter","ele","id","length","result","updatedValues","forEach","el","getStorageGeneralItem","val","addToForm","itemConfig","type","options","collections","findAvailableItems","inputType","value","columnsSetup","kidSetup","tempField","element","push","parent","arr","includes","getProductBomInventoryMissing","inputFromParentItem","getItemsGeneral","proucts","open","a","c","join","duration","verticalPosition","newGroup","biggroup","transform","items","obj","itemPo","itemProcessDate","measureUnit","storage","group2","createItem","hasOwnProperty","control","kid","createBigNotExpand","group3","dialogRef","MaterialUsageDialog","data","weight","afterClosed","at","setValue","markAsDirty","ɵfac","MaterialUsageComponent_Factory","t","ɵɵdirectiveInject","FormBuilder","MatDialog","Genral","MatSnackBar","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","i18n_0","ngI18nClosureMode","MSG_EXTERNAL_6261628999354556206$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___1","goog","getMsg","i18n_2","MSG_EXTERNAL_8767732713336316989$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___3","template","MaterialUsageComponent_Template","ɵɵelementContainer","encapsulation","amountUsed","submitAmount","close","onNoClick","MaterialUsageDialog_Factory","MatDialogRef","i18n_4","MSG_EXTERNAL_8295165159424043148$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_5","i18n_6","MSG_EXTERNAL_3768927257183755959$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_7","i18n_8","MSG_EXTERNAL_7819314041543176992$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_9","MaterialUsageDialog_Template","MaterialUsageDialog_Template_button_click_6_listener","MaterialUsageDialog_Template_button_click_8_listener","ɵɵi18nExp","ɵɵi18nApply","directives","MatDialogTitle","MatDialogContent","MatFormField","MatInput","DefaultValueAccessor","NumericDirective","NgControlStatus","FormControlDirective","MatDialogActions","MatButton"],"mappings":"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","sourcesContent":["import { DatePipe } from '@angular/common';\r\nimport { LOCALE_ID } from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\nimport { isEqual, map } from 'lodash-es';\r\nimport { diff } from 'src/app/libraries/diffArrayObjects.interface';\r\nimport { distinctUntilChanged, take } from 'rxjs/operators';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/forms\";\r\nimport * as i2 from \"@angular/material/dialog\";\r\nimport * as i3 from \"src/app/genral.service\";\r\nimport * as i4 from \"@angular/material/snack-bar\";\r\nimport * as i5 from \"@angular/material/form-field\";\r\nimport * as i6 from \"@angular/material/input\";\r\nimport * as i7 from \"../../libraries/numeric.directive\";\r\nimport * as i8 from \"@angular/material/button\";\r\nfunction MaterialUsageComponent_div_1_ng_container_2_th_1_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"th\", 14);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const column_r8 = i0.ɵɵnextContext().$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", column_r8.label, \" \");\r\n} }\r\nfunction MaterialUsageComponent_div_1_ng_container_2_td_2_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"td\", 15);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const element_r12 = ctx.$implicit;\r\n    const column_r8 = i0.ɵɵnextContext().$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", element_r12[column_r8.name], \" \");\r\n} }\r\nfunction MaterialUsageComponent_div_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainerStart(0, 12);\r\n    i0.ɵɵtemplate(1, MaterialUsageComponent_div_1_ng_container_2_th_1_Template, 2, 1, \"th\", 6);\r\n    i0.ɵɵtemplate(2, MaterialUsageComponent_div_1_ng_container_2_td_2_Template, 2, 1, \"td\", 13);\r\n    i0.ɵɵelementContainerEnd();\r\n} if (rf & 2) {\r\n    const column_r8 = ctx.$implicit;\r\n    i0.ɵɵpropertyInterpolate(\"matColumnDef\", column_r8.name);\r\n} }\r\nfunction MaterialUsageComponent_div_1_th_4_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"th\", 14);\r\n    i0.ɵɵi18n(1, 16);\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction MaterialUsageComponent_div_1_td_5_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"td\", 17);\r\n    i0.ɵɵelementStart(1, \"mat-form-field\", 18);\r\n    i0.ɵɵelement(2, \"input\", 19);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const i_r15 = ctx.index;\r\n    i0.ɵɵproperty(\"formGroupName\", i_r15);\r\n} }\r\nfunction MaterialUsageComponent_div_1_th_7_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"th\", 14);\r\n} }\r\nfunction MaterialUsageComponent_div_1_td_8_Template(rf, ctx) { if (rf & 1) {\r\n    const _r19 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"td\", 20);\r\n    i0.ɵɵelementStart(1, \"button\", 21);\r\n    i0.ɵɵlistener(\"click\", function MaterialUsageComponent_div_1_td_8_Template_button_click_1_listener() { const restoredCtx = i0.ɵɵrestoreView(_r19); const i_r17 = restoredCtx.index; const ctx_r18 = i0.ɵɵnextContext(2); return ctx_r18.openDialog(i_r17); });\r\n    i0.ɵɵi18n(2, 22);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const i_r17 = ctx.index;\r\n    const ctx_r5 = i0.ɵɵnextContext(2);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"disabled\", ctx_r5.dataSource[i_r17][\"unitAmount\"] === null || ctx_r5.dataSource[i_r17][\"unitAmount\"] === 1);\r\n} }\r\nfunction MaterialUsageComponent_div_1_tr_9_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"tr\", 23);\r\n} }\r\nfunction MaterialUsageComponent_div_1_tr_10_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"tr\", 24);\r\n} }\r\nfunction MaterialUsageComponent_div_1_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 2);\r\n    i0.ɵɵelementStart(1, \"table\", 3);\r\n    i0.ɵɵtemplate(2, MaterialUsageComponent_div_1_ng_container_2_Template, 3, 1, \"ng-container\", 4);\r\n    i0.ɵɵelementContainerStart(3, 5);\r\n    i0.ɵɵtemplate(4, MaterialUsageComponent_div_1_th_4_Template, 2, 0, \"th\", 6);\r\n    i0.ɵɵtemplate(5, MaterialUsageComponent_div_1_td_5_Template, 3, 1, \"td\", 7);\r\n    i0.ɵɵelementContainerEnd();\r\n    i0.ɵɵelementContainerStart(6, 8);\r\n    i0.ɵɵtemplate(7, MaterialUsageComponent_div_1_th_7_Template, 1, 0, \"th\", 6);\r\n    i0.ɵɵtemplate(8, MaterialUsageComponent_div_1_td_8_Template, 3, 1, \"td\", 9);\r\n    i0.ɵɵelementContainerEnd();\r\n    i0.ɵɵtemplate(9, MaterialUsageComponent_div_1_tr_9_Template, 1, 0, \"tr\", 10);\r\n    i0.ɵɵtemplate(10, MaterialUsageComponent_div_1_tr_10_Template, 1, 0, \"tr\", 11);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.group);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"dataSource\", ctx_r0.dataSource)(\"formArrayName\", ctx_r0.field.name);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.oneColumns);\r\n    i0.ɵɵadvance(7);\r\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r0.displayedColumns);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r0.displayedColumns);\r\n} }\r\nexport class MaterialUsageComponent {\r\n    constructor(locale, fb, dialog, genral, _snackBar) {\r\n        this.locale = locale;\r\n        this.fb = fb;\r\n        this.dialog = dialog;\r\n        this.genral = genral;\r\n        this._snackBar = _snackBar;\r\n        this.choosedItems = [];\r\n        this.productItems = [];\r\n        this.displayedColumns = [];\r\n        this.oneColumns = [];\r\n    }\r\n    ngOnInit() {\r\n        this.form = this.fb.group({});\r\n        this.form.addControl('items', this.fb.array([this.fb.group({ item: null })]));\r\n        this.form.get('items').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\r\n            selectedValue = selectedValue.filter(ele => ele.item && ele.item.id);\r\n            selectedValue = map(selectedValue, 'item');\r\n            if (selectedValue.length && !isEqual(selectedValue, this.choosedItems)) {\r\n                var result = diff(this.choosedItems, selectedValue, 'id', { updatedValues: 1 });\r\n                result['added'].forEach(el => {\r\n                    this.genral.getStorageGeneralItem(el.id).pipe(take(1)).subscribe(val => {\r\n                        this.addToForm(val);\r\n                    });\r\n                });\r\n                this.choosedItems = selectedValue;\r\n            }\r\n        });\r\n        this.itemConfig =\r\n            {\r\n                type: 'bigexpand',\r\n                name: 'items',\r\n                label: $localize `Item`,\r\n                options: 'aloneInline',\r\n                collections: [\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `Item descrption`,\r\n                        name: 'item',\r\n                        options: this.genral.findAvailableItems(),\r\n                        collections: 'somewhere',\r\n                    },\r\n                    {\r\n                        type: 'divider',\r\n                        inputType: 'divide'\r\n                    },\r\n                ]\r\n            };\r\n        this.dataSource = this.group.get(this.field.name).value;\r\n        this.columnsSetup(this.field);\r\n        this.kidSetup(this.field);\r\n    }\r\n    columnsSetup(tempField) {\r\n        tempField.collections.forEach(element => {\r\n            switch (element.type) {\r\n                case 'selectgroup':\r\n                    this.oneColumns.push(element.collections[0]);\r\n                    this.displayedColumns.push(element.inputType);\r\n                    this.oneColumns.push(element.collections[1]);\r\n                    this.displayedColumns.push(element.collections[1].name);\r\n                    break;\r\n                case 'inputselect':\r\n                    if (element.name) {\r\n                        this.oneColumns.push(element);\r\n                        this.displayedColumns.push(element.name);\r\n                    }\r\n                    else {\r\n                        this.oneColumns.push(element.collections[0]);\r\n                        this.displayedColumns.push(element.collections[0].name);\r\n                        this.oneColumns.push(element.collections[1]);\r\n                        this.displayedColumns.push(element.collections[1].name);\r\n                    }\r\n                    break;\r\n                case 'bignotexpand':\r\n                    element.collections.forEach(el => {\r\n                        this.oneColumns.push(el);\r\n                        this.displayedColumns.push(el.name);\r\n                    });\r\n                    break;\r\n                default:\r\n                    this.oneColumns.push(element);\r\n                    this.displayedColumns.push(element.name);\r\n                    break;\r\n            }\r\n        });\r\n        this.displayedColumns.push('inputField');\r\n        this.displayedColumns.push('weightAmount');\r\n        if (tempField.inputType) {\r\n            this.group.parent.parent.get('processItemsNormal').valueChanges.pipe(distinctUntilChanged()).subscribe(arr => {\r\n                arr.forEach(ele => {\r\n                    if (ele && ele['item'] && ele['item']['id'] && !this.productItems.includes(ele['item']['id'])) {\r\n                        this.productItems.push(ele['item']['id']);\r\n                        this.genral.getProductBomInventoryMissing(ele['item']['id']).pipe(take(1)).subscribe(val => {\r\n                            if (val) {\r\n                                this.inputFromParentItem(val);\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n            this.group.parent.parent.get('processItemsTable').valueChanges.pipe(distinctUntilChanged()).subscribe(arr => {\r\n                arr.forEach(ele => {\r\n                    if (ele && ele['item'] && ele['item']['id'] && !this.productItems.includes(ele['item']['id'])) {\r\n                        this.productItems.push(ele['item']['id']);\r\n                        this.genral.getProductBomInventoryMissing(ele['item']['id']).pipe(take(1)).subscribe(val => {\r\n                            if (val) {\r\n                                this.inputFromParentItem(val);\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n    inputFromParentItem(val) {\r\n        this.addToForm(val[0]);\r\n        if (val[1].length) {\r\n            this.genral.getItemsGeneral().pipe(take(1)).subscribe(proucts => {\r\n                this._snackBar.open((proucts.filter(a => val[1].includes(a['id']))).map(c => c['value']).join(', ') + $localize ` are missing from inventory`, 'ok', {\r\n                    duration: 5000,\r\n                    // panelClass: 'blue-snackbar',\r\n                    verticalPosition: 'top'\r\n                });\r\n            });\r\n        }\r\n    }\r\n    kidSetup(tempField) {\r\n        tempField.collections.forEach(element => {\r\n            switch (element.type) {\r\n                // case 'array':\r\n                //     break;\r\n                case 'select':\r\n                case 'selectNormal':\r\n                    if (element.inputType === 'multiple') {\r\n                        this.dataSource.forEach(ele => {\r\n                            ele[element.name] = 'arr';\r\n                        });\r\n                    }\r\n                    else {\r\n                        this.dataSource.forEach(ele => {\r\n                            ele[element.name] = ele[element.name] ? ele[element.name]['value'] : '';\r\n                        });\r\n                    }\r\n                    break;\r\n                case 'selectgroup':\r\n                    element.collections[0]['name'] = element.inputType;\r\n                    this.dataSource.forEach(ele => {\r\n                        const newGroup = ele[element.collections[1].name];\r\n                        ele[element.collections[0].name] = newGroup[element.inputType];\r\n                        ele[element.collections[1].name] = newGroup.value;\r\n                    });\r\n                    break;\r\n                case 'inputselect':\r\n                    if (element.name) {\r\n                        this.dataSource.forEach(ele => {\r\n                            const newGroup = ele[element.name];\r\n                            ele[element.name] = newGroup[element.collections[0].name] + ' ' + newGroup[element.collections[1].name];\r\n                        });\r\n                    }\r\n                    break;\r\n                case 'bignotexpand':\r\n                    this.dataSource.forEach(ele => {\r\n                        const biggroup = ele[element.name];\r\n                        element.collections.forEach(el => {\r\n                            switch (el.type) {\r\n                                case 'select' || 'selectNormal':\r\n                                    if (el.inputType === 'multiple') {\r\n                                        ele[el.name] = 'arr';\r\n                                    }\r\n                                    else {\r\n                                        ele[el.name] = biggroup[el.name] ? biggroup[el.name]['value'] : '';\r\n                                    }\r\n                                    break;\r\n                                case 'inputselect':\r\n                                    if (el.name) {\r\n                                        const newGroup = biggroup[el.name];\r\n                                        ele[el.name] = newGroup[el.collections[0].name] + ' ' + newGroup[el.collections[1].name];\r\n                                    }\r\n                                    else {\r\n                                        ele[el.name] = biggroup[el.name];\r\n                                    }\r\n                                    break;\r\n                                default:\r\n                                    ele[el.name] = biggroup[el.name];\r\n                                    break;\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n                case 'date':\r\n                    this.dataSource.forEach(ele => {\r\n                        ele[element.name] = new DatePipe(this.locale).transform(ele[element.name]);\r\n                    });\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n    addToForm(val) {\r\n        const items = this.group.get([this.field.name]);\r\n        val === null || val === void 0 ? void 0 : val.forEach(element => {\r\n            if (element['storageForms']) {\r\n                element['storageForms'].forEach(ele => {\r\n                    var obj = { itemPo: element['poCode'], item: element['item'], itemProcessDate: element['itemProcessDate'], measureUnit: element['measureUnit'], storage: ele };\r\n                    var group2 = this.fb.group({});\r\n                    items.push(group2);\r\n                    this.createItem(group2, this.field, obj);\r\n                });\r\n            }\r\n        });\r\n        this.dataSource = this.group.get(this.field.name).value;\r\n        this.kidSetup(this.field);\r\n    }\r\n    createItem(group2, field, value) {\r\n        if (value.hasOwnProperty('id')) {\r\n            group2.addControl('id', this.fb.control(value['id'], null));\r\n        }\r\n        if (value.hasOwnProperty('version')) {\r\n            group2.addControl('version', this.fb.control(value['version'], null));\r\n        }\r\n        field.collections.forEach(kid => {\r\n            if (kid.type === 'bignotexpand') {\r\n                group2.addControl(kid.name, this.createBigNotExpand(kid, value.hasOwnProperty([kid.name]) ? value[kid.name] : {}));\r\n            }\r\n            else if (kid.type === 'selectgroup') {\r\n                const control = this.fb.control(value.hasOwnProperty(kid.collections[1].name) ? value[kid.collections[1].name] : kid.value, null);\r\n                group2.addControl(kid.collections[1].name, control);\r\n            }\r\n            else {\r\n                const control = this.fb.control(value.hasOwnProperty(kid.name) ? value[kid.name] : kid.value, null);\r\n                group2.addControl(kid.name, control);\r\n            }\r\n        });\r\n        group2.addControl('numberUsedUnits', this.fb.control(null, null));\r\n    }\r\n    createBigNotExpand(field, value) {\r\n        var group3 = this.fb.group({});\r\n        if (value.hasOwnProperty('id')) {\r\n            group3.addControl('id', this.fb.control(value['id'], null));\r\n        }\r\n        if (value.hasOwnProperty('version')) {\r\n            group3.addControl('version', this.fb.control(value['version'], null));\r\n        }\r\n        field.collections.forEach(kid => {\r\n            const control = this.fb.control(value.hasOwnProperty(kid.name) ? value[kid.name] : kid.value, null);\r\n            group3.addControl(kid.name, control);\r\n        });\r\n        return group3;\r\n    }\r\n    openDialog(index) {\r\n        const dialogRef = this.dialog.open(MaterialUsageDialog, {\r\n            data: { weight: this.dataSource[index]['measureUnit'] },\r\n        });\r\n        dialogRef.afterClosed().subscribe(result => {\r\n            if (result) {\r\n                this.group.get([this.field.name]).at(index).get('numberUsedUnits').setValue(result / +this.dataSource[index]['unitAmount']);\r\n                this.group.get([this.field.name]).at(index).get('numberUsedUnits').markAsDirty();\r\n            }\r\n        });\r\n    }\r\n}\r\nMaterialUsageComponent.ɵfac = function MaterialUsageComponent_Factory(t) { return new (t || MaterialUsageComponent)(i0.ɵɵdirectiveInject(LOCALE_ID), i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.Genral), i0.ɵɵdirectiveInject(i4.MatSnackBar)); };\r\nMaterialUsageComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: MaterialUsageComponent, selectors: [[\"material-usage\"]], decls: 2, vars: 3, consts: function () { let i18n_0; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_6261628999354556206$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___1 = goog.getMsg(\"Amount of units\");\r\n        i18n_0 = MSG_EXTERNAL_6261628999354556206$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___1;\r\n    }\r\n    else {\r\n        i18n_0 = $localize `:␟c48a8519fa1595cb03c38635f27428b7f9e1031d␟6261628999354556206:Amount of units`;\r\n    } let i18n_2; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_8767732713336316989$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___3 = goog.getMsg(\"Weight amount\");\r\n        i18n_2 = MSG_EXTERNAL_8767732713336316989$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS___3;\r\n    }\r\n    else {\r\n        i18n_2 = $localize `:␟c29e8d936244f4dd7a807b0a63106cef23246d1a␟8767732713336316989:Weight amount`;\r\n    } return [[\"dynamicField\", \"\", 3, \"field\", \"group\"], [3, \"formGroup\", 4, \"ngIf\"], [3, \"formGroup\"], [\"mat-table\", \"\", 3, \"dataSource\", \"formArrayName\"], [3, \"matColumnDef\", 4, \"ngFor\", \"ngForOf\"], [\"matColumnDef\", \"inputField\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 3, \"formGroupName\", 4, \"matCellDef\"], [\"matColumnDef\", \"weightAmount\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [3, \"matColumnDef\"], [\"mat-cell\", \"\", \"style\", \"text-align: center\", 4, \"matCellDef\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\", 2, \"text-align\", \"center\"], i18n_0, [\"mat-cell\", \"\", 3, \"formGroupName\"], [1, \"one-field\"], [\"matInput\", \"\", \"formControlName\", \"numberUsedUnits\", \"numeric\", \"\", \"decimals\", \"3\", \"type\", \"text\", \"maxlength\", \"255\"], [\"mat-cell\", \"\"], [\"type\", \"button\", \"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"disabled\", \"click\"], i18n_2, [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]]; }, template: function MaterialUsageComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementContainer(0, 0);\r\n        i0.ɵɵtemplate(1, MaterialUsageComponent_div_1_Template, 11, 6, \"div\", 1);\r\n    } if (rf & 2) {\r\n        i0.ɵɵproperty(\"field\", ctx.itemConfig)(\"group\", ctx.form);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.dataSource.length);\r\n    } }, encapsulation: 2 });\r\nexport class MaterialUsageDialog {\r\n    constructor(dialogRef, data) {\r\n        this.dialogRef = dialogRef;\r\n        this.data = data;\r\n        this.amountUsed = new FormControl('');\r\n        this.weight = data.weight;\r\n    }\r\n    submitAmount() {\r\n        this.dialogRef.close(this.amountUsed.value);\r\n    }\r\n    onNoClick() {\r\n        this.dialogRef.close(null);\r\n    }\r\n}\r\nMaterialUsageDialog.ɵfac = function MaterialUsageDialog_Factory(t) { return new (t || MaterialUsageDialog)(i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA)); };\r\nMaterialUsageDialog.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: MaterialUsageDialog, selectors: [[\"material-usage-dialog\"]], decls: 10, vars: 2, consts: function () { let i18n_4; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_8295165159424043148$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_5 = goog.getMsg(\"Amount in {$interpolation}\", { \"interpolation\": \"\\uFFFD0\\uFFFD\" });\r\n        i18n_4 = MSG_EXTERNAL_8295165159424043148$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_5;\r\n    }\r\n    else {\r\n        i18n_4 = $localize `:␟771a767c0b3d809678d11e91b6dbe374fc4dd92b␟8295165159424043148:Amount in ${\"\\uFFFD0\\uFFFD\"}:INTERPOLATION:`;\r\n    } let i18n_6; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_3768927257183755959$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_7 = goog.getMsg(\"Save\");\r\n        i18n_6 = MSG_EXTERNAL_3768927257183755959$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_7;\r\n    }\r\n    else {\r\n        i18n_6 = $localize `:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`;\r\n    } let i18n_8; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_7819314041543176992$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_9 = goog.getMsg(\"Close\");\r\n        i18n_8 = MSG_EXTERNAL_7819314041543176992$$SRC_APP_COMPONENTS_AVC_SPECIAL_MATERIAL_USAGE_COMPONENT_TS_9;\r\n    }\r\n    else {\r\n        i18n_8 = $localize `:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`;\r\n    } return [[\"mat-dialog-title\", \"\"], i18n_4, [1, \"one-field\"], [\"matInput\", \"\", \"cdkFocusInitial\", \"\", \"numeric\", \"\", \"decimals\", \"3\", \"placeholder\", \"Amount\", \"type\", \"text\", 3, \"formControl\"], [\"align\", \"end\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"click\"], i18n_6, i18n_8]; }, template: function MaterialUsageDialog_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"h1\", 0);\r\n        i0.ɵɵi18n(1, 1);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(2, \"mat-dialog-content\");\r\n        i0.ɵɵelementStart(3, \"mat-form-field\", 2);\r\n        i0.ɵɵelement(4, \"input\", 3);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(5, \"mat-dialog-actions\", 4);\r\n        i0.ɵɵelementStart(6, \"button\", 5);\r\n        i0.ɵɵlistener(\"click\", function MaterialUsageDialog_Template_button_click_6_listener() { return ctx.submitAmount(); });\r\n        i0.ɵɵi18n(7, 6);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(8, \"button\", 5);\r\n        i0.ɵɵlistener(\"click\", function MaterialUsageDialog_Template_button_click_8_listener() { return ctx.onNoClick(); });\r\n        i0.ɵɵi18n(9, 7);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵi18nExp(ctx.weight);\r\n        i0.ɵɵi18nApply(1);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"formControl\", ctx.amountUsed);\r\n    } }, directives: [i2.MatDialogTitle, i2.MatDialogContent, i5.MatFormField, i6.MatInput, i1.DefaultValueAccessor, i7.NumericDirective, i1.NgControlStatus, i1.FormControlDirective, i2.MatDialogActions, i8.MatButton], encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}
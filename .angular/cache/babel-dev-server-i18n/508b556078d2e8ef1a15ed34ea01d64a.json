{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { take } from 'rxjs/operators';\nimport { OrderDetailsDialogComponent } from './order-details-dialog-component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"./orders.service\";\nimport * as i4 from \"../genral.service\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/tabs\";\nimport * as i7 from \"../tables/date-range-select.component\";\nimport * as i8 from \"../tables/search-group-details.component\";\nexport class OrdersCReports {\n  constructor(router, dialog, localService, _Activatedroute, genral, cdRef) {\n    this.router = router;\n    this.dialog = dialog;\n    this.localService = localService;\n    this._Activatedroute = _Activatedroute;\n    this.genral = genral;\n    this.cdRef = cdRef;\n    this.tabIndex = 0;\n  }\n\n  ngOnInit() {\n    this.columnsShow = [{\n      type: 'nameId',\n      name: 'poCode',\n      label: \"PO#\",\n      search: 'object',\n      group: 'poCode'\n    }, {\n      name: 'supplierName',\n      label: \"Supplier\",\n      search: 'selectObj',\n      options: this.genral.getSuppliersCashew(),\n      group: 'poCode'\n    }, {\n      type: 'dateTime',\n      name: 'contractDate',\n      label: \"Contract date\",\n      search: 'dates',\n      group: 'poCode'\n    }, {\n      type: 'nameId',\n      name: 'item',\n      label: \"Product descrption\",\n      search: 'selectObjObj',\n      options: this.genral.getItemsCashew('Raw')\n    }, {\n      type: 'weight2',\n      name: 'numberUnits',\n      label: \"Amount\",\n      search: 'objArray' // options: 'measureUnit',\n\n    }, {\n      type: 'currency',\n      name: 'unitPrice',\n      label: \"Price per unit\",\n      search: 'object' // options: 'currency',\n\n    }, {\n      name: 'defects',\n      label: \"% defects\",\n      search: 'normal'\n    }, {\n      type: 'date',\n      name: 'deliveryDate',\n      label: \"Delivery date\",\n      search: 'dates',\n      compare: {\n        type: 'date',\n        condition: 'RECEIVED',\n        condVar: 'orderStatus'\n      }\n    }, {\n      type: 'arrayVal',\n      name: 'approvals',\n      label: \"Approvals\",\n      search: 'normal'\n    }];\n\n    this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\n      if (params.get('number')) {\n        this.tabIndex = +params.get('number');\n      }\n    });\n\n    this.navigationSubscription = this.router.events.subscribe(e => {\n      // If it is a NavigationEnd event re-initalise the component\n      if (e instanceof NavigationEnd) {\n        this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\n          if (params.get('number')) {\n            this.tabIndex = +params.get('number');\n          } else {\n            this.tabIndex = 0;\n          }\n\n          this.changedAndDate(this.tabIndex);\n        });\n      }\n    });\n  }\n\n  openDialog(event) {\n    const dialogRef = this.dialog.open(OrderDetailsDialogComponent, {\n      width: '80%',\n      data: {\n        id: event['id'],\n        fromNew: false,\n        type: 'Cashew'\n      }\n    });\n    dialogRef.afterClosed().subscribe(data => {\n      if (data === 'Edit order') {\n        this.router.navigate(['../NewCashewOrder', {\n          id: event['poCode']['id']\n        }], {\n          relativeTo: this._Activatedroute\n        });\n      } else if (data === 'Receive') {\n        this.router.navigate(['Main/receiptready/ReceiveCOrder', {\n          poCode: event['poCode']['id']\n        }]);\n      } else if (data === 'Edit receive' || data === 'Receive extra') {\n        this.router.navigate(['Main/receiptready/ReceiveCOrder', {\n          poCode: event['poCode']['id'],\n          id: event['id']\n        }]);\n      } else if (dialogRef.componentInstance.approveChange) {\n        this.changedAndDate(this.tabIndex);\n      }\n    });\n  }\n\n  changed(event) {\n    this.changedAndDate(event);\n  }\n\n  setDateRange($event) {\n    this.dateRange = $event;\n    this.changedAndDate(this.tabIndex);\n  }\n\n  changedAndDate(event) {\n    switch (+event) {\n      case 0:\n        this.cashewSource = null;\n        var ind = this.columnsShow.findIndex(em => em['name'] === 'orderStatus');\n\n        if (ind !== -1) {\n          this.columnsShow.splice(ind, 1);\n          this.columnsShow = this.columnsShow.slice();\n        }\n\n        this.localService.getCashewOrdersOpen().pipe(take(1)).subscribe(value => {\n          this.cashewSource = value;\n        });\n        this.cdRef.detectChanges();\n        break;\n\n      case 1:\n        this.cashewSource = null;\n        var ind = this.columnsShow.findIndex(em => em['name'] === 'orderStatus');\n\n        if (ind === -1) {\n          this.columnsShow.push({\n            type: 'arrayVal',\n            name: 'orderStatus',\n            label: \"Status\",\n            search: 'selectArr',\n            options: this.genral.getOrderStatus()\n          });\n          this.columnsShow = this.columnsShow.slice();\n        }\n\n        this.localService.getHistoryCashewOrders(this.dateRange).pipe(take(1)).subscribe(value => {\n          this.cashewSource = value;\n        });\n        this.cdRef.detectChanges();\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.navigationSubscription) {\n      this.navigationSubscription.unsubscribe();\n    }\n  }\n\n}\n\nOrdersCReports.ɵfac = function OrdersCReports_Factory(t) {\n  return new (t || OrdersCReports)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.OrdersService), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i4.Genral), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n};\n\nOrdersCReports.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OrdersCReports,\n  selectors: [[\"orders-c-reports\"]],\n  decls: 10,\n  vars: 4,\n  consts: function () {\n    let i18n_0;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_3599879156254235695$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_1 = goog.getMsg(\"New Cashew Order\");\n      i18n_0 = MSG_EXTERNAL_3599879156254235695$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_1;\n    } else {\n      i18n_0 = \"New Cashew Order\";\n    }\n\n    let i18n_2;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_4486311034911121630$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_3 = goog.getMsg(\"Cashew Orders\");\n      i18n_2 = MSG_EXTERNAL_4486311034911121630$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_3;\n    } else {\n      i18n_2 = \"Cashew Orders\";\n    }\n\n    let i18n_4;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_7593555694782789615$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_5 = goog.getMsg(\"Open\");\n      i18n_4 = MSG_EXTERNAL_7593555694782789615$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_5;\n    } else {\n      i18n_4 = \"Open\";\n    }\n\n    let i18n_6;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_1616102757855967475$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_7 = goog.getMsg(\"All\");\n      i18n_6 = MSG_EXTERNAL_1616102757855967475$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_7;\n    } else {\n      i18n_6 = \"All\";\n    }\n\n    return [[1, \"centerButtons\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"routerLink\", \"../NewCashewOrder\"], i18n_0, [2, \"text-align\", \"center\"], i18n_2, [\"mat-stretch-tabs\", \"\", 1, \"spac-print\", 3, \"selectedIndex\", \"selectedIndexChange\"], [\"label\", i18n_4], [\"label\", i18n_6], [3, \"withTime\", \"submitRange\"], [3, \"mainColumns\", \"detailsSource\", \"details\"]];\n  },\n  template: function OrdersCReports_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"button\", 1);\n      i0.ɵɵi18n(2, 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"h1\", 3);\n      i0.ɵɵi18n(4, 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"mat-tab-group\", 5);\n      i0.ɵɵlistener(\"selectedIndexChange\", function OrdersCReports_Template_mat_tab_group_selectedIndexChange_5_listener($event) {\n        return ctx.tabIndex = $event;\n      })(\"selectedIndexChange\", function OrdersCReports_Template_mat_tab_group_selectedIndexChange_5_listener($event) {\n        return ctx.changed($event);\n      });\n      i0.ɵɵelement(6, \"mat-tab\", 6);\n      i0.ɵɵelementStart(7, \"mat-tab\", 7);\n      i0.ɵɵelementStart(8, \"date-range-select\", 8);\n      i0.ɵɵlistener(\"submitRange\", function OrdersCReports_Template_date_range_select_submitRange_8_listener($event) {\n        return ctx.setDateRange($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"search-group-details\", 9);\n      i0.ɵɵlistener(\"details\", function OrdersCReports_Template_search_group_details_details_9_listener($event) {\n        return ctx.openDialog($event);\n      });\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"selectedIndex\", ctx.tabIndex);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"withTime\", false);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"mainColumns\", ctx.columnsShow)(\"detailsSource\", ctx.cashewSource);\n    }\n  },\n  directives: [i5.MatButton, i1.RouterLink, i6.MatTabGroup, i6.MatTab, i7.DateRangeSelect, i8.SearchGroupDetailsComponent],\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/isral/OneDrive/Documents/AVC-FRONT/src/app/orders/orders-c-reports.component.ts"],"names":["NavigationEnd","take","OrderDetailsDialogComponent","i0","i1","i2","i3","i4","i5","i6","i7","i8","OrdersCReports","constructor","router","dialog","localService","_Activatedroute","genral","cdRef","tabIndex","ngOnInit","columnsShow","type","name","label","search","group","options","getSuppliersCashew","getItemsCashew","compare","condition","condVar","paramMap","pipe","subscribe","params","get","navigationSubscription","events","e","changedAndDate","openDialog","event","dialogRef","open","width","data","id","fromNew","afterClosed","navigate","relativeTo","poCode","componentInstance","approveChange","changed","setDateRange","$event","dateRange","cashewSource","ind","findIndex","em","splice","slice","getCashewOrdersOpen","value","detectChanges","push","getOrderStatus","getHistoryCashewOrders","ngOnDestroy","unsubscribe","ɵfac","OrdersCReports_Factory","t","ɵɵdirectiveInject","Router","MatDialog","OrdersService","ActivatedRoute","Genral","ChangeDetectorRef","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","i18n_0","ngI18nClosureMode","MSG_EXTERNAL_3599879156254235695$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_1","goog","getMsg","i18n_2","MSG_EXTERNAL_4486311034911121630$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_3","i18n_4","MSG_EXTERNAL_7593555694782789615$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_5","i18n_6","MSG_EXTERNAL_1616102757855967475$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_7","template","OrdersCReports_Template","rf","ctx","ɵɵelementStart","ɵɵi18n","ɵɵelementEnd","ɵɵlistener","OrdersCReports_Template_mat_tab_group_selectedIndexChange_5_listener","ɵɵelement","OrdersCReports_Template_date_range_select_submitRange_8_listener","OrdersCReports_Template_search_group_details_details_9_listener","ɵɵadvance","ɵɵproperty","directives","MatButton","RouterLink","MatTabGroup","MatTab","DateRangeSelect","SearchGroupDetailsComponent","encapsulation"],"mappings":"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","sourcesContent":["import { NavigationEnd } from '@angular/router';\r\nimport { take } from 'rxjs/operators';\r\nimport { OrderDetailsDialogComponent } from './order-details-dialog-component';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/router\";\r\nimport * as i2 from \"@angular/material/dialog\";\r\nimport * as i3 from \"./orders.service\";\r\nimport * as i4 from \"../genral.service\";\r\nimport * as i5 from \"@angular/material/button\";\r\nimport * as i6 from \"@angular/material/tabs\";\r\nimport * as i7 from \"../tables/date-range-select.component\";\r\nimport * as i8 from \"../tables/search-group-details.component\";\r\nexport class OrdersCReports {\r\n    constructor(router, dialog, localService, _Activatedroute, genral, cdRef) {\r\n        this.router = router;\r\n        this.dialog = dialog;\r\n        this.localService = localService;\r\n        this._Activatedroute = _Activatedroute;\r\n        this.genral = genral;\r\n        this.cdRef = cdRef;\r\n        this.tabIndex = 0;\r\n    }\r\n    ngOnInit() {\r\n        this.columnsShow = [\r\n            {\r\n                type: 'nameId',\r\n                name: 'poCode',\r\n                label: $localize `PO#`,\r\n                search: 'object',\r\n                group: 'poCode',\r\n            },\r\n            {\r\n                name: 'supplierName',\r\n                label: $localize `Supplier`,\r\n                search: 'selectObj',\r\n                options: this.genral.getSuppliersCashew(),\r\n                group: 'poCode',\r\n            },\r\n            {\r\n                type: 'dateTime',\r\n                name: 'contractDate',\r\n                label: $localize `Contract date`,\r\n                search: 'dates',\r\n                group: 'poCode',\r\n            },\r\n            {\r\n                type: 'nameId',\r\n                name: 'item',\r\n                label: $localize `Product descrption`,\r\n                search: 'selectObjObj',\r\n                options: this.genral.getItemsCashew('Raw'),\r\n            },\r\n            {\r\n                type: 'weight2',\r\n                name: 'numberUnits',\r\n                label: $localize `Amount`,\r\n                search: 'objArray',\r\n                // options: 'measureUnit',\r\n            },\r\n            {\r\n                type: 'currency',\r\n                name: 'unitPrice',\r\n                label: $localize `Price per unit`,\r\n                search: 'object',\r\n                // options: 'currency',\r\n            },\r\n            {\r\n                name: 'defects',\r\n                label: $localize `% defects`,\r\n                search: 'normal',\r\n            },\r\n            {\r\n                type: 'date',\r\n                name: 'deliveryDate',\r\n                label: $localize `Delivery date`,\r\n                search: 'dates',\r\n                compare: {\r\n                    type: 'date',\r\n                    condition: 'RECEIVED',\r\n                    condVar: 'orderStatus',\r\n                },\r\n            },\r\n            {\r\n                type: 'arrayVal',\r\n                name: 'approvals',\r\n                label: $localize `Approvals`,\r\n                search: 'normal',\r\n            },\r\n        ];\r\n        this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\r\n            if (params.get('number')) {\r\n                this.tabIndex = +params.get('number');\r\n            }\r\n        });\r\n        this.navigationSubscription = this.router.events.subscribe((e) => {\r\n            // If it is a NavigationEnd event re-initalise the component\r\n            if (e instanceof NavigationEnd) {\r\n                this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\r\n                    if (params.get('number')) {\r\n                        this.tabIndex = +params.get('number');\r\n                    }\r\n                    else {\r\n                        this.tabIndex = 0;\r\n                    }\r\n                    this.changedAndDate(this.tabIndex);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    openDialog(event) {\r\n        const dialogRef = this.dialog.open(OrderDetailsDialogComponent, {\r\n            width: '80%',\r\n            data: { id: event['id'], fromNew: false, type: 'Cashew' },\r\n        });\r\n        dialogRef.afterClosed().subscribe(data => {\r\n            if (data === 'Edit order') {\r\n                this.router.navigate(['../NewCashewOrder', { id: event['poCode']['id'] }], { relativeTo: this._Activatedroute });\r\n            }\r\n            else if (data === 'Receive') {\r\n                this.router.navigate(['Main/receiptready/ReceiveCOrder', { poCode: event['poCode']['id'] }]);\r\n            }\r\n            else if (data === 'Edit receive' || data === 'Receive extra') {\r\n                this.router.navigate(['Main/receiptready/ReceiveCOrder', { poCode: event['poCode']['id'], id: event['id'] }]);\r\n            }\r\n            else if (dialogRef.componentInstance.approveChange) {\r\n                this.changedAndDate(this.tabIndex);\r\n            }\r\n        });\r\n    }\r\n    changed(event) {\r\n        this.changedAndDate(event);\r\n    }\r\n    setDateRange($event) {\r\n        this.dateRange = $event;\r\n        this.changedAndDate(this.tabIndex);\r\n    }\r\n    changedAndDate(event) {\r\n        switch (+event) {\r\n            case 0:\r\n                this.cashewSource = null;\r\n                var ind = this.columnsShow.findIndex((em) => em['name'] === 'orderStatus');\r\n                if (ind !== -1) {\r\n                    this.columnsShow.splice(ind, 1);\r\n                    this.columnsShow = this.columnsShow.slice();\r\n                }\r\n                this.localService.getCashewOrdersOpen().pipe(take(1)).subscribe(value => {\r\n                    this.cashewSource = value;\r\n                });\r\n                this.cdRef.detectChanges();\r\n                break;\r\n            case 1:\r\n                this.cashewSource = null;\r\n                var ind = this.columnsShow.findIndex((em) => em['name'] === 'orderStatus');\r\n                if (ind === -1) {\r\n                    this.columnsShow.push({\r\n                        type: 'arrayVal',\r\n                        name: 'orderStatus',\r\n                        label: $localize `Status`,\r\n                        search: 'selectArr',\r\n                        options: this.genral.getOrderStatus(),\r\n                    });\r\n                    this.columnsShow = this.columnsShow.slice();\r\n                }\r\n                this.localService.getHistoryCashewOrders(this.dateRange).pipe(take(1)).subscribe(value => {\r\n                    this.cashewSource = value;\r\n                });\r\n                this.cdRef.detectChanges();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    ngOnDestroy() {\r\n        if (this.navigationSubscription) {\r\n            this.navigationSubscription.unsubscribe();\r\n        }\r\n    }\r\n}\r\nOrdersCReports.ɵfac = function OrdersCReports_Factory(t) { return new (t || OrdersCReports)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.OrdersService), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i4.Genral), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };\r\nOrdersCReports.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: OrdersCReports, selectors: [[\"orders-c-reports\"]], decls: 10, vars: 4, consts: function () { let i18n_0; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_3599879156254235695$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_1 = goog.getMsg(\"New Cashew Order\");\r\n        i18n_0 = MSG_EXTERNAL_3599879156254235695$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_1;\r\n    }\r\n    else {\r\n        i18n_0 = $localize `:␟c382f1d637560d38d01c3d1d1a973eceb06324dd␟3599879156254235695:New Cashew Order`;\r\n    } let i18n_2; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_4486311034911121630$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_3 = goog.getMsg(\"Cashew Orders\");\r\n        i18n_2 = MSG_EXTERNAL_4486311034911121630$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_3;\r\n    }\r\n    else {\r\n        i18n_2 = $localize `:␟b0ba19939d960823da1ad97abb30ff22d93095c8␟4486311034911121630:Cashew Orders`;\r\n    } let i18n_4; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_7593555694782789615$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_5 = goog.getMsg(\"Open\");\r\n        i18n_4 = MSG_EXTERNAL_7593555694782789615$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_5;\r\n    }\r\n    else {\r\n        i18n_4 = $localize `:␟c9039b1b13b3ef165b66b3c5d79f810ab1ebb050␟7593555694782789615:Open`;\r\n    } let i18n_6; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_1616102757855967475$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_7 = goog.getMsg(\"All\");\r\n        i18n_6 = MSG_EXTERNAL_1616102757855967475$$SRC_APP_ORDERS_ORDERS_C_REPORTS_COMPONENT_TS_7;\r\n    }\r\n    else {\r\n        i18n_6 = $localize `:␟dfc3c34e182ea73c5d784ff7c8135f087992dac1␟1616102757855967475:All`;\r\n    } return [[1, \"centerButtons\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"routerLink\", \"../NewCashewOrder\"], i18n_0, [2, \"text-align\", \"center\"], i18n_2, [\"mat-stretch-tabs\", \"\", 1, \"spac-print\", 3, \"selectedIndex\", \"selectedIndexChange\"], [\"label\", i18n_4], [\"label\", i18n_6], [3, \"withTime\", \"submitRange\"], [3, \"mainColumns\", \"detailsSource\", \"details\"]]; }, template: function OrdersCReports_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"button\", 1);\r\n        i0.ɵɵi18n(2, 2);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(3, \"h1\", 3);\r\n        i0.ɵɵi18n(4, 4);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(5, \"mat-tab-group\", 5);\r\n        i0.ɵɵlistener(\"selectedIndexChange\", function OrdersCReports_Template_mat_tab_group_selectedIndexChange_5_listener($event) { return ctx.tabIndex = $event; })(\"selectedIndexChange\", function OrdersCReports_Template_mat_tab_group_selectedIndexChange_5_listener($event) { return ctx.changed($event); });\r\n        i0.ɵɵelement(6, \"mat-tab\", 6);\r\n        i0.ɵɵelementStart(7, \"mat-tab\", 7);\r\n        i0.ɵɵelementStart(8, \"date-range-select\", 8);\r\n        i0.ɵɵlistener(\"submitRange\", function OrdersCReports_Template_date_range_select_submitRange_8_listener($event) { return ctx.setDateRange($event); });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(9, \"search-group-details\", 9);\r\n        i0.ɵɵlistener(\"details\", function OrdersCReports_Template_search_group_details_details_9_listener($event) { return ctx.openDialog($event); });\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(5);\r\n        i0.ɵɵproperty(\"selectedIndex\", ctx.tabIndex);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"withTime\", false);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"mainColumns\", ctx.columnsShow)(\"detailsSource\", ctx.cashewSource);\r\n    } }, directives: [i5.MatButton, i1.RouterLink, i6.MatTabGroup, i6.MatTab, i7.DateRangeSelect, i8.SearchGroupDetailsComponent], encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { groupBy, mapValues } from 'lodash-es';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/table\";\nimport * as i2 from \"@angular/common\";\n\nfunction SumsTableSchedulesComponent_th_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 9);\n    i0.ɵɵi18n(1, 10);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SumsTableSchedulesComponent_td_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const element_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(element_r5.key === \"null\" ? \"other\" : element_r5.key);\n  }\n}\n\nfunction SumsTableSchedulesComponent_ng_container_6_th_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 9);\n    i0.ɵɵelementStart(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(column_r6);\n  }\n}\n\nfunction SumsTableSchedulesComponent_ng_container_6_td_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const element_r10 = ctx.$implicit;\n    const column_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, element_r10[column_r6], \"1.0-3\"), \" \");\n  }\n}\n\nfunction SumsTableSchedulesComponent_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0, 12);\n    i0.ɵɵtemplate(1, SumsTableSchedulesComponent_ng_container_6_th_1_Template, 3, 1, \"th\", 4);\n    i0.ɵɵtemplate(2, SumsTableSchedulesComponent_ng_container_6_td_2_Template, 3, 4, \"td\", 5);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const column_r6 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"matColumnDef\", column_r6);\n  }\n}\n\nfunction SumsTableSchedulesComponent_tr_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 13);\n  }\n}\n\nfunction SumsTableSchedulesComponent_tr_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 14);\n  }\n}\n\nexport class SumsTableSchedulesComponent {\n  constructor() {\n    this.sumDataSource = [];\n    this.sumCloumns = [];\n  }\n\n  set mainDetailsSource(value) {\n    if (value[0]) {\n      this.dataSource = value[0];\n      this.sumCloumns = value[1];\n\n      if (this.sumCloumns.length) {\n        this.sumDataSource = [];\n\n        var nest = function (seq, keys) {\n          if (!keys.length) return seq;\n          var first = keys[0];\n          var rest = keys.slice(1);\n          return mapValues(groupBy(seq, first), function (value) {\n            return nest(value, rest);\n          });\n        };\n\n        if (value[2]) {\n          this.dataSource.forEach(el => {\n            Object.defineProperty(el, value[2][1], Object.getOwnPropertyDescriptor(el[value[2][0]], 'value'));\n          });\n        }\n\n        const tempTable = nest(this.dataSource, this.sumCloumns);\n        this.sumClumensTable = ['key'];\n        Object.keys(tempTable).forEach(key => {\n          var newLine = {\n            key: key\n          };\n          var sum = 0;\n          Object.keys(tempTable[key]).forEach(val => {\n            newLine[val] = tempTable[key][val].reduce((b, c) => +b + +c['numberLots']['amount'], 0);\n            this.sumClumensTable.push(val);\n            sum += newLine[val];\n          });\n          newLine[\"sum\"] = sum;\n          this.sumDataSource.push(newLine);\n        });\n        this.sumClumensTable = [...new Set(this.sumClumensTable)];\n        this.sumClumensTable.push(\"sum\");\n        var newSumLine = {\n          key: \"Total\"\n        };\n        this.sumClumensTable.forEach(newCloumn => {\n          if (newCloumn !== 'key') {\n            var sum = 0;\n            this.sumDataSource.forEach(aLine => {\n              sum += aLine[newCloumn] ? aLine[newCloumn] : 0;\n            });\n            newSumLine[newCloumn] = sum;\n          }\n        });\n        this.sumDataSource.push(newSumLine);\n        this.sumClumensshow = this.sumClumensTable.slice(1);\n      }\n    }\n  }\n\n}\n\nSumsTableSchedulesComponent.ɵfac = function SumsTableSchedulesComponent_Factory(t) {\n  return new (t || SumsTableSchedulesComponent)();\n};\n\nSumsTableSchedulesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SumsTableSchedulesComponent,\n  selectors: [[\"sums-table-schedules\"]],\n  inputs: {\n    mainDetailsSource: \"mainDetailsSource\"\n  },\n  decls: 9,\n  vars: 4,\n  consts: function () {\n    let i18n_0;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_435443293805862826$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS_1 = goog.getMsg(\"Amounts\");\n      i18n_0 = MSG_EXTERNAL_435443293805862826$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS_1;\n    } else {\n      i18n_0 = \"Amounts\";\n    }\n\n    let i18n_2;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_1477517873911974944$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS__3 = goog.getMsg(\"Person in charge\");\n      i18n_2 = MSG_EXTERNAL_1477517873911974944$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS__3;\n    } else {\n      i18n_2 = \"Person in charge\";\n    }\n\n    return [[2, \"text-align\", \"center\"], i18n_0, [\"mat-table\", \"\", 2, \"text-align\", \"center !important\", 3, \"dataSource\"], [\"matColumnDef\", \"key\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [3, \"matColumnDef\", 4, \"ngFor\", \"ngForOf\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-header-cell\", \"\"], i18n_2, [\"mat-cell\", \"\"], [3, \"matColumnDef\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]];\n  },\n  template: function SumsTableSchedulesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\", 0);\n      i0.ɵɵi18n(1, 1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"table\", 2);\n      i0.ɵɵelementContainerStart(3, 3);\n      i0.ɵɵtemplate(4, SumsTableSchedulesComponent_th_4_Template, 2, 0, \"th\", 4);\n      i0.ɵɵtemplate(5, SumsTableSchedulesComponent_td_5_Template, 2, 1, \"td\", 5);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵtemplate(6, SumsTableSchedulesComponent_ng_container_6_Template, 3, 1, \"ng-container\", 6);\n      i0.ɵɵtemplate(7, SumsTableSchedulesComponent_tr_7_Template, 1, 0, \"tr\", 7);\n      i0.ɵɵtemplate(8, SumsTableSchedulesComponent_tr_8_Template, 1, 0, \"tr\", 8);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"dataSource\", ctx.sumDataSource);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.sumClumensshow);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matHeaderRowDef\", ctx.sumClumensTable);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matRowDefColumns\", ctx.sumClumensTable);\n    }\n  },\n  directives: [i1.MatTable, i1.MatColumnDef, i1.MatHeaderCellDef, i1.MatCellDef, i2.NgForOf, i1.MatHeaderRowDef, i1.MatRowDef, i1.MatHeaderCell, i1.MatCell, i1.MatHeaderRow, i1.MatRow],\n  pipes: [i2.DecimalPipe],\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/isral/OneDrive/Documents/AVC-FRONT/src/app/schedules/sums-table-schedules.component.ts"],"names":["groupBy","mapValues","i0","i1","i2","SumsTableSchedulesComponent_th_4_Template","rf","ctx","ɵɵelementStart","ɵɵi18n","ɵɵelementEnd","SumsTableSchedulesComponent_td_5_Template","ɵɵtext","element_r5","$implicit","ɵɵadvance","ɵɵtextInterpolate","key","SumsTableSchedulesComponent_ng_container_6_th_1_Template","column_r6","ɵɵnextContext","SumsTableSchedulesComponent_ng_container_6_td_2_Template","ɵɵpipe","element_r10","ɵɵtextInterpolate1","ɵɵpipeBind2","SumsTableSchedulesComponent_ng_container_6_Template","ɵɵelementContainerStart","ɵɵtemplate","ɵɵelementContainerEnd","ɵɵpropertyInterpolate","SumsTableSchedulesComponent_tr_7_Template","ɵɵelement","SumsTableSchedulesComponent_tr_8_Template","SumsTableSchedulesComponent","constructor","sumDataSource","sumCloumns","mainDetailsSource","value","dataSource","length","nest","seq","keys","first","rest","slice","forEach","el","Object","defineProperty","getOwnPropertyDescriptor","tempTable","sumClumensTable","newLine","sum","val","reduce","b","c","push","Set","newSumLine","newCloumn","aLine","sumClumensshow","ɵfac","SumsTableSchedulesComponent_Factory","t","ɵcmp","ɵɵdefineComponent","type","selectors","inputs","decls","vars","consts","i18n_0","ngI18nClosureMode","MSG_EXTERNAL_435443293805862826$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS_1","goog","getMsg","i18n_2","MSG_EXTERNAL_1477517873911974944$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS__3","template","SumsTableSchedulesComponent_Template","ɵɵproperty","directives","MatTable","MatColumnDef","MatHeaderCellDef","MatCellDef","NgForOf","MatHeaderRowDef","MatRowDef","MatHeaderCell","MatCell","MatHeaderRow","MatRow","pipes","DecimalPipe","encapsulation"],"mappings":"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","sourcesContent":["import { groupBy, mapValues } from 'lodash-es';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/material/table\";\r\nimport * as i2 from \"@angular/common\";\r\nfunction SumsTableSchedulesComponent_th_4_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"th\", 9);\r\n    i0.ɵɵi18n(1, 10);\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction SumsTableSchedulesComponent_td_5_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"td\", 11);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const element_r5 = ctx.$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate(element_r5.key === \"null\" ? \"other\" : element_r5.key);\r\n} }\r\nfunction SumsTableSchedulesComponent_ng_container_6_th_1_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"th\", 9);\r\n    i0.ɵɵelementStart(1, \"h3\");\r\n    i0.ɵɵtext(2);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const column_r6 = i0.ɵɵnextContext().$implicit;\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵtextInterpolate(column_r6);\r\n} }\r\nfunction SumsTableSchedulesComponent_ng_container_6_td_2_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"td\", 11);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵpipe(2, \"number\");\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const element_r10 = ctx.$implicit;\r\n    const column_r6 = i0.ɵɵnextContext().$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, element_r10[column_r6], \"1.0-3\"), \" \");\r\n} }\r\nfunction SumsTableSchedulesComponent_ng_container_6_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainerStart(0, 12);\r\n    i0.ɵɵtemplate(1, SumsTableSchedulesComponent_ng_container_6_th_1_Template, 3, 1, \"th\", 4);\r\n    i0.ɵɵtemplate(2, SumsTableSchedulesComponent_ng_container_6_td_2_Template, 3, 4, \"td\", 5);\r\n    i0.ɵɵelementContainerEnd();\r\n} if (rf & 2) {\r\n    const column_r6 = ctx.$implicit;\r\n    i0.ɵɵpropertyInterpolate(\"matColumnDef\", column_r6);\r\n} }\r\nfunction SumsTableSchedulesComponent_tr_7_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"tr\", 13);\r\n} }\r\nfunction SumsTableSchedulesComponent_tr_8_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"tr\", 14);\r\n} }\r\nexport class SumsTableSchedulesComponent {\r\n    constructor() {\r\n        this.sumDataSource = [];\r\n        this.sumCloumns = [];\r\n    }\r\n    set mainDetailsSource(value) {\r\n        if (value[0]) {\r\n            this.dataSource = value[0];\r\n            this.sumCloumns = value[1];\r\n            if (this.sumCloumns.length) {\r\n                this.sumDataSource = [];\r\n                var nest = function (seq, keys) {\r\n                    if (!keys.length)\r\n                        return seq;\r\n                    var first = keys[0];\r\n                    var rest = keys.slice(1);\r\n                    return mapValues(groupBy(seq, first), function (value) {\r\n                        return nest(value, rest);\r\n                    });\r\n                };\r\n                if (value[2]) {\r\n                    this.dataSource.forEach(el => {\r\n                        Object.defineProperty(el, value[2][1], Object.getOwnPropertyDescriptor(el[value[2][0]], 'value'));\r\n                    });\r\n                }\r\n                const tempTable = nest(this.dataSource, this.sumCloumns);\r\n                this.sumClumensTable = ['key'];\r\n                Object.keys(tempTable).forEach(key => {\r\n                    var newLine = { key: key };\r\n                    var sum = 0;\r\n                    Object.keys(tempTable[key]).forEach(val => {\r\n                        newLine[val] = tempTable[key][val].reduce((b, c) => +b + +c['numberLots']['amount'], 0);\r\n                        this.sumClumensTable.push(val);\r\n                        sum += newLine[val];\r\n                    });\r\n                    newLine[$localize `sum`] = sum;\r\n                    this.sumDataSource.push(newLine);\r\n                });\r\n                this.sumClumensTable = [...new Set(this.sumClumensTable)];\r\n                this.sumClumensTable.push($localize `sum`);\r\n                var newSumLine = { key: $localize `Total` };\r\n                this.sumClumensTable.forEach(newCloumn => {\r\n                    if (newCloumn !== 'key') {\r\n                        var sum = 0;\r\n                        this.sumDataSource.forEach(aLine => {\r\n                            sum += aLine[newCloumn] ? aLine[newCloumn] : 0;\r\n                        });\r\n                        newSumLine[newCloumn] = sum;\r\n                    }\r\n                });\r\n                this.sumDataSource.push(newSumLine);\r\n                this.sumClumensshow = this.sumClumensTable.slice(1);\r\n            }\r\n        }\r\n    }\r\n}\r\nSumsTableSchedulesComponent.ɵfac = function SumsTableSchedulesComponent_Factory(t) { return new (t || SumsTableSchedulesComponent)(); };\r\nSumsTableSchedulesComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: SumsTableSchedulesComponent, selectors: [[\"sums-table-schedules\"]], inputs: { mainDetailsSource: \"mainDetailsSource\" }, decls: 9, vars: 4, consts: function () { let i18n_0; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_435443293805862826$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS_1 = goog.getMsg(\"Amounts\");\r\n        i18n_0 = MSG_EXTERNAL_435443293805862826$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS_1;\r\n    }\r\n    else {\r\n        i18n_0 = $localize `:␟b424615c80292cdcec7785ed34a990c8682356b4␟435443293805862826:Amounts`;\r\n    } let i18n_2; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_1477517873911974944$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS__3 = goog.getMsg(\"Person in charge\");\r\n        i18n_2 = MSG_EXTERNAL_1477517873911974944$$SRC_APP_SCHEDULES_SUMS_TABLE_SCHEDULES_COMPONENT_TS__3;\r\n    }\r\n    else {\r\n        i18n_2 = $localize `:␟19e8cec43e3ef603a22510f4c8fcc2febb5c3844␟1477517873911974944:Person in charge`;\r\n    } return [[2, \"text-align\", \"center\"], i18n_0, [\"mat-table\", \"\", 2, \"text-align\", \"center !important\", 3, \"dataSource\"], [\"matColumnDef\", \"key\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [3, \"matColumnDef\", 4, \"ngFor\", \"ngForOf\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-header-cell\", \"\"], i18n_2, [\"mat-cell\", \"\"], [3, \"matColumnDef\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]]; }, template: function SumsTableSchedulesComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"h1\", 0);\r\n        i0.ɵɵi18n(1, 1);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(2, \"table\", 2);\r\n        i0.ɵɵelementContainerStart(3, 3);\r\n        i0.ɵɵtemplate(4, SumsTableSchedulesComponent_th_4_Template, 2, 0, \"th\", 4);\r\n        i0.ɵɵtemplate(5, SumsTableSchedulesComponent_td_5_Template, 2, 1, \"td\", 5);\r\n        i0.ɵɵelementContainerEnd();\r\n        i0.ɵɵtemplate(6, SumsTableSchedulesComponent_ng_container_6_Template, 3, 1, \"ng-container\", 6);\r\n        i0.ɵɵtemplate(7, SumsTableSchedulesComponent_tr_7_Template, 1, 0, \"tr\", 7);\r\n        i0.ɵɵtemplate(8, SumsTableSchedulesComponent_tr_8_Template, 1, 0, \"tr\", 8);\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"dataSource\", ctx.sumDataSource);\r\n        i0.ɵɵadvance(4);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.sumClumensshow);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"matHeaderRowDef\", ctx.sumClumensTable);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"matRowDefColumns\", ctx.sumClumensTable);\r\n    } }, directives: [i1.MatTable, i1.MatColumnDef, i1.MatHeaderCellDef, i1.MatCellDef, i2.NgForOf, i1.MatHeaderRowDef, i1.MatRowDef, i1.MatHeaderCell, i1.MatCell, i1.MatHeaderRow, i1.MatRow], pipes: [i2.DecimalPipe], encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}
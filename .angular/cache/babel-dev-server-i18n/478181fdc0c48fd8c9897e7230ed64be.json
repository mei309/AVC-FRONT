{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { NavigationEnd } from '@angular/router';\nimport { distinctUntilChanged, take } from 'rxjs/operators';\nimport { cloneDeep } from 'lodash-es';\nimport { InventoryDetailsDialogComponent } from './inventory-details-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"./inventory.service\";\nimport * as i3 from \"../genral.service\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../components/dynamic-field/dynamic-field.directive\";\nimport * as i8 from \"../components/dynamic-form/dynamic-form.component\";\n\nfunction InventoryRelocationComponent_fieldset_0_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0, 5);\n  }\n\n  if (rf & 2) {\n    const field_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"field\", field_r3)(\"group\", ctx_r2.form);\n  }\n}\n\nconst _c2 = function () {\n  return {\n    \"width\": \"90%\"\n  };\n};\n\nfunction InventoryRelocationComponent_fieldset_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"fieldset\", 2);\n    i0.ɵɵelementStart(1, \"legend\");\n    i0.ɵɵelementStart(2, \"h1\");\n    i0.ɵɵi18n(3, 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, InventoryRelocationComponent_fieldset_0_ng_container_4_Template, 1, 2, \"ng-container\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(2, _c2));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.poConfig);\n  }\n}\n\nfunction InventoryRelocationComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"dynamic-form\", 6);\n    i0.ɵɵlistener(\"submitForm\", function InventoryRelocationComponent_div_1_Template_dynamic_form_submitForm_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.submit($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"fields\", ctx_r1.regConfigHopper)(\"putData\", ctx_r1.dataSource);\n  }\n}\n\nexport class InventoryRelocationComponent {\n  constructor(fb, cdRef, localService, genral, dialog, _Activatedroute, router) {\n    this.fb = fb;\n    this.cdRef = cdRef;\n    this.localService = localService;\n    this.genral = genral;\n    this.dialog = dialog;\n    this._Activatedroute = _Activatedroute;\n    this.router = router;\n    this.isDataAvailable = false;\n    this.isFormAvailable = false;\n    this.isNew = true;\n    this.num = 0;\n  }\n\n  submit(value) {\n    var arr = [];\n    var newWarehouse = value['newWarehouse'] ? value['newWarehouse']['warehouseLocation'] : null;\n    delete value['newWarehouse'];\n\n    if (value['usedItemsNormal']) {\n      value['usedItemsNormal'].forEach(element => {\n        // element['measureUnit'] = element['storageMoves'][0]['measureUnit'];\n        element['storageMoves'] = element['storageMoves'].filter(amou => amou.numberUsedUnits);\n        element['groupName'] = 'normalRelocation';\n        element['storageMoves'].forEach(ele => {\n          ele['unitAmount'] = ele['storage']['unitAmount'];\n          ele['numberUnits'] = ele['numberUsedUnits'];\n          ele['warehouseLocation'] = newWarehouse;\n        });\n      });\n      value['usedItemsNormal'] = value['usedItemsNormal'].filter(amou => amou.storageMoves.length);\n      arr = arr.concat(value['usedItemsNormal']);\n      delete value['usedItemsNormal'];\n    }\n\n    if (value['usedItemsTable']) {\n      value['usedItemsTable'].forEach(element => {\n        element['storageMove']['amounts'] = element['storageMove']['amounts'].filter(amou => amou.take);\n        element['storageMove']['amounts'].forEach(ele => {\n          if (!ele['storageId']) {\n            ele['storageId'] = ele['id'];\n            delete ele['id'];\n            ele['storageVersion'] = ele['version'];\n            delete ele['version'];\n          }\n        });\n        element['storageMove']['newWarehouseLocation'] = newWarehouse;\n        element['groupName'] = 'tableRelocation';\n        element['measureUnit'] = element['storageMove']['measureUnit'];\n      });\n      value['usedItemsTable'] = value['usedItemsTable'].filter(amou => amou.storageMove.amounts.length);\n      arr = arr.concat(value['usedItemsTable']);\n      delete value['usedItemsTable'];\n    }\n\n    value['storageMovesGroups'] = arr;\n\n    if (!value['productionLine']) {\n      this.genral.getProductionLine('PRODUCT_STORAGE').pipe(take(1)).subscribe(val => {\n        value['productionLine'] = val[0];\n        this.submitToBackend(value);\n      });\n    } else {\n      this.submitToBackend(value);\n    }\n  }\n\n  submitToBackend(value) {\n    this.localService.addEditRelocationTransfer(value, this.isNew).pipe(take(1)).subscribe(val => {\n      const dialogRef = this.dialog.open(InventoryDetailsDialogComponent, {\n        width: '80%',\n        data: {\n          inventoryItem: cloneDeep(val),\n          fromNew: true,\n          type: \"Relocation\"\n        }\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result === \"Edit\") {\n          // this.isDataAvailable = false;\n          this.isFormAvailable = false;\n          this.dataSource = null;\n          this.cdRef.detectChanges();\n          this.localService.getStorageByPo(val['poCode']['id'], val['id']).pipe(take(1)).subscribe(val1 => {\n            this.fillEdit([val, val1]);\n          });\n        } else {\n          this.router.navigate(['../Reports', {\n            number: 2\n          }], {\n            relativeTo: this._Activatedroute\n          });\n        }\n      });\n    });\n  }\n\n  fillEdit(val) {\n    var arrTable = [];\n    var arrNormal = [];\n    var removeIdsNormal = [];\n    var removeIdsTable = [];\n    val[0]['storageMovesGroups'].forEach(element => {\n      if (element['storageMove']) {\n        element['storageMove']['amounts'].forEach(ele => {\n          ele['take'] = true;\n\n          if (ele['amount'] === ele['numberAvailableUnits']) {\n            removeIdsTable.push(ele['storageId']);\n          } // removeIdsTable.push(ele['id']);\n\n        });\n        arrTable.push(element); // if(!val[0]['itemCounts'].some( vendor => vendor['item']['value'] === element['storageMove']['item']['value'] )) {\n        //     val[0]['itemCounts'].push({item: element['storageMove']['item']});\n        // }\n      } else if (element['storageMoves']) {\n        element['storageMoves'].forEach(el => {\n          el['storage']['numberAvailableUnits'] = el['numberAvailableUnits']; // removeIdsNormal.push(el['id']);\n\n          removeIdsNormal.push(el['storage']['id']); // if(!val[0]['itemCounts'].some( vendor => vendor['item']['value'] === el['item']['value'] )) {\n          //     val[0]['itemCounts'].push({item: el['item']});\n          // }\n        });\n        arrNormal.push(element);\n      }\n    });\n    const temp = val[0]['storageMovesGroups'][0];\n\n    if (temp['storageMove']) {\n      val[0]['newWarehouse'] = {\n        warehouseLocation: temp['storageMove']['newWarehouseLocation']\n      };\n    } else {\n      val[0]['newWarehouse'] = {\n        warehouseLocation: temp['storageMoves'][0]['warehouseLocation']\n      };\n    }\n\n    delete val[0]['storageMovesGroups'];\n    this.dataSource = val[0];\n    this.dataSource['usedItemsTable'] = [];\n    this.dataSource['usedItemsNormal'] = [];\n    this.setAfterChoose(val[1], removeIdsNormal, removeIdsTable);\n\n    if (arrTable.length) {\n      this.dataSource['usedItemsTable'] = this.dataSource['usedItemsTable'].concat(arrTable);\n    }\n\n    if (arrNormal.length) {\n      this.dataSource['usedItemsNormal'] = this.dataSource['usedItemsNormal'].concat(arrNormal);\n    }\n\n    this.cleanUnwanted();\n    this.isNew = false;\n    this.isFormAvailable = true;\n  }\n\n  setBeginChoose() {\n    this.form = this.fb.group({});\n    this.form.addControl('poCode', this.fb.control(''));\n    this.form.get('poCode').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\n      if (selectedValue && selectedValue.hasOwnProperty('id') && this.poID != selectedValue['id']) {\n        this.localService.getStorageByPo(selectedValue['id']).pipe(take(1)).subscribe(val => {\n          this.dataSource = {\n            poCode: selectedValue,\n            usedItemsTable: [],\n            usedItemsNormal: [],\n            itemCounts: []\n          };\n          this.setAfterChoose(val);\n          this.cleanUnwanted();\n        });\n        this.isDataAvailable = false;\n        this.poID = selectedValue['id'];\n      }\n    });\n    this.isDataAvailable = true;\n    this.setPoConfig();\n  }\n\n  setPoConfig() {\n    this.poConfig = [{\n      type: 'selectgroup',\n      inputType: 'supplierName',\n      options: this.localService.getAllCGPos(),\n      collections: [{\n        type: 'select',\n        label: \"Supplier\"\n      }, {\n        type: 'select',\n        label: \"#PO\",\n        name: 'poCode',\n        collections: 'somewhere'\n      }]\n    }];\n  }\n\n  setAfterChoose(val, removeIdsNormal, removeIdsTable) {\n    var arrNormal = [];\n    var arrTable = [];\n    var arrUsedItems = [];\n    val === null || val === void 0 ? void 0 : val.forEach(element => {\n      if (element['storage']) {\n        if (!removeIdsTable || (element['storage']['amounts'] = element['storage']['amounts'].filter(amou => !removeIdsTable.includes(amou.id))).length) {\n          element['storage']['amounts'].forEach(ele => {\n            ele['amount'] = ele['numberAvailableUnits'];\n          });\n          element['storage']['item'] = element['item'];\n          element['storage']['measureUnit'] = element['measureUnit'];\n          element['storage']['itemProcessDate'] = element['itemProcessDate'];\n          arrTable.push({\n            storageMove: element['storage']\n          });\n        }\n      } else if (element['storageForms']) {\n        element['storageForms'].forEach(ele => {\n          if (!removeIdsNormal || !removeIdsNormal.includes(ele['id'])) {\n            arrUsedItems.push({\n              item: element['item'],\n              itemProcessDate: element['itemProcessDate'],\n              measureUnit: element['measureUnit'],\n              storage: ele\n            });\n            delete ele['numberUsedUnits'];\n          }\n        });\n      }\n    });\n\n    if (arrUsedItems.length) {\n      arrNormal.push({\n        storageMoves: arrUsedItems\n      });\n    }\n\n    if (arrTable.length) {\n      this.dataSource['usedItemsTable'] = arrTable;\n    }\n\n    if (arrNormal.length) {\n      this.dataSource['usedItemsNormal'] = arrNormal;\n    }\n\n    this.isFormAvailable = true;\n  }\n\n  cleanUnwanted() {\n    if (!this.dataSource['usedItemsTable'].length) {\n      var ind = this.regConfigHopper.findIndex(em => em['name'] === 'usedItemsTable');\n\n      if (ind !== -1) {\n        this.regConfigHopper.splice(ind, 1);\n      }\n    }\n\n    if (!this.dataSource['usedItemsNormal'].length) {\n      var ind = this.regConfigHopper.findIndex(em => em['name'] === 'usedItemsNormal');\n\n      if (ind !== -1) {\n        this.regConfigHopper.splice(ind, 1);\n      }\n    }\n  }\n\n  ngOnInit() {\n    this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\n      if (params.get('id')) {\n        this.localService.getStorageTransferWithStorage(+params.get('id'), params.getAll('poCodes').map(el => parseInt(el))).pipe(take(1)).subscribe(val => {\n          this.fillEdit(val);\n        });\n      } else {\n        this.setBeginChoose();\n      }\n    });\n\n    this.setRegConfig();\n    this.navigationSubscription = this.router.events.subscribe(e => {\n      if (e instanceof NavigationEnd) {\n        this.isDataAvailable = false;\n        this.isFormAvailable = false;\n        this.dataSource = null;\n        this.poID = null;\n        this.isNew = true;\n\n        if (this.poConfig) {\n          this.form.get('poCode').setValue(null);\n          this.setPoConfig();\n        } else {\n          this.setBeginChoose();\n        }\n\n        this.cdRef.detectChanges();\n        this.isDataAvailable = true;\n      }\n    });\n  }\n\n  setRegConfig() {\n    this.regConfigHopper = [{\n      type: 'selectgroup',\n      inputType: 'supplierName',\n      disable: true,\n      collections: [{\n        type: 'select',\n        label: \"Supllier\"\n      }, {\n        type: 'select',\n        label: \"#PO\",\n        name: 'poCode',\n        collections: 'somewhere',\n        validations: [{\n          name: 'required',\n          validator: Validators.required,\n          message: \"#PO Required\"\n        }]\n      }]\n    }, {\n      type: 'date',\n      label: \"Date\",\n      value: 'timeNow',\n      name: 'recordedTime',\n      options: 'withTime',\n      validations: [{\n        name: 'required',\n        validator: Validators.required,\n        message: \"Date Required\"\n      }]\n    }, {\n      type: 'select',\n      label: \"Production line\",\n      value: 'firstVal',\n      name: 'productionLine',\n      options: this.genral.getProductionLine('PRODUCT_STORAGE')\n    }, {\n      type: 'bigexpand',\n      name: 'usedItemsNormal',\n      label: \"Transfering amounts\",\n      options: 'aloneNoAdd',\n      collections: [{\n        type: 'tableWithInput',\n        // label: 'Transfer from',\n        name: 'storageMoves',\n        options: 'numberUsedUnits',\n        collections: [{\n          type: 'select',\n          label: \"Item\",\n          name: 'item',\n          disable: true\n        }, {\n          type: 'date',\n          label: \"Process date\",\n          name: 'itemProcessDate',\n          disable: true\n        }, {\n          type: 'input',\n          label: \"Weight unit\",\n          name: 'measureUnit'\n        }, {\n          type: 'bignotexpand',\n          name: 'storage',\n          collections: [{\n            type: 'input',\n            label: \"Number of units\",\n            name: 'numberUnits',\n            disable: true\n          }, {\n            type: 'input',\n            name: 'unitAmount',\n            label: \"Unit weight\",\n            disable: true\n          }, {\n            type: 'select',\n            label: \"Warehouse location\",\n            name: 'warehouseLocation',\n            disable: true\n          }, {\n            type: 'input',\n            label: \"Number available units\",\n            name: 'numberAvailableUnits',\n            disable: true\n          }]\n        }]\n      }]\n    }, {\n      type: 'bigexpand',\n      name: 'usedItemsTable',\n      label: \"Transfering amounts\",\n      options: 'aloneNoAdd',\n      collections: [{\n        type: 'bignotexpand',\n        name: 'storageMove',\n        // label: 'Transfer from',\n        options: 'aloneNoAdd',\n        collections: [{\n          type: 'inputReadonlySelect',\n          label: \"Item descrption\",\n          name: 'item',\n          disable: true\n        }, {\n          type: 'date',\n          label: \"Process date\",\n          name: 'itemProcessDate',\n          disable: true\n        }, {\n          type: 'inputReadonly',\n          label: \"Weight unit\",\n          name: 'measureUnit',\n          disable: true\n        }, {\n          type: 'inputReadonlySelect',\n          label: \"Warehouse location\",\n          name: 'warehouseLocation',\n          disable: true\n        }, //  {\n        //      type: 'inputReadonly',\n        //      label: 'Empty container weight',\n        //      name: 'containerWeight',\n        //      disable: true,\n        //  },\n        {\n          type: 'arrayordinal',\n          label: \"Unit weight\",\n          name: 'amounts',\n          inputType: 'choose',\n          options: 3,\n          collections: 30\n        }]\n      }]\n    }, {\n      type: 'bignotexpand',\n      name: 'newWarehouse',\n      label: \"New warehouse location\",\n      collections: [{\n        type: 'select',\n        label: \"Warehouse location\",\n        name: 'warehouseLocation',\n        collections: 'somewhere',\n        options: this.genral.getWearhouses()\n      }]\n    }, {\n      type: 'button',\n      label: \"Submit\",\n      name: 'submit'\n    }];\n  }\n\n  ngOnDestroy() {\n    if (this.navigationSubscription) {\n      this.navigationSubscription.unsubscribe();\n    }\n  }\n\n}\n\nInventoryRelocationComponent.ɵfac = function InventoryRelocationComponent_Factory(t) {\n  return new (t || InventoryRelocationComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i2.InventoryService), i0.ɵɵdirectiveInject(i3.Genral), i0.ɵɵdirectiveInject(i4.MatDialog), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router));\n};\n\nInventoryRelocationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: InventoryRelocationComponent,\n  selectors: [[\"inventory-relocation\"]],\n  decls: 2,\n  vars: 2,\n  consts: function () {\n    let i18n_0;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__1 = goog.getMsg(\"Relocation\");\n      i18n_0 = MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__1;\n    } else {\n      i18n_0 = \"Relocation\";\n    }\n\n    let i18n_3;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__4 = goog.getMsg(\"Relocation\");\n      i18n_3 = MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__4;\n    } else {\n      i18n_3 = \"Relocation\";\n    }\n\n    return [[3, \"ngStyle\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"ngStyle\"], i18n_0, [\"dynamicField\", \"\", 3, \"field\", \"group\", 4, \"ngFor\", \"ngForOf\"], [\"dynamicField\", \"\", 3, \"field\", \"group\"], [\"mainLabel\", i18n_3, 3, \"fields\", \"putData\", \"submitForm\"]];\n  },\n  template: function InventoryRelocationComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, InventoryRelocationComponent_fieldset_0_Template, 5, 3, \"fieldset\", 0);\n      i0.ɵɵtemplate(1, InventoryRelocationComponent_div_1_Template, 2, 2, \"div\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.isDataAvailable);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isFormAvailable);\n    }\n  },\n  directives: [i6.NgIf, i6.NgStyle, i6.NgForOf, i7.DynamicFieldDirective, i8.DynamicFormComponent],\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/isral/OneDrive/Documents/AVC-FRONT/src/app/inventory/inventory-reloaction.component.ts"],"names":["Validators","NavigationEnd","distinctUntilChanged","take","cloneDeep","InventoryDetailsDialogComponent","i0","i1","i2","i3","i4","i5","i6","i7","i8","InventoryRelocationComponent_fieldset_0_ng_container_4_Template","rf","ctx","ɵɵelementContainer","field_r3","$implicit","ctx_r2","ɵɵnextContext","ɵɵproperty","form","_c2","InventoryRelocationComponent_fieldset_0_Template","ɵɵelementStart","ɵɵi18n","ɵɵelementEnd","ɵɵtemplate","ctx_r0","ɵɵpureFunction0","ɵɵadvance","poConfig","InventoryRelocationComponent_div_1_Template","_r5","ɵɵgetCurrentView","ɵɵlistener","InventoryRelocationComponent_div_1_Template_dynamic_form_submitForm_1_listener","$event","ɵɵrestoreView","ctx_r4","submit","ctx_r1","regConfigHopper","dataSource","InventoryRelocationComponent","constructor","fb","cdRef","localService","genral","dialog","_Activatedroute","router","isDataAvailable","isFormAvailable","isNew","num","value","arr","newWarehouse","forEach","element","filter","amou","numberUsedUnits","ele","storageMoves","length","concat","storageMove","amounts","getProductionLine","pipe","subscribe","val","submitToBackend","addEditRelocationTransfer","dialogRef","open","width","data","inventoryItem","fromNew","type","afterClosed","result","detectChanges","getStorageByPo","val1","fillEdit","navigate","number","relativeTo","arrTable","arrNormal","removeIdsNormal","removeIdsTable","push","el","temp","warehouseLocation","setAfterChoose","cleanUnwanted","setBeginChoose","group","addControl","control","get","valueChanges","selectedValue","hasOwnProperty","poID","poCode","usedItemsTable","usedItemsNormal","itemCounts","setPoConfig","inputType","options","getAllCGPos","collections","label","name","arrUsedItems","includes","id","item","itemProcessDate","measureUnit","storage","ind","findIndex","em","splice","ngOnInit","paramMap","params","getStorageTransferWithStorage","getAll","map","parseInt","setRegConfig","navigationSubscription","events","e","setValue","disable","validations","validator","required","message","getWearhouses","ngOnDestroy","unsubscribe","ɵfac","InventoryRelocationComponent_Factory","t","ɵɵdirectiveInject","FormBuilder","ChangeDetectorRef","InventoryService","Genral","MatDialog","ActivatedRoute","Router","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","i18n_0","ngI18nClosureMode","MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__1","goog","getMsg","i18n_3","MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__4","template","InventoryRelocationComponent_Template","directives","NgIf","NgStyle","NgForOf","DynamicFieldDirective","DynamicFormComponent","encapsulation"],"mappings":"AAAA,SAASA,UAAT,QAA2B,gBAA3B;AACA,SAASC,aAAT,QAA8B,iBAA9B;AACA,SAASC,oBAAT,EAA+BC,IAA/B,QAA2C,gBAA3C;AACA,SAASC,SAAT,QAA0B,WAA1B;AACA,SAASC,+BAAT,QAAgD,sCAAhD;AACA,OAAO,KAAKC,EAAZ,MAAoB,eAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,gBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,qBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,mBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,0BAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,qDAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,mDAApB;;AACA,SAASC,+DAAT,CAAyEC,EAAzE,EAA6EC,GAA7E,EAAkF;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AAC5FV,IAAAA,EAAE,CAACY,kBAAH,CAAsB,CAAtB,EAAyB,CAAzB;AACH;;AAAC,MAAIF,EAAE,GAAG,CAAT,EAAY;AACV,UAAMG,QAAQ,GAAGF,GAAG,CAACG,SAArB;AACA,UAAMC,MAAM,GAAGf,EAAE,CAACgB,aAAH,CAAiB,CAAjB,CAAf;AACAhB,IAAAA,EAAE,CAACiB,UAAH,CAAc,OAAd,EAAuBJ,QAAvB,EAAiC,OAAjC,EAA0CE,MAAM,CAACG,IAAjD;AACH;AAAE;;AACH,MAAMC,GAAG,GAAG,YAAY;AAAE,SAAO;AAAE,aAAS;AAAX,GAAP;AAA4B,CAAtD;;AACA,SAASC,gDAAT,CAA0DV,EAA1D,EAA8DC,GAA9D,EAAmE;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AAC7EV,IAAAA,EAAE,CAACqB,cAAH,CAAkB,CAAlB,EAAqB,UAArB,EAAiC,CAAjC;AACArB,IAAAA,EAAE,CAACqB,cAAH,CAAkB,CAAlB,EAAqB,QAArB;AACArB,IAAAA,EAAE,CAACqB,cAAH,CAAkB,CAAlB,EAAqB,IAArB;AACArB,IAAAA,EAAE,CAACsB,MAAH,CAAU,CAAV,EAAa,CAAb;AACAtB,IAAAA,EAAE,CAACuB,YAAH;AACAvB,IAAAA,EAAE,CAACuB,YAAH;AACAvB,IAAAA,EAAE,CAACwB,UAAH,CAAc,CAAd,EAAiBf,+DAAjB,EAAkF,CAAlF,EAAqF,CAArF,EAAwF,cAAxF,EAAwG,CAAxG;AACAT,IAAAA,EAAE,CAACuB,YAAH;AACH;;AAAC,MAAIb,EAAE,GAAG,CAAT,EAAY;AACV,UAAMe,MAAM,GAAGzB,EAAE,CAACgB,aAAH,EAAf;AACAhB,IAAAA,EAAE,CAACiB,UAAH,CAAc,SAAd,EAAyBjB,EAAE,CAAC0B,eAAH,CAAmB,CAAnB,EAAsBP,GAAtB,CAAzB;AACAnB,IAAAA,EAAE,CAAC2B,SAAH,CAAa,CAAb;AACA3B,IAAAA,EAAE,CAACiB,UAAH,CAAc,SAAd,EAAyBQ,MAAM,CAACG,QAAhC;AACH;AAAE;;AACH,SAASC,2CAAT,CAAqDnB,EAArD,EAAyDC,GAAzD,EAA8D;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AACxE,UAAMoB,GAAG,GAAG9B,EAAE,CAAC+B,gBAAH,EAAZ;;AACA/B,IAAAA,EAAE,CAACqB,cAAH,CAAkB,CAAlB,EAAqB,KAArB;AACArB,IAAAA,EAAE,CAACqB,cAAH,CAAkB,CAAlB,EAAqB,cAArB,EAAqC,CAArC;AACArB,IAAAA,EAAE,CAACgC,UAAH,CAAc,YAAd,EAA4B,SAASC,8EAAT,CAAwFC,MAAxF,EAAgG;AAAElC,MAAAA,EAAE,CAACmC,aAAH,CAAiBL,GAAjB;AAAuB,YAAMM,MAAM,GAAGpC,EAAE,CAACgB,aAAH,EAAf;AAAmC,aAAOoB,MAAM,CAACC,MAAP,CAAcH,MAAd,CAAP;AAA+B,KAAvN;AACAlC,IAAAA,EAAE,CAACuB,YAAH;AACAvB,IAAAA,EAAE,CAACuB,YAAH;AACH;;AAAC,MAAIb,EAAE,GAAG,CAAT,EAAY;AACV,UAAM4B,MAAM,GAAGtC,EAAE,CAACgB,aAAH,EAAf;AACAhB,IAAAA,EAAE,CAAC2B,SAAH,CAAa,CAAb;AACA3B,IAAAA,EAAE,CAACiB,UAAH,CAAc,QAAd,EAAwBqB,MAAM,CAACC,eAA/B,EAAgD,SAAhD,EAA2DD,MAAM,CAACE,UAAlE;AACH;AAAE;;AACH,OAAO,MAAMC,4BAAN,CAAmC;AACtCC,EAAAA,WAAW,CAACC,EAAD,EAAKC,KAAL,EAAYC,YAAZ,EAA0BC,MAA1B,EAAkCC,MAAlC,EAA0CC,eAA1C,EAA2DC,MAA3D,EAAmE;AAC1E,SAAKN,EAAL,GAAUA,EAAV;AACA,SAAKC,KAAL,GAAaA,KAAb;AACA,SAAKC,YAAL,GAAoBA,YAApB;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,eAAL,GAAuBA,eAAvB;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,eAAL,GAAuB,KAAvB;AACA,SAAKC,eAAL,GAAuB,KAAvB;AACA,SAAKC,KAAL,GAAa,IAAb;AACA,SAAKC,GAAL,GAAW,CAAX;AACH;;AACDhB,EAAAA,MAAM,CAACiB,KAAD,EAAQ;AACV,QAAIC,GAAG,GAAG,EAAV;AACA,QAAIC,YAAY,GAAGF,KAAK,CAAC,cAAD,CAAL,GAAwBA,KAAK,CAAC,cAAD,CAAL,CAAsB,mBAAtB,CAAxB,GAAqE,IAAxF;AACA,WAAOA,KAAK,CAAC,cAAD,CAAZ;;AACA,QAAIA,KAAK,CAAC,iBAAD,CAAT,EAA8B;AAC1BA,MAAAA,KAAK,CAAC,iBAAD,CAAL,CAAyBG,OAAzB,CAAiCC,OAAO,IAAI;AACxC;AACAA,QAAAA,OAAO,CAAC,cAAD,CAAP,GAA0BA,OAAO,CAAC,cAAD,CAAP,CAAwBC,MAAxB,CAA+BC,IAAI,IAAIA,IAAI,CAACC,eAA5C,CAA1B;AACAH,QAAAA,OAAO,CAAC,WAAD,CAAP,GAAuB,kBAAvB;AACAA,QAAAA,OAAO,CAAC,cAAD,CAAP,CAAwBD,OAAxB,CAAgCK,GAAG,IAAI;AACnCA,UAAAA,GAAG,CAAC,YAAD,CAAH,GAAoBA,GAAG,CAAC,SAAD,CAAH,CAAe,YAAf,CAApB;AACAA,UAAAA,GAAG,CAAC,aAAD,CAAH,GAAqBA,GAAG,CAAC,iBAAD,CAAxB;AACAA,UAAAA,GAAG,CAAC,mBAAD,CAAH,GAA2BN,YAA3B;AACH,SAJD;AAKH,OATD;AAUAF,MAAAA,KAAK,CAAC,iBAAD,CAAL,GAA2BA,KAAK,CAAC,iBAAD,CAAL,CAAyBK,MAAzB,CAAgCC,IAAI,IAAIA,IAAI,CAACG,YAAL,CAAkBC,MAA1D,CAA3B;AACAT,MAAAA,GAAG,GAAGA,GAAG,CAACU,MAAJ,CAAWX,KAAK,CAAC,iBAAD,CAAhB,CAAN;AACA,aAAOA,KAAK,CAAC,iBAAD,CAAZ;AACH;;AACD,QAAIA,KAAK,CAAC,gBAAD,CAAT,EAA6B;AACzBA,MAAAA,KAAK,CAAC,gBAAD,CAAL,CAAwBG,OAAxB,CAAgCC,OAAO,IAAI;AACvCA,QAAAA,OAAO,CAAC,aAAD,CAAP,CAAuB,SAAvB,IAAoCA,OAAO,CAAC,aAAD,CAAP,CAAuB,SAAvB,EAAkCC,MAAlC,CAAyCC,IAAI,IAAIA,IAAI,CAAC/D,IAAtD,CAApC;AACA6D,QAAAA,OAAO,CAAC,aAAD,CAAP,CAAuB,SAAvB,EAAkCD,OAAlC,CAA0CK,GAAG,IAAI;AAC7C,cAAI,CAACA,GAAG,CAAC,WAAD,CAAR,EAAuB;AACnBA,YAAAA,GAAG,CAAC,WAAD,CAAH,GAAmBA,GAAG,CAAC,IAAD,CAAtB;AACA,mBAAOA,GAAG,CAAC,IAAD,CAAV;AACAA,YAAAA,GAAG,CAAC,gBAAD,CAAH,GAAwBA,GAAG,CAAC,SAAD,CAA3B;AACA,mBAAOA,GAAG,CAAC,SAAD,CAAV;AACH;AACJ,SAPD;AAQAJ,QAAAA,OAAO,CAAC,aAAD,CAAP,CAAuB,sBAAvB,IAAiDF,YAAjD;AACAE,QAAAA,OAAO,CAAC,WAAD,CAAP,GAAuB,iBAAvB;AACAA,QAAAA,OAAO,CAAC,aAAD,CAAP,GAAyBA,OAAO,CAAC,aAAD,CAAP,CAAuB,aAAvB,CAAzB;AACH,OAbD;AAcAJ,MAAAA,KAAK,CAAC,gBAAD,CAAL,GAA0BA,KAAK,CAAC,gBAAD,CAAL,CAAwBK,MAAxB,CAA+BC,IAAI,IAAIA,IAAI,CAACM,WAAL,CAAiBC,OAAjB,CAAyBH,MAAhE,CAA1B;AACAT,MAAAA,GAAG,GAAGA,GAAG,CAACU,MAAJ,CAAWX,KAAK,CAAC,gBAAD,CAAhB,CAAN;AACA,aAAOA,KAAK,CAAC,gBAAD,CAAZ;AACH;;AACDA,IAAAA,KAAK,CAAC,oBAAD,CAAL,GAA8BC,GAA9B;;AACA,QAAI,CAACD,KAAK,CAAC,gBAAD,CAAV,EAA8B;AAC1B,WAAKR,MAAL,CAAYsB,iBAAZ,CAA8B,iBAA9B,EAAiDC,IAAjD,CAAsDxE,IAAI,CAAC,CAAD,CAA1D,EAA+DyE,SAA/D,CAAyEC,GAAG,IAAI;AAC5EjB,QAAAA,KAAK,CAAC,gBAAD,CAAL,GAA0BiB,GAAG,CAAC,CAAD,CAA7B;AACA,aAAKC,eAAL,CAAqBlB,KAArB;AACH,OAHD;AAIH,KALD,MAMK;AACD,WAAKkB,eAAL,CAAqBlB,KAArB;AACH;AACJ;;AACDkB,EAAAA,eAAe,CAAClB,KAAD,EAAQ;AACnB,SAAKT,YAAL,CAAkB4B,yBAAlB,CAA4CnB,KAA5C,EAAmD,KAAKF,KAAxD,EAA+DiB,IAA/D,CAAoExE,IAAI,CAAC,CAAD,CAAxE,EAA6EyE,SAA7E,CAAuFC,GAAG,IAAI;AAC1F,YAAMG,SAAS,GAAG,KAAK3B,MAAL,CAAY4B,IAAZ,CAAiB5E,+BAAjB,EAAkD;AAChE6E,QAAAA,KAAK,EAAE,KADyD;AAEhEC,QAAAA,IAAI,EAAE;AAAEC,UAAAA,aAAa,EAAEhF,SAAS,CAACyE,GAAD,CAA1B;AAAiCQ,UAAAA,OAAO,EAAE,IAA1C;AAAgDC,UAAAA,IAAI;AAApD;AAF0D,OAAlD,CAAlB;AAIAN,MAAAA,SAAS,CAACO,WAAV,GAAwBX,SAAxB,CAAkCY,MAAM,IAAI;AACxC,YAAIA,MAAM,WAAV,EAAiC;AAC7B;AACA,eAAK/B,eAAL,GAAuB,KAAvB;AACA,eAAKX,UAAL,GAAkB,IAAlB;AACA,eAAKI,KAAL,CAAWuC,aAAX;AACA,eAAKtC,YAAL,CAAkBuC,cAAlB,CAAiCb,GAAG,CAAC,QAAD,CAAH,CAAc,IAAd,CAAjC,EAAsDA,GAAG,CAAC,IAAD,CAAzD,EAAiEF,IAAjE,CAAsExE,IAAI,CAAC,CAAD,CAA1E,EAA+EyE,SAA/E,CAAyFe,IAAI,IAAI;AAC7F,iBAAKC,QAAL,CAAc,CAACf,GAAD,EAAMc,IAAN,CAAd;AACH,WAFD;AAGH,SARD,MASK;AACD,eAAKpC,MAAL,CAAYsC,QAAZ,CAAqB,CAAC,YAAD,EAAe;AAAEC,YAAAA,MAAM,EAAE;AAAV,WAAf,CAArB,EAAoD;AAAEC,YAAAA,UAAU,EAAE,KAAKzC;AAAnB,WAApD;AACH;AACJ,OAbD;AAcH,KAnBD;AAoBH;;AACDsC,EAAAA,QAAQ,CAACf,GAAD,EAAM;AACV,QAAImB,QAAQ,GAAG,EAAf;AACA,QAAIC,SAAS,GAAG,EAAhB;AACA,QAAIC,eAAe,GAAG,EAAtB;AACA,QAAIC,cAAc,GAAG,EAArB;AACAtB,IAAAA,GAAG,CAAC,CAAD,CAAH,CAAO,oBAAP,EAA6Bd,OAA7B,CAAqCC,OAAO,IAAI;AAC5C,UAAIA,OAAO,CAAC,aAAD,CAAX,EAA4B;AACxBA,QAAAA,OAAO,CAAC,aAAD,CAAP,CAAuB,SAAvB,EAAkCD,OAAlC,CAA0CK,GAAG,IAAI;AAC7CA,UAAAA,GAAG,CAAC,MAAD,CAAH,GAAc,IAAd;;AACA,cAAIA,GAAG,CAAC,QAAD,CAAH,KAAkBA,GAAG,CAAC,sBAAD,CAAzB,EAAmD;AAC/C+B,YAAAA,cAAc,CAACC,IAAf,CAAoBhC,GAAG,CAAC,WAAD,CAAvB;AACH,WAJ4C,CAK7C;;AACH,SAND;AAOA4B,QAAAA,QAAQ,CAACI,IAAT,CAAcpC,OAAd,EARwB,CASxB;AACA;AACA;AACH,OAZD,MAaK,IAAIA,OAAO,CAAC,cAAD,CAAX,EAA6B;AAC9BA,QAAAA,OAAO,CAAC,cAAD,CAAP,CAAwBD,OAAxB,CAAgCsC,EAAE,IAAI;AAClCA,UAAAA,EAAE,CAAC,SAAD,CAAF,CAAc,sBAAd,IAAwCA,EAAE,CAAC,sBAAD,CAA1C,CADkC,CAElC;;AACAH,UAAAA,eAAe,CAACE,IAAhB,CAAqBC,EAAE,CAAC,SAAD,CAAF,CAAc,IAAd,CAArB,EAHkC,CAIlC;AACA;AACA;AACH,SAPD;AAQAJ,QAAAA,SAAS,CAACG,IAAV,CAAepC,OAAf;AACH;AACJ,KAzBD;AA0BA,UAAMsC,IAAI,GAAGzB,GAAG,CAAC,CAAD,CAAH,CAAO,oBAAP,EAA6B,CAA7B,CAAb;;AACA,QAAIyB,IAAI,CAAC,aAAD,CAAR,EAAyB;AACrBzB,MAAAA,GAAG,CAAC,CAAD,CAAH,CAAO,cAAP,IAAyB;AAAE0B,QAAAA,iBAAiB,EAAED,IAAI,CAAC,aAAD,CAAJ,CAAoB,sBAApB;AAArB,OAAzB;AACH,KAFD,MAGK;AACDzB,MAAAA,GAAG,CAAC,CAAD,CAAH,CAAO,cAAP,IAAyB;AAAE0B,QAAAA,iBAAiB,EAAED,IAAI,CAAC,cAAD,CAAJ,CAAqB,CAArB,EAAwB,mBAAxB;AAArB,OAAzB;AACH;;AACD,WAAOzB,GAAG,CAAC,CAAD,CAAH,CAAO,oBAAP,CAAP;AACA,SAAK/B,UAAL,GAAkB+B,GAAG,CAAC,CAAD,CAArB;AACA,SAAK/B,UAAL,CAAgB,gBAAhB,IAAoC,EAApC;AACA,SAAKA,UAAL,CAAgB,iBAAhB,IAAqC,EAArC;AACA,SAAK0D,cAAL,CAAoB3B,GAAG,CAAC,CAAD,CAAvB,EAA4BqB,eAA5B,EAA6CC,cAA7C;;AACA,QAAIH,QAAQ,CAAC1B,MAAb,EAAqB;AACjB,WAAKxB,UAAL,CAAgB,gBAAhB,IAAoC,KAAKA,UAAL,CAAgB,gBAAhB,EAAkCyB,MAAlC,CAAyCyB,QAAzC,CAApC;AACH;;AACD,QAAIC,SAAS,CAAC3B,MAAd,EAAsB;AAClB,WAAKxB,UAAL,CAAgB,iBAAhB,IAAqC,KAAKA,UAAL,CAAgB,iBAAhB,EAAmCyB,MAAnC,CAA0C0B,SAA1C,CAArC;AACH;;AACD,SAAKQ,aAAL;AACA,SAAK/C,KAAL,GAAa,KAAb;AACA,SAAKD,eAAL,GAAuB,IAAvB;AACH;;AACDiD,EAAAA,cAAc,GAAG;AACb,SAAKlF,IAAL,GAAY,KAAKyB,EAAL,CAAQ0D,KAAR,CAAc,EAAd,CAAZ;AACA,SAAKnF,IAAL,CAAUoF,UAAV,CAAqB,QAArB,EAA+B,KAAK3D,EAAL,CAAQ4D,OAAR,CAAgB,EAAhB,CAA/B;AACA,SAAKrF,IAAL,CAAUsF,GAAV,CAAc,QAAd,EAAwBC,YAAxB,CAAqCpC,IAArC,CAA0CzE,oBAAoB,EAA9D,EAAkE0E,SAAlE,CAA4EoC,aAAa,IAAI;AACzF,UAAIA,aAAa,IAAIA,aAAa,CAACC,cAAd,CAA6B,IAA7B,CAAjB,IAAuD,KAAKC,IAAL,IAAaF,aAAa,CAAC,IAAD,CAArF,EAA6F;AACzF,aAAK7D,YAAL,CAAkBuC,cAAlB,CAAiCsB,aAAa,CAAC,IAAD,CAA9C,EAAsDrC,IAAtD,CAA2DxE,IAAI,CAAC,CAAD,CAA/D,EAAoEyE,SAApE,CAA8EC,GAAG,IAAI;AACjF,eAAK/B,UAAL,GAAkB;AAAEqE,YAAAA,MAAM,EAAEH,aAAV;AAAyBI,YAAAA,cAAc,EAAE,EAAzC;AAA6CC,YAAAA,eAAe,EAAE,EAA9D;AAAkEC,YAAAA,UAAU,EAAE;AAA9E,WAAlB;AACA,eAAKd,cAAL,CAAoB3B,GAApB;AACA,eAAK4B,aAAL;AACH,SAJD;AAKA,aAAKjD,eAAL,GAAuB,KAAvB;AACA,aAAK0D,IAAL,GAAYF,aAAa,CAAC,IAAD,CAAzB;AACH;AACJ,KAVD;AAWA,SAAKxD,eAAL,GAAuB,IAAvB;AACA,SAAK+D,WAAL;AACH;;AACDA,EAAAA,WAAW,GAAG;AACV,SAAKrF,QAAL,GAAgB,CACZ;AACIoD,MAAAA,IAAI,EAAE,aADV;AAEIkC,MAAAA,SAAS,EAAE,cAFf;AAGIC,MAAAA,OAAO,EAAE,KAAKtE,YAAL,CAAkBuE,WAAlB,EAHb;AAIIC,MAAAA,WAAW,EAAE,CACT;AACIrC,QAAAA,IAAI,EAAE,QADV;AAEIsC,QAAAA,KAAK;AAFT,OADS,EAKT;AACItC,QAAAA,IAAI,EAAE,QADV;AAEIsC,QAAAA,KAAK,OAFT;AAGIC,QAAAA,IAAI,EAAE,QAHV;AAIIF,QAAAA,WAAW,EAAE;AAJjB,OALS;AAJjB,KADY,CAAhB;AAmBH;;AACDnB,EAAAA,cAAc,CAAC3B,GAAD,EAAMqB,eAAN,EAAuBC,cAAvB,EAAuC;AACjD,QAAIF,SAAS,GAAG,EAAhB;AACA,QAAID,QAAQ,GAAG,EAAf;AACA,QAAI8B,YAAY,GAAG,EAAnB;AACAjD,IAAAA,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK,KAAK,CAA7B,GAAiC,KAAK,CAAtC,GAA0CA,GAAG,CAACd,OAAJ,CAAYC,OAAO,IAAI;AAC7D,UAAIA,OAAO,CAAC,SAAD,CAAX,EAAwB;AACpB,YAAI,CAACmC,cAAD,IAAmB,CAACnC,OAAO,CAAC,SAAD,CAAP,CAAmB,SAAnB,IAAgCA,OAAO,CAAC,SAAD,CAAP,CAAmB,SAAnB,EAA8BC,MAA9B,CAAqCC,IAAI,IAAI,CAACiC,cAAc,CAAC4B,QAAf,CAAwB7D,IAAI,CAAC8D,EAA7B,CAA9C,CAAjC,EAAkH1D,MAAzI,EAAiJ;AAC7IN,UAAAA,OAAO,CAAC,SAAD,CAAP,CAAmB,SAAnB,EAA8BD,OAA9B,CAAsCK,GAAG,IAAI;AACzCA,YAAAA,GAAG,CAAC,QAAD,CAAH,GAAgBA,GAAG,CAAC,sBAAD,CAAnB;AACH,WAFD;AAGAJ,UAAAA,OAAO,CAAC,SAAD,CAAP,CAAmB,MAAnB,IAA6BA,OAAO,CAAC,MAAD,CAApC;AACAA,UAAAA,OAAO,CAAC,SAAD,CAAP,CAAmB,aAAnB,IAAoCA,OAAO,CAAC,aAAD,CAA3C;AACAA,UAAAA,OAAO,CAAC,SAAD,CAAP,CAAmB,iBAAnB,IAAwCA,OAAO,CAAC,iBAAD,CAA/C;AACAgC,UAAAA,QAAQ,CAACI,IAAT,CAAc;AAAE5B,YAAAA,WAAW,EAAER,OAAO,CAAC,SAAD;AAAtB,WAAd;AACH;AACJ,OAVD,MAWK,IAAIA,OAAO,CAAC,cAAD,CAAX,EAA6B;AAC9BA,QAAAA,OAAO,CAAC,cAAD,CAAP,CAAwBD,OAAxB,CAAgCK,GAAG,IAAI;AACnC,cAAI,CAAC8B,eAAD,IAAoB,CAACA,eAAe,CAAC6B,QAAhB,CAAyB3D,GAAG,CAAC,IAAD,CAA5B,CAAzB,EAA8D;AAC1D0D,YAAAA,YAAY,CAAC1B,IAAb,CAAkB;AAAE6B,cAAAA,IAAI,EAAEjE,OAAO,CAAC,MAAD,CAAf;AAAyBkE,cAAAA,eAAe,EAAElE,OAAO,CAAC,iBAAD,CAAjD;AAAsEmE,cAAAA,WAAW,EAAEnE,OAAO,CAAC,aAAD,CAA1F;AAA2GoE,cAAAA,OAAO,EAAEhE;AAApH,aAAlB;AACA,mBAAOA,GAAG,CAAC,iBAAD,CAAV;AACH;AACJ,SALD;AAMH;AACJ,KApByC,CAA1C;;AAqBA,QAAI0D,YAAY,CAACxD,MAAjB,EAAyB;AACrB2B,MAAAA,SAAS,CAACG,IAAV,CAAe;AAAE/B,QAAAA,YAAY,EAAEyD;AAAhB,OAAf;AACH;;AACD,QAAI9B,QAAQ,CAAC1B,MAAb,EAAqB;AACjB,WAAKxB,UAAL,CAAgB,gBAAhB,IAAoCkD,QAApC;AACH;;AACD,QAAIC,SAAS,CAAC3B,MAAd,EAAsB;AAClB,WAAKxB,UAAL,CAAgB,iBAAhB,IAAqCmD,SAArC;AACH;;AACD,SAAKxC,eAAL,GAAuB,IAAvB;AACH;;AACDgD,EAAAA,aAAa,GAAG;AACZ,QAAI,CAAC,KAAK3D,UAAL,CAAgB,gBAAhB,EAAkCwB,MAAvC,EAA+C;AAC3C,UAAI+D,GAAG,GAAG,KAAKxF,eAAL,CAAqByF,SAArB,CAAgCC,EAAD,IAAQA,EAAE,CAAC,MAAD,CAAF,KAAe,gBAAtD,CAAV;;AACA,UAAIF,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZ,aAAKxF,eAAL,CAAqB2F,MAArB,CAA4BH,GAA5B,EAAiC,CAAjC;AACH;AACJ;;AACD,QAAI,CAAC,KAAKvF,UAAL,CAAgB,iBAAhB,EAAmCwB,MAAxC,EAAgD;AAC5C,UAAI+D,GAAG,GAAG,KAAKxF,eAAL,CAAqByF,SAArB,CAAgCC,EAAD,IAAQA,EAAE,CAAC,MAAD,CAAF,KAAe,iBAAtD,CAAV;;AACA,UAAIF,GAAG,KAAK,CAAC,CAAb,EAAgB;AACZ,aAAKxF,eAAL,CAAqB2F,MAArB,CAA4BH,GAA5B,EAAiC,CAAjC;AACH;AACJ;AACJ;;AACDI,EAAAA,QAAQ,GAAG;AACP,SAAKnF,eAAL,CAAqBoF,QAArB,CAA8B/D,IAA9B,CAAmCxE,IAAI,CAAC,CAAD,CAAvC,EAA4CyE,SAA5C,CAAsD+D,MAAM,IAAI;AAC5D,UAAIA,MAAM,CAAC7B,GAAP,CAAW,IAAX,CAAJ,EAAsB;AAClB,aAAK3D,YAAL,CAAkByF,6BAAlB,CAAgD,CAACD,MAAM,CAAC7B,GAAP,CAAW,IAAX,CAAjD,EAAoE6B,MAAM,CAACE,MAAP,CAAc,SAAd,CAAD,CAA2BC,GAA3B,CAA+BzC,EAAE,IAAI0C,QAAQ,CAAC1C,EAAD,CAA7C,CAAnE,EAAuH1B,IAAvH,CAA4HxE,IAAI,CAAC,CAAD,CAAhI,EAAqIyE,SAArI,CAA+IC,GAAG,IAAI;AAClJ,eAAKe,QAAL,CAAcf,GAAd;AACH,SAFD;AAGH,OAJD,MAKK;AACD,aAAK6B,cAAL;AACH;AACJ,KATD;;AAUA,SAAKsC,YAAL;AACA,SAAKC,sBAAL,GAA8B,KAAK1F,MAAL,CAAY2F,MAAZ,CAAmBtE,SAAnB,CAA8BuE,CAAD,IAAO;AAC9D,UAAIA,CAAC,YAAYlJ,aAAjB,EAAgC;AAC5B,aAAKuD,eAAL,GAAuB,KAAvB;AACA,aAAKC,eAAL,GAAuB,KAAvB;AACA,aAAKX,UAAL,GAAkB,IAAlB;AACA,aAAKoE,IAAL,GAAY,IAAZ;AACA,aAAKxD,KAAL,GAAa,IAAb;;AACA,YAAI,KAAKxB,QAAT,EAAmB;AACf,eAAKV,IAAL,CAAUsF,GAAV,CAAc,QAAd,EAAwBsC,QAAxB,CAAiC,IAAjC;AACA,eAAK7B,WAAL;AACH,SAHD,MAIK;AACD,eAAKb,cAAL;AACH;;AACD,aAAKxD,KAAL,CAAWuC,aAAX;AACA,aAAKjC,eAAL,GAAuB,IAAvB;AACH;AACJ,KAjB6B,CAA9B;AAkBH;;AACDwF,EAAAA,YAAY,GAAG;AACX,SAAKnG,eAAL,GAAuB,CACnB;AACIyC,MAAAA,IAAI,EAAE,aADV;AAEIkC,MAAAA,SAAS,EAAE,cAFf;AAGI6B,MAAAA,OAAO,EAAE,IAHb;AAII1B,MAAAA,WAAW,EAAE,CACT;AACIrC,QAAAA,IAAI,EAAE,QADV;AAEIsC,QAAAA,KAAK;AAFT,OADS,EAKT;AACItC,QAAAA,IAAI,EAAE,QADV;AAEIsC,QAAAA,KAAK,OAFT;AAGIC,QAAAA,IAAI,EAAE,QAHV;AAIIF,QAAAA,WAAW,EAAE,WAJjB;AAKI2B,QAAAA,WAAW,EAAE,CACT;AACIzB,UAAAA,IAAI,EAAE,UADV;AAEI0B,UAAAA,SAAS,EAAEvJ,UAAU,CAACwJ,QAF1B;AAGIC,UAAAA,OAAO;AAHX,SADS;AALjB,OALS;AAJjB,KADmB,EAyBnB;AACInE,MAAAA,IAAI,EAAE,MADV;AAEIsC,MAAAA,KAAK,QAFT;AAGIhE,MAAAA,KAAK,EAAE,SAHX;AAIIiE,MAAAA,IAAI,EAAE,cAJV;AAKIJ,MAAAA,OAAO,EAAE,UALb;AAMI6B,MAAAA,WAAW,EAAE,CACT;AACIzB,QAAAA,IAAI,EAAE,UADV;AAEI0B,QAAAA,SAAS,EAAEvJ,UAAU,CAACwJ,QAF1B;AAGIC,QAAAA,OAAO;AAHX,OADS;AANjB,KAzBmB,EAuCnB;AACInE,MAAAA,IAAI,EAAE,QADV;AAEIsC,MAAAA,KAAK,mBAFT;AAGIhE,MAAAA,KAAK,EAAE,UAHX;AAIIiE,MAAAA,IAAI,EAAE,gBAJV;AAKIJ,MAAAA,OAAO,EAAE,KAAKrE,MAAL,CAAYsB,iBAAZ,CAA8B,iBAA9B;AALb,KAvCmB,EA8CnB;AACIY,MAAAA,IAAI,EAAE,WADV;AAEIuC,MAAAA,IAAI,EAAE,iBAFV;AAGID,MAAAA,KAAK,uBAHT;AAIIH,MAAAA,OAAO,EAAE,YAJb;AAKIE,MAAAA,WAAW,EAAE,CACT;AACIrC,QAAAA,IAAI,EAAE,gBADV;AAEI;AACAuC,QAAAA,IAAI,EAAE,cAHV;AAIIJ,QAAAA,OAAO,EAAE,iBAJb;AAKIE,QAAAA,WAAW,EAAE,CACT;AACIrC,UAAAA,IAAI,EAAE,QADV;AAEIsC,UAAAA,KAAK,QAFT;AAGIC,UAAAA,IAAI,EAAE,MAHV;AAIIwB,UAAAA,OAAO,EAAE;AAJb,SADS,EAOT;AACI/D,UAAAA,IAAI,EAAE,MADV;AAEIsC,UAAAA,KAAK,gBAFT;AAGIC,UAAAA,IAAI,EAAE,iBAHV;AAIIwB,UAAAA,OAAO,EAAE;AAJb,SAPS,EAaT;AACI/D,UAAAA,IAAI,EAAE,OADV;AAEIsC,UAAAA,KAAK,eAFT;AAGIC,UAAAA,IAAI,EAAE;AAHV,SAbS,EAkBT;AACIvC,UAAAA,IAAI,EAAE,cADV;AAEIuC,UAAAA,IAAI,EAAE,SAFV;AAGIF,UAAAA,WAAW,EAAE,CACT;AACIrC,YAAAA,IAAI,EAAE,OADV;AAEIsC,YAAAA,KAAK,mBAFT;AAGIC,YAAAA,IAAI,EAAE,aAHV;AAIIwB,YAAAA,OAAO,EAAE;AAJb,WADS,EAOT;AACI/D,YAAAA,IAAI,EAAE,OADV;AAEIuC,YAAAA,IAAI,EAAE,YAFV;AAGID,YAAAA,KAAK,eAHT;AAIIyB,YAAAA,OAAO,EAAE;AAJb,WAPS,EAaT;AACI/D,YAAAA,IAAI,EAAE,QADV;AAEIsC,YAAAA,KAAK,sBAFT;AAGIC,YAAAA,IAAI,EAAE,mBAHV;AAIIwB,YAAAA,OAAO,EAAE;AAJb,WAbS,EAmBT;AACI/D,YAAAA,IAAI,EAAE,OADV;AAEIsC,YAAAA,KAAK,0BAFT;AAGIC,YAAAA,IAAI,EAAE,sBAHV;AAIIwB,YAAAA,OAAO,EAAE;AAJb,WAnBS;AAHjB,SAlBS;AALjB,OADS;AALjB,KA9CmB,EA6GnB;AACI/D,MAAAA,IAAI,EAAE,WADV;AAEIuC,MAAAA,IAAI,EAAE,gBAFV;AAGID,MAAAA,KAAK,uBAHT;AAIIH,MAAAA,OAAO,EAAE,YAJb;AAKIE,MAAAA,WAAW,EAAE,CACT;AACIrC,QAAAA,IAAI,EAAE,cADV;AAEIuC,QAAAA,IAAI,EAAE,aAFV;AAGI;AACAJ,QAAAA,OAAO,EAAE,YAJb;AAKIE,QAAAA,WAAW,EAAE,CACT;AACIrC,UAAAA,IAAI,EAAE,qBADV;AAEIsC,UAAAA,KAAK,mBAFT;AAGIC,UAAAA,IAAI,EAAE,MAHV;AAIIwB,UAAAA,OAAO,EAAE;AAJb,SADS,EAOT;AACI/D,UAAAA,IAAI,EAAE,MADV;AAEIsC,UAAAA,KAAK,gBAFT;AAGIC,UAAAA,IAAI,EAAE,iBAHV;AAIIwB,UAAAA,OAAO,EAAE;AAJb,SAPS,EAaT;AACI/D,UAAAA,IAAI,EAAE,eADV;AAEIsC,UAAAA,KAAK,eAFT;AAGIC,UAAAA,IAAI,EAAE,aAHV;AAIIwB,UAAAA,OAAO,EAAE;AAJb,SAbS,EAmBT;AACI/D,UAAAA,IAAI,EAAE,qBADV;AAEIsC,UAAAA,KAAK,sBAFT;AAGIC,UAAAA,IAAI,EAAE,mBAHV;AAIIwB,UAAAA,OAAO,EAAE;AAJb,SAnBS,EAyBT;AACA;AACA;AACA;AACA;AACA;AACA;AACI/D,UAAAA,IAAI,EAAE,cADV;AAEIsC,UAAAA,KAAK,eAFT;AAGIC,UAAAA,IAAI,EAAE,SAHV;AAIIL,UAAAA,SAAS,EAAE,QAJf;AAKIC,UAAAA,OAAO,EAAE,CALb;AAMIE,UAAAA,WAAW,EAAE;AANjB,SA/BS;AALjB,OADS;AALjB,KA7GmB,EAmKnB;AACIrC,MAAAA,IAAI,EAAE,cADV;AAEIuC,MAAAA,IAAI,EAAE,cAFV;AAGID,MAAAA,KAAK,0BAHT;AAIID,MAAAA,WAAW,EAAE,CACT;AACIrC,QAAAA,IAAI,EAAE,QADV;AAEIsC,QAAAA,KAAK,sBAFT;AAGIC,QAAAA,IAAI,EAAE,mBAHV;AAIIF,QAAAA,WAAW,EAAE,WAJjB;AAKIF,QAAAA,OAAO,EAAE,KAAKrE,MAAL,CAAYsG,aAAZ;AALb,OADS;AAJjB,KAnKmB,EAiLnB;AACIpE,MAAAA,IAAI,EAAE,QADV;AAEIsC,MAAAA,KAAK,UAFT;AAGIC,MAAAA,IAAI,EAAE;AAHV,KAjLmB,CAAvB;AAuLH;;AACD8B,EAAAA,WAAW,GAAG;AACV,QAAI,KAAKV,sBAAT,EAAiC;AAC7B,WAAKA,sBAAL,CAA4BW,WAA5B;AACH;AACJ;;AA9bqC;;AAgc1C7G,4BAA4B,CAAC8G,IAA7B,GAAoC,SAASC,oCAAT,CAA8CC,CAA9C,EAAiD;AAAE,SAAO,KAAKA,CAAC,IAAIhH,4BAAV,EAAwCzC,EAAE,CAAC0J,iBAAH,CAAqBzJ,EAAE,CAAC0J,WAAxB,CAAxC,EAA8E3J,EAAE,CAAC0J,iBAAH,CAAqB1J,EAAE,CAAC4J,iBAAxB,CAA9E,EAA0H5J,EAAE,CAAC0J,iBAAH,CAAqBxJ,EAAE,CAAC2J,gBAAxB,CAA1H,EAAqK7J,EAAE,CAAC0J,iBAAH,CAAqBvJ,EAAE,CAAC2J,MAAxB,CAArK,EAAsM9J,EAAE,CAAC0J,iBAAH,CAAqBtJ,EAAE,CAAC2J,SAAxB,CAAtM,EAA0O/J,EAAE,CAAC0J,iBAAH,CAAqBrJ,EAAE,CAAC2J,cAAxB,CAA1O,EAAmRhK,EAAE,CAAC0J,iBAAH,CAAqBrJ,EAAE,CAAC4J,MAAxB,CAAnR,CAAP;AAA6T,CAApZ;;AACAxH,4BAA4B,CAACyH,IAA7B,GAAoC,aAAclK,EAAE,CAACmK,iBAAH,CAAqB;AAAEnF,EAAAA,IAAI,EAAEvC,4BAAR;AAAsC2H,EAAAA,SAAS,EAAE,CAAC,CAAC,sBAAD,CAAD,CAAjD;AAA6EC,EAAAA,KAAK,EAAE,CAApF;AAAuFC,EAAAA,IAAI,EAAE,CAA7F;AAAgGC,EAAAA,MAAM,EAAE,YAAY;AAAE,QAAIC,MAAJ;;AAAY,QAAI,OAAOC,iBAAP,KAA6B,WAA7B,IAA4CA,iBAAhD,EAAmE;AACpQ,YAAMC,wFAAwF,GAAGC,IAAI,CAACC,MAAL,CAAY,YAAZ,CAAjG;AACAJ,MAAAA,MAAM,GAAGE,wFAAT;AACH,KAHoM,MAIhM;AACDF,MAAAA,MAAM,eAAN;AACH;;AAAC,QAAIK,MAAJ;;AAAY,QAAI,OAAOJ,iBAAP,KAA6B,WAA7B,IAA4CA,iBAAhD,EAAmE;AAC7E,YAAMK,wFAAwF,GAAGH,IAAI,CAACC,MAAL,CAAY,YAAZ,CAAjG;AACAC,MAAAA,MAAM,GAAGC,wFAAT;AACH,KAHa,MAIT;AACDD,MAAAA,MAAM,eAAN;AACH;;AAAC,WAAO,CAAC,CAAC,CAAD,EAAI,SAAJ,EAAe,CAAf,EAAkB,MAAlB,CAAD,EAA4B,CAAC,CAAD,EAAI,MAAJ,CAA5B,EAAyC,CAAC,CAAD,EAAI,SAAJ,CAAzC,EAAyDL,MAAzD,EAAiE,CAAC,cAAD,EAAiB,EAAjB,EAAqB,CAArB,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,CAA1C,EAA6C,OAA7C,EAAsD,SAAtD,CAAjE,EAAmI,CAAC,cAAD,EAAiB,EAAjB,EAAqB,CAArB,EAAwB,OAAxB,EAAiC,OAAjC,CAAnI,EAA8K,CAAC,WAAD,EAAcK,MAAd,EAAsB,CAAtB,EAAyB,QAAzB,EAAmC,SAAnC,EAA8C,YAA9C,CAA9K,CAAP;AAAoP,GAZnL;AAYqLE,EAAAA,QAAQ,EAAE,SAASC,qCAAT,CAA+CtK,EAA/C,EAAmDC,GAAnD,EAAwD;AAAE,QAAID,EAAE,GAAG,CAAT,EAAY;AACpUV,MAAAA,EAAE,CAACwB,UAAH,CAAc,CAAd,EAAiBJ,gDAAjB,EAAmE,CAAnE,EAAsE,CAAtE,EAAyE,UAAzE,EAAqF,CAArF;AACApB,MAAAA,EAAE,CAACwB,UAAH,CAAc,CAAd,EAAiBK,2CAAjB,EAA8D,CAA9D,EAAiE,CAAjE,EAAoE,KAApE,EAA2E,CAA3E;AACH;;AAAC,QAAInB,EAAE,GAAG,CAAT,EAAY;AACVV,MAAAA,EAAE,CAACiB,UAAH,CAAc,MAAd,EAAsBN,GAAG,CAACuC,eAA1B;AACAlD,MAAAA,EAAE,CAAC2B,SAAH,CAAa,CAAb;AACA3B,MAAAA,EAAE,CAACiB,UAAH,CAAc,MAAd,EAAsBN,GAAG,CAACwC,eAA1B;AACH;AAAE,GAnBgE;AAmB9D8H,EAAAA,UAAU,EAAE,CAAC3K,EAAE,CAAC4K,IAAJ,EAAU5K,EAAE,CAAC6K,OAAb,EAAsB7K,EAAE,CAAC8K,OAAzB,EAAkC7K,EAAE,CAAC8K,qBAArC,EAA4D7K,EAAE,CAAC8K,oBAA/D,CAnBkD;AAmBoCC,EAAAA,aAAa,EAAE;AAnBnD,CAArB,CAAlD","sourcesContent":["import { Validators } from '@angular/forms';\r\nimport { NavigationEnd } from '@angular/router';\r\nimport { distinctUntilChanged, take } from 'rxjs/operators';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { InventoryDetailsDialogComponent } from './inventory-details-dialog.component';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/forms\";\r\nimport * as i2 from \"./inventory.service\";\r\nimport * as i3 from \"../genral.service\";\r\nimport * as i4 from \"@angular/material/dialog\";\r\nimport * as i5 from \"@angular/router\";\r\nimport * as i6 from \"@angular/common\";\r\nimport * as i7 from \"../components/dynamic-field/dynamic-field.directive\";\r\nimport * as i8 from \"../components/dynamic-form/dynamic-form.component\";\r\nfunction InventoryRelocationComponent_fieldset_0_ng_container_4_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainer(0, 5);\r\n} if (rf & 2) {\r\n    const field_r3 = ctx.$implicit;\r\n    const ctx_r2 = i0.ɵɵnextContext(2);\r\n    i0.ɵɵproperty(\"field\", field_r3)(\"group\", ctx_r2.form);\r\n} }\r\nconst _c2 = function () { return { \"width\": \"90%\" }; };\r\nfunction InventoryRelocationComponent_fieldset_0_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"fieldset\", 2);\r\n    i0.ɵɵelementStart(1, \"legend\");\r\n    i0.ɵɵelementStart(2, \"h1\");\r\n    i0.ɵɵi18n(3, 3);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(4, InventoryRelocationComponent_fieldset_0_ng_container_4_Template, 1, 2, \"ng-container\", 4);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(2, _c2));\r\n    i0.ɵɵadvance(4);\r\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.poConfig);\r\n} }\r\nfunction InventoryRelocationComponent_div_1_Template(rf, ctx) { if (rf & 1) {\r\n    const _r5 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"div\");\r\n    i0.ɵɵelementStart(1, \"dynamic-form\", 6);\r\n    i0.ɵɵlistener(\"submitForm\", function InventoryRelocationComponent_div_1_Template_dynamic_form_submitForm_1_listener($event) { i0.ɵɵrestoreView(_r5); const ctx_r4 = i0.ɵɵnextContext(); return ctx_r4.submit($event); });\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r1 = i0.ɵɵnextContext();\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"fields\", ctx_r1.regConfigHopper)(\"putData\", ctx_r1.dataSource);\r\n} }\r\nexport class InventoryRelocationComponent {\r\n    constructor(fb, cdRef, localService, genral, dialog, _Activatedroute, router) {\r\n        this.fb = fb;\r\n        this.cdRef = cdRef;\r\n        this.localService = localService;\r\n        this.genral = genral;\r\n        this.dialog = dialog;\r\n        this._Activatedroute = _Activatedroute;\r\n        this.router = router;\r\n        this.isDataAvailable = false;\r\n        this.isFormAvailable = false;\r\n        this.isNew = true;\r\n        this.num = 0;\r\n    }\r\n    submit(value) {\r\n        var arr = [];\r\n        var newWarehouse = value['newWarehouse'] ? value['newWarehouse']['warehouseLocation'] : null;\r\n        delete value['newWarehouse'];\r\n        if (value['usedItemsNormal']) {\r\n            value['usedItemsNormal'].forEach(element => {\r\n                // element['measureUnit'] = element['storageMoves'][0]['measureUnit'];\r\n                element['storageMoves'] = element['storageMoves'].filter(amou => amou.numberUsedUnits);\r\n                element['groupName'] = 'normalRelocation';\r\n                element['storageMoves'].forEach(ele => {\r\n                    ele['unitAmount'] = ele['storage']['unitAmount'];\r\n                    ele['numberUnits'] = ele['numberUsedUnits'];\r\n                    ele['warehouseLocation'] = newWarehouse;\r\n                });\r\n            });\r\n            value['usedItemsNormal'] = value['usedItemsNormal'].filter(amou => amou.storageMoves.length);\r\n            arr = arr.concat(value['usedItemsNormal']);\r\n            delete value['usedItemsNormal'];\r\n        }\r\n        if (value['usedItemsTable']) {\r\n            value['usedItemsTable'].forEach(element => {\r\n                element['storageMove']['amounts'] = element['storageMove']['amounts'].filter(amou => amou.take);\r\n                element['storageMove']['amounts'].forEach(ele => {\r\n                    if (!ele['storageId']) {\r\n                        ele['storageId'] = ele['id'];\r\n                        delete ele['id'];\r\n                        ele['storageVersion'] = ele['version'];\r\n                        delete ele['version'];\r\n                    }\r\n                });\r\n                element['storageMove']['newWarehouseLocation'] = newWarehouse;\r\n                element['groupName'] = 'tableRelocation';\r\n                element['measureUnit'] = element['storageMove']['measureUnit'];\r\n            });\r\n            value['usedItemsTable'] = value['usedItemsTable'].filter(amou => amou.storageMove.amounts.length);\r\n            arr = arr.concat(value['usedItemsTable']);\r\n            delete value['usedItemsTable'];\r\n        }\r\n        value['storageMovesGroups'] = arr;\r\n        if (!value['productionLine']) {\r\n            this.genral.getProductionLine('PRODUCT_STORAGE').pipe(take(1)).subscribe(val => {\r\n                value['productionLine'] = val[0];\r\n                this.submitToBackend(value);\r\n            });\r\n        }\r\n        else {\r\n            this.submitToBackend(value);\r\n        }\r\n    }\r\n    submitToBackend(value) {\r\n        this.localService.addEditRelocationTransfer(value, this.isNew).pipe(take(1)).subscribe(val => {\r\n            const dialogRef = this.dialog.open(InventoryDetailsDialogComponent, {\r\n                width: '80%',\r\n                data: { inventoryItem: cloneDeep(val), fromNew: true, type: $localize `Relocation` }\r\n            });\r\n            dialogRef.afterClosed().subscribe(result => {\r\n                if (result === $localize `Edit`) {\r\n                    // this.isDataAvailable = false;\r\n                    this.isFormAvailable = false;\r\n                    this.dataSource = null;\r\n                    this.cdRef.detectChanges();\r\n                    this.localService.getStorageByPo(val['poCode']['id'], val['id']).pipe(take(1)).subscribe(val1 => {\r\n                        this.fillEdit([val, val1]);\r\n                    });\r\n                }\r\n                else {\r\n                    this.router.navigate(['../Reports', { number: 2 }], { relativeTo: this._Activatedroute });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    fillEdit(val) {\r\n        var arrTable = [];\r\n        var arrNormal = [];\r\n        var removeIdsNormal = [];\r\n        var removeIdsTable = [];\r\n        val[0]['storageMovesGroups'].forEach(element => {\r\n            if (element['storageMove']) {\r\n                element['storageMove']['amounts'].forEach(ele => {\r\n                    ele['take'] = true;\r\n                    if (ele['amount'] === ele['numberAvailableUnits']) {\r\n                        removeIdsTable.push(ele['storageId']);\r\n                    }\r\n                    // removeIdsTable.push(ele['id']);\r\n                });\r\n                arrTable.push(element);\r\n                // if(!val[0]['itemCounts'].some( vendor => vendor['item']['value'] === element['storageMove']['item']['value'] )) {\r\n                //     val[0]['itemCounts'].push({item: element['storageMove']['item']});\r\n                // }\r\n            }\r\n            else if (element['storageMoves']) {\r\n                element['storageMoves'].forEach(el => {\r\n                    el['storage']['numberAvailableUnits'] = el['numberAvailableUnits'];\r\n                    // removeIdsNormal.push(el['id']);\r\n                    removeIdsNormal.push(el['storage']['id']);\r\n                    // if(!val[0]['itemCounts'].some( vendor => vendor['item']['value'] === el['item']['value'] )) {\r\n                    //     val[0]['itemCounts'].push({item: el['item']});\r\n                    // }\r\n                });\r\n                arrNormal.push(element);\r\n            }\r\n        });\r\n        const temp = val[0]['storageMovesGroups'][0];\r\n        if (temp['storageMove']) {\r\n            val[0]['newWarehouse'] = { warehouseLocation: temp['storageMove']['newWarehouseLocation'] };\r\n        }\r\n        else {\r\n            val[0]['newWarehouse'] = { warehouseLocation: temp['storageMoves'][0]['warehouseLocation'] };\r\n        }\r\n        delete val[0]['storageMovesGroups'];\r\n        this.dataSource = val[0];\r\n        this.dataSource['usedItemsTable'] = [];\r\n        this.dataSource['usedItemsNormal'] = [];\r\n        this.setAfterChoose(val[1], removeIdsNormal, removeIdsTable);\r\n        if (arrTable.length) {\r\n            this.dataSource['usedItemsTable'] = this.dataSource['usedItemsTable'].concat(arrTable);\r\n        }\r\n        if (arrNormal.length) {\r\n            this.dataSource['usedItemsNormal'] = this.dataSource['usedItemsNormal'].concat(arrNormal);\r\n        }\r\n        this.cleanUnwanted();\r\n        this.isNew = false;\r\n        this.isFormAvailable = true;\r\n    }\r\n    setBeginChoose() {\r\n        this.form = this.fb.group({});\r\n        this.form.addControl('poCode', this.fb.control(''));\r\n        this.form.get('poCode').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\r\n            if (selectedValue && selectedValue.hasOwnProperty('id') && this.poID != selectedValue['id']) {\r\n                this.localService.getStorageByPo(selectedValue['id']).pipe(take(1)).subscribe(val => {\r\n                    this.dataSource = { poCode: selectedValue, usedItemsTable: [], usedItemsNormal: [], itemCounts: [] };\r\n                    this.setAfterChoose(val);\r\n                    this.cleanUnwanted();\r\n                });\r\n                this.isDataAvailable = false;\r\n                this.poID = selectedValue['id'];\r\n            }\r\n        });\r\n        this.isDataAvailable = true;\r\n        this.setPoConfig();\r\n    }\r\n    setPoConfig() {\r\n        this.poConfig = [\r\n            {\r\n                type: 'selectgroup',\r\n                inputType: 'supplierName',\r\n                options: this.localService.getAllCGPos(),\r\n                collections: [\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `Supplier`,\r\n                    },\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `#PO`,\r\n                        name: 'poCode',\r\n                        collections: 'somewhere',\r\n                    },\r\n                ]\r\n            },\r\n        ];\r\n    }\r\n    setAfterChoose(val, removeIdsNormal, removeIdsTable) {\r\n        var arrNormal = [];\r\n        var arrTable = [];\r\n        var arrUsedItems = [];\r\n        val === null || val === void 0 ? void 0 : val.forEach(element => {\r\n            if (element['storage']) {\r\n                if (!removeIdsTable || (element['storage']['amounts'] = element['storage']['amounts'].filter(amou => !removeIdsTable.includes(amou.id))).length) {\r\n                    element['storage']['amounts'].forEach(ele => {\r\n                        ele['amount'] = ele['numberAvailableUnits'];\r\n                    });\r\n                    element['storage']['item'] = element['item'];\r\n                    element['storage']['measureUnit'] = element['measureUnit'];\r\n                    element['storage']['itemProcessDate'] = element['itemProcessDate'];\r\n                    arrTable.push({ storageMove: element['storage'] });\r\n                }\r\n            }\r\n            else if (element['storageForms']) {\r\n                element['storageForms'].forEach(ele => {\r\n                    if (!removeIdsNormal || !removeIdsNormal.includes(ele['id'])) {\r\n                        arrUsedItems.push({ item: element['item'], itemProcessDate: element['itemProcessDate'], measureUnit: element['measureUnit'], storage: ele });\r\n                        delete ele['numberUsedUnits'];\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        if (arrUsedItems.length) {\r\n            arrNormal.push({ storageMoves: arrUsedItems });\r\n        }\r\n        if (arrTable.length) {\r\n            this.dataSource['usedItemsTable'] = arrTable;\r\n        }\r\n        if (arrNormal.length) {\r\n            this.dataSource['usedItemsNormal'] = arrNormal;\r\n        }\r\n        this.isFormAvailable = true;\r\n    }\r\n    cleanUnwanted() {\r\n        if (!this.dataSource['usedItemsTable'].length) {\r\n            var ind = this.regConfigHopper.findIndex((em) => em['name'] === 'usedItemsTable');\r\n            if (ind !== -1) {\r\n                this.regConfigHopper.splice(ind, 1);\r\n            }\r\n        }\r\n        if (!this.dataSource['usedItemsNormal'].length) {\r\n            var ind = this.regConfigHopper.findIndex((em) => em['name'] === 'usedItemsNormal');\r\n            if (ind !== -1) {\r\n                this.regConfigHopper.splice(ind, 1);\r\n            }\r\n        }\r\n    }\r\n    ngOnInit() {\r\n        this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\r\n            if (params.get('id')) {\r\n                this.localService.getStorageTransferWithStorage(+params.get('id'), (params.getAll('poCodes')).map(el => parseInt(el))).pipe(take(1)).subscribe(val => {\r\n                    this.fillEdit(val);\r\n                });\r\n            }\r\n            else {\r\n                this.setBeginChoose();\r\n            }\r\n        });\r\n        this.setRegConfig();\r\n        this.navigationSubscription = this.router.events.subscribe((e) => {\r\n            if (e instanceof NavigationEnd) {\r\n                this.isDataAvailable = false;\r\n                this.isFormAvailable = false;\r\n                this.dataSource = null;\r\n                this.poID = null;\r\n                this.isNew = true;\r\n                if (this.poConfig) {\r\n                    this.form.get('poCode').setValue(null);\r\n                    this.setPoConfig();\r\n                }\r\n                else {\r\n                    this.setBeginChoose();\r\n                }\r\n                this.cdRef.detectChanges();\r\n                this.isDataAvailable = true;\r\n            }\r\n        });\r\n    }\r\n    setRegConfig() {\r\n        this.regConfigHopper = [\r\n            {\r\n                type: 'selectgroup',\r\n                inputType: 'supplierName',\r\n                disable: true,\r\n                collections: [\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `Supllier`,\r\n                    },\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `#PO`,\r\n                        name: 'poCode',\r\n                        collections: 'somewhere',\r\n                        validations: [\r\n                            {\r\n                                name: 'required',\r\n                                validator: Validators.required,\r\n                                message: $localize `#PO Required`,\r\n                            }\r\n                        ]\r\n                    },\r\n                ]\r\n            },\r\n            {\r\n                type: 'date',\r\n                label: $localize `Date`,\r\n                value: 'timeNow',\r\n                name: 'recordedTime',\r\n                options: 'withTime',\r\n                validations: [\r\n                    {\r\n                        name: 'required',\r\n                        validator: Validators.required,\r\n                        message: $localize `Date Required`,\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                type: 'select',\r\n                label: $localize `Production line`,\r\n                value: 'firstVal',\r\n                name: 'productionLine',\r\n                options: this.genral.getProductionLine('PRODUCT_STORAGE'),\r\n            },\r\n            {\r\n                type: 'bigexpand',\r\n                name: 'usedItemsNormal',\r\n                label: $localize `Transfering amounts`,\r\n                options: 'aloneNoAdd',\r\n                collections: [\r\n                    {\r\n                        type: 'tableWithInput',\r\n                        // label: 'Transfer from',\r\n                        name: 'storageMoves',\r\n                        options: 'numberUsedUnits',\r\n                        collections: [\r\n                            {\r\n                                type: 'select',\r\n                                label: $localize `Item`,\r\n                                name: 'item',\r\n                                disable: true,\r\n                            },\r\n                            {\r\n                                type: 'date',\r\n                                label: $localize `Process date`,\r\n                                name: 'itemProcessDate',\r\n                                disable: true,\r\n                            },\r\n                            {\r\n                                type: 'input',\r\n                                label: $localize `Weight unit`,\r\n                                name: 'measureUnit',\r\n                            },\r\n                            {\r\n                                type: 'bignotexpand',\r\n                                name: 'storage',\r\n                                collections: [\r\n                                    {\r\n                                        type: 'input',\r\n                                        label: $localize `Number of units`,\r\n                                        name: 'numberUnits',\r\n                                        disable: true,\r\n                                    },\r\n                                    {\r\n                                        type: 'input',\r\n                                        name: 'unitAmount',\r\n                                        label: $localize `Unit weight`,\r\n                                        disable: true,\r\n                                    },\r\n                                    {\r\n                                        type: 'select',\r\n                                        label: $localize `Warehouse location`,\r\n                                        name: 'warehouseLocation',\r\n                                        disable: true,\r\n                                    },\r\n                                    {\r\n                                        type: 'input',\r\n                                        label: $localize `Number available units`,\r\n                                        name: 'numberAvailableUnits',\r\n                                        disable: true,\r\n                                    },\r\n                                ]\r\n                            },\r\n                        ],\r\n                    },\r\n                ]\r\n            },\r\n            {\r\n                type: 'bigexpand',\r\n                name: 'usedItemsTable',\r\n                label: $localize `Transfering amounts`,\r\n                options: 'aloneNoAdd',\r\n                collections: [\r\n                    {\r\n                        type: 'bignotexpand',\r\n                        name: 'storageMove',\r\n                        // label: 'Transfer from',\r\n                        options: 'aloneNoAdd',\r\n                        collections: [\r\n                            {\r\n                                type: 'inputReadonlySelect',\r\n                                label: $localize `Item descrption`,\r\n                                name: 'item',\r\n                                disable: true,\r\n                            },\r\n                            {\r\n                                type: 'date',\r\n                                label: $localize `Process date`,\r\n                                name: 'itemProcessDate',\r\n                                disable: true,\r\n                            },\r\n                            {\r\n                                type: 'inputReadonly',\r\n                                label: $localize `Weight unit`,\r\n                                name: 'measureUnit',\r\n                                disable: true,\r\n                            },\r\n                            {\r\n                                type: 'inputReadonlySelect',\r\n                                label: $localize `Warehouse location`,\r\n                                name: 'warehouseLocation',\r\n                                disable: true,\r\n                            },\r\n                            //  {\r\n                            //      type: 'inputReadonly',\r\n                            //      label: 'Empty container weight',\r\n                            //      name: 'containerWeight',\r\n                            //      disable: true,\r\n                            //  },\r\n                            {\r\n                                type: 'arrayordinal',\r\n                                label: $localize `Unit weight`,\r\n                                name: 'amounts',\r\n                                inputType: 'choose',\r\n                                options: 3,\r\n                                collections: 30,\r\n                            },\r\n                        ]\r\n                    },\r\n                ]\r\n            },\r\n            {\r\n                type: 'bignotexpand',\r\n                name: 'newWarehouse',\r\n                label: $localize `New warehouse location`,\r\n                collections: [\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `Warehouse location`,\r\n                        name: 'warehouseLocation',\r\n                        collections: 'somewhere',\r\n                        options: this.genral.getWearhouses(),\r\n                    },\r\n                ]\r\n            },\r\n            {\r\n                type: 'button',\r\n                label: $localize `Submit`,\r\n                name: 'submit',\r\n            }\r\n        ];\r\n    }\r\n    ngOnDestroy() {\r\n        if (this.navigationSubscription) {\r\n            this.navigationSubscription.unsubscribe();\r\n        }\r\n    }\r\n}\r\nInventoryRelocationComponent.ɵfac = function InventoryRelocationComponent_Factory(t) { return new (t || InventoryRelocationComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i2.InventoryService), i0.ɵɵdirectiveInject(i3.Genral), i0.ɵɵdirectiveInject(i4.MatDialog), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router)); };\r\nInventoryRelocationComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: InventoryRelocationComponent, selectors: [[\"inventory-relocation\"]], decls: 2, vars: 2, consts: function () { let i18n_0; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__1 = goog.getMsg(\"Relocation\");\r\n        i18n_0 = MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__1;\r\n    }\r\n    else {\r\n        i18n_0 = $localize `:␟74fea1514dba766f715e35c1860ea539dfd65f0b␟2505420053502608096:Relocation`;\r\n    } let i18n_3; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__4 = goog.getMsg(\"Relocation\");\r\n        i18n_3 = MSG_EXTERNAL_2505420053502608096$$SRC_APP_INVENTORY_INVENTORY_RELOACTION_COMPONENT_TS__4;\r\n    }\r\n    else {\r\n        i18n_3 = $localize `:␟74fea1514dba766f715e35c1860ea539dfd65f0b␟2505420053502608096:Relocation`;\r\n    } return [[3, \"ngStyle\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"ngStyle\"], i18n_0, [\"dynamicField\", \"\", 3, \"field\", \"group\", 4, \"ngFor\", \"ngForOf\"], [\"dynamicField\", \"\", 3, \"field\", \"group\"], [\"mainLabel\", i18n_3, 3, \"fields\", \"putData\", \"submitForm\"]]; }, template: function InventoryRelocationComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵtemplate(0, InventoryRelocationComponent_fieldset_0_Template, 5, 3, \"fieldset\", 0);\r\n        i0.ɵɵtemplate(1, InventoryRelocationComponent_div_1_Template, 2, 2, \"div\", 1);\r\n    } if (rf & 2) {\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isDataAvailable);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isFormAvailable);\r\n    } }, directives: [i6.NgIf, i6.NgStyle, i6.NgForOf, i7.DynamicFieldDirective, i8.DynamicFormComponent], encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { distinctUntilChanged, take } from 'rxjs/operators';\nimport { ProductionDetailsDialogComponent } from './production-detailes-dialog.component';\nimport { cloneDeep } from 'lodash-es';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"./production.service\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/checkbox\";\nimport * as i7 from \"../components/dynamic-field/dynamic-field.directive\";\nimport * as i8 from \"./export-import.component\";\n\nfunction ProductionPackingComponent_fieldset_0_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0, 7);\n  }\n\n  if (rf & 2) {\n    const field_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"field\", field_r3)(\"group\", ctx_r2.form);\n  }\n}\n\nconst _c4 = function () {\n  return {\n    \"width\": \"90%\"\n  };\n};\n\nfunction ProductionPackingComponent_fieldset_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"fieldset\", 2);\n    i0.ɵɵelementStart(1, \"legend\");\n    i0.ɵɵelementStart(2, \"h1\");\n    i0.ɵɵi18n(3, 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-checkbox\", 4);\n    i0.ɵɵlistener(\"change\", function ProductionPackingComponent_fieldset_0_Template_mat_checkbox_change_4_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.setWithPacked($event.checked);\n    });\n    i0.ɵɵi18n(5, 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, ProductionPackingComponent_fieldset_0_ng_container_6_Template, 1, 2, \"ng-container\", 6);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(3, _c4));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"checked\", ctx_r0.withPacked);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.poConfig);\n  }\n}\n\nfunction ProductionPackingComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"export-import\", 8);\n    i0.ɵɵlistener(\"submitExIm\", function ProductionPackingComponent_div_1_Template_export_import_submitExIm_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.submit($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"beginData\", ctx_r1.putData)(\"newUsed\", ctx_r1.newUsed)(\"posArray\", ctx_r1.posArray)(\"mainLabel\", \"Pack\");\n  }\n}\n\nexport class ProductionPackingComponent {\n  constructor(_Activatedroute, router, fb, cdRef, localService, dialog) {\n    this._Activatedroute = _Activatedroute;\n    this.router = router;\n    this.fb = fb;\n    this.cdRef = cdRef;\n    this.localService = localService;\n    this.dialog = dialog;\n    this.isDataAvailable = false;\n    this.isFormAvailable = false;\n    this.withPacked = false;\n  }\n\n  submit(value) {\n    this.localService.addEditPackingTransfer(value, this.putData ? false : true).pipe(take(1)).subscribe(val => {\n      const dialogRef = this.dialog.open(ProductionDetailsDialogComponent, {\n        width: '80%',\n        data: {\n          productionCheck: cloneDeep(val),\n          fromNew: true,\n          type: 'Packing'\n        }\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result === \"Edit\") {\n          this.isFormAvailable = false;\n          this.cdRef.detectChanges();\n\n          if (val['weightedPos']) {\n            let pos = val['weightedPos'].map(a => a.poCode.id);\n            this.withPacked = dialogRef.componentInstance.withPacked;\n            this.setEditData(val['id'], pos, dialogRef.componentInstance.addPos);\n          } else {\n            this.localService.getProductionWithStorage(val['id'], val['poCode']['id'], this.withPacked || dialogRef.componentInstance.withPacked ? 'toPackWithPacked' : 'toPack').pipe(take(1)).subscribe(val => {\n              this.putData = val[0];\n              this.newUsed = val[1];\n              this.isFormAvailable = true;\n            });\n          }\n        } else if (result === \"Go to full production report\") {\n          this.router.navigate(['Main/reports/ProductionsByTime']);\n        } else {\n          this.router.navigate(['../Productions', {\n            number: 3\n          }], {\n            relativeTo: this._Activatedroute\n          });\n        }\n      });\n    });\n  }\n\n  setEditData(id, pos, addPos) {\n    if (addPos) {\n      this.form = this.fb.group({});\n      this.form.addControl('mixPos', this.fb.control(''));\n      this.isDataAvailable = true;\n      this.form.get('mixPos').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\n        if (selectedValue && selectedValue.hasOwnProperty('weightedPos')) {\n          this.posArray = selectedValue['weightedPos'];\n          pos = pos.concat(selectedValue['weightedPos'].map(a => a.poCode.id));\n          this.localService.getMixProductionWithStorage(id, pos, this.withPacked).pipe(take(1)).subscribe(val => {\n            this.putData = val[0];\n            this.newUsed = val[1];\n            this.isFormAvailable = true;\n          });\n          this.isDataAvailable = false;\n        }\n      });\n      this.setPoConfig(this.withPacked, true);\n    } else {\n      this.localService.getMixProductionWithStorage(id, pos, this.withPacked).pipe(take(1)).subscribe(val => {\n        this.putData = val[0];\n        this.newUsed = val[1];\n        this.isFormAvailable = true;\n      });\n    }\n  }\n\n  ngOnInit() {\n    this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\n      if (params.get('id')) {\n        this.withPacked = params.get('withPacked') === 'true';\n        this.setEditData(+params.get('id'), params.get('poCodes').split(',').map(Number), params.get('addPos') === 'true');\n      } else {\n        this.setBeginChoose();\n      }\n    });\n\n    this.navigationSubscription = this.router.events.subscribe(e => {\n      // If it is a NavigationEnd event re-initalise the component\n      if (e instanceof NavigationEnd) {\n        this.isDataAvailable = false;\n        this.isFormAvailable = false;\n        this.putData = null;\n        this.newUsed = null;\n        this.posArray = null;\n\n        if (this.poConfig) {\n          this.form.get('poCode').setValue(null);\n          this.form.get('mixPos').setValue(null);\n        } else {\n          this.setBeginChoose();\n        }\n\n        this.cdRef.detectChanges();\n        this.isDataAvailable = true;\n      }\n    });\n  }\n\n  setBeginChoose() {\n    this.form = this.fb.group({});\n    this.form.addControl('poCode', this.fb.control(''));\n    this.form.addControl('mixPos', this.fb.control(''));\n    this.form.get('mixPos').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\n      if (selectedValue && selectedValue.hasOwnProperty('weightedPos')) {\n        //&& selectedValue['poCode']\n        this.posArray = selectedValue['weightedPos'];\n        let pos = selectedValue['weightedPos'].map(a => a.poCode.id);\n        this.localService.getMixStorageToPackPos(pos, this.withPacked).pipe(take(1)).subscribe(val => {\n          this.newUsed = val;\n          this.isFormAvailable = true;\n        });\n        this.isDataAvailable = false;\n      }\n    });\n    this.form.get('poCode').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\n      if (selectedValue && selectedValue.hasOwnProperty('id')) {\n        this.localService.getStorageToPackPo(selectedValue['id'], this.withPacked).pipe(take(1)).subscribe(val => {\n          this.newUsed = val;\n          this.isFormAvailable = true;\n        });\n        this.isDataAvailable = false;\n      }\n    });\n    this.isDataAvailable = true;\n    this.setPoConfig(false, false);\n  }\n\n  setPoConfig(withPack, onlyMix) {\n    this.poConfig = [...(onlyMix ? [] : [{\n      type: 'selectgroup',\n      inputType: 'supplierName',\n      options: this.localService.getAllPosToPack(withPack),\n      collections: [{\n        type: 'select',\n        label: \"Supplier\"\n      }, {\n        type: 'select',\n        label: \"#PO\",\n        name: 'poCode',\n        collections: 'somewhere'\n      }]\n    }]), {\n      type: 'popup',\n      label: \"Mix #PO\",\n      name: 'mixPos',\n      collections: [{\n        type: 'bigexpand',\n        name: 'weightedPos',\n        label: \"Mixed PO#s\",\n        options: 'aloneInline',\n        collections: [{\n          type: 'selectgroup',\n          inputType: 'supplierName',\n          options: this.localService.getAllPosToPack(withPack),\n          collections: [{\n            type: 'select',\n            label: \"Supplier\"\n          }, {\n            type: 'select',\n            label: \"#PO\",\n            name: 'poCode',\n            collections: 'somewhere'\n          }]\n        }, {\n          type: 'divider',\n          inputType: 'divide'\n        }]\n      }, {\n        type: 'button',\n        label: \"Submit\",\n        name: 'submit'\n      }]\n    }];\n  }\n\n  setWithPacked($event) {\n    this.withPacked = $event;\n    this.setPoConfig($event, !this.form.contains('poCode'));\n  }\n\n  ngOnDestroy() {\n    if (this.navigationSubscription) {\n      this.navigationSubscription.unsubscribe();\n    }\n  }\n\n}\n\nProductionPackingComponent.ɵfac = function ProductionPackingComponent_Factory(t) {\n  return new (t || ProductionPackingComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i3.ProductionService), i0.ɵɵdirectiveInject(i4.MatDialog));\n};\n\nProductionPackingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProductionPackingComponent,\n  selectors: [[\"production-packing\"]],\n  decls: 2,\n  vars: 2,\n  consts: function () {\n    let i18n_0;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_875292911519766523$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__1 = goog.getMsg(\"Packing cashew process\");\n      i18n_0 = MSG_EXTERNAL_875292911519766523$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__1;\n    } else {\n      i18n_0 = \"Packing cashew process\";\n    }\n\n    let i18n_2;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_3218216255085474685$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__3 = goog.getMsg(\"With packed\");\n      i18n_2 = MSG_EXTERNAL_3218216255085474685$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__3;\n    } else {\n      i18n_2 = \"With packed\";\n    }\n\n    return [[3, \"ngStyle\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"ngStyle\"], i18n_0, [2, \"padding-right\", \"10px\", 3, \"checked\", \"change\"], i18n_2, [\"dynamicField\", \"\", 3, \"field\", \"group\", 4, \"ngFor\", \"ngForOf\"], [\"dynamicField\", \"\", 3, \"field\", \"group\"], [3, \"beginData\", \"newUsed\", \"posArray\", \"mainLabel\", \"submitExIm\"]];\n  },\n  template: function ProductionPackingComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ProductionPackingComponent_fieldset_0_Template, 7, 4, \"fieldset\", 0);\n      i0.ɵɵtemplate(1, ProductionPackingComponent_div_1_Template, 2, 4, \"div\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.isDataAvailable);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isFormAvailable);\n    }\n  },\n  directives: [i5.NgIf, i5.NgStyle, i6.MatCheckbox, i5.NgForOf, i7.DynamicFieldDirective, i8.ExportImportComponent],\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/isral/OneDrive/Documents/AVC-FRONT/src/app/production/production-packing.component.ts"],"names":["NavigationEnd","distinctUntilChanged","take","ProductionDetailsDialogComponent","cloneDeep","i0","i1","i2","i3","i4","i5","i6","i7","i8","ProductionPackingComponent_fieldset_0_ng_container_6_Template","rf","ctx","ɵɵelementContainer","field_r3","$implicit","ctx_r2","ɵɵnextContext","ɵɵproperty","form","_c4","ProductionPackingComponent_fieldset_0_Template","_r5","ɵɵgetCurrentView","ɵɵelementStart","ɵɵi18n","ɵɵelementEnd","ɵɵlistener","ProductionPackingComponent_fieldset_0_Template_mat_checkbox_change_4_listener","$event","ɵɵrestoreView","ctx_r4","setWithPacked","checked","ɵɵtemplate","ctx_r0","ɵɵpureFunction0","ɵɵadvance","withPacked","poConfig","ProductionPackingComponent_div_1_Template","_r7","ProductionPackingComponent_div_1_Template_export_import_submitExIm_1_listener","ctx_r6","submit","ctx_r1","putData","newUsed","posArray","ProductionPackingComponent","constructor","_Activatedroute","router","fb","cdRef","localService","dialog","isDataAvailable","isFormAvailable","value","addEditPackingTransfer","pipe","subscribe","val","dialogRef","open","width","data","productionCheck","fromNew","type","afterClosed","result","detectChanges","pos","map","a","poCode","id","componentInstance","setEditData","addPos","getProductionWithStorage","navigate","number","relativeTo","group","addControl","control","get","valueChanges","selectedValue","hasOwnProperty","concat","getMixProductionWithStorage","setPoConfig","ngOnInit","paramMap","params","split","Number","setBeginChoose","navigationSubscription","events","e","setValue","getMixStorageToPackPos","getStorageToPackPo","withPack","onlyMix","inputType","options","getAllPosToPack","collections","label","name","contains","ngOnDestroy","unsubscribe","ɵfac","ProductionPackingComponent_Factory","t","ɵɵdirectiveInject","ActivatedRoute","Router","FormBuilder","ChangeDetectorRef","ProductionService","MatDialog","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","i18n_0","ngI18nClosureMode","MSG_EXTERNAL_875292911519766523$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__1","goog","getMsg","i18n_2","MSG_EXTERNAL_3218216255085474685$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__3","template","ProductionPackingComponent_Template","directives","NgIf","NgStyle","MatCheckbox","NgForOf","DynamicFieldDirective","ExportImportComponent","encapsulation"],"mappings":"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","sourcesContent":["import { NavigationEnd } from '@angular/router';\r\nimport { distinctUntilChanged, take } from 'rxjs/operators';\r\nimport { ProductionDetailsDialogComponent } from './production-detailes-dialog.component';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/router\";\r\nimport * as i2 from \"@angular/forms\";\r\nimport * as i3 from \"./production.service\";\r\nimport * as i4 from \"@angular/material/dialog\";\r\nimport * as i5 from \"@angular/common\";\r\nimport * as i6 from \"@angular/material/checkbox\";\r\nimport * as i7 from \"../components/dynamic-field/dynamic-field.directive\";\r\nimport * as i8 from \"./export-import.component\";\r\nfunction ProductionPackingComponent_fieldset_0_ng_container_6_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainer(0, 7);\r\n} if (rf & 2) {\r\n    const field_r3 = ctx.$implicit;\r\n    const ctx_r2 = i0.ɵɵnextContext(2);\r\n    i0.ɵɵproperty(\"field\", field_r3)(\"group\", ctx_r2.form);\r\n} }\r\nconst _c4 = function () { return { \"width\": \"90%\" }; };\r\nfunction ProductionPackingComponent_fieldset_0_Template(rf, ctx) { if (rf & 1) {\r\n    const _r5 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"fieldset\", 2);\r\n    i0.ɵɵelementStart(1, \"legend\");\r\n    i0.ɵɵelementStart(2, \"h1\");\r\n    i0.ɵɵi18n(3, 3);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(4, \"mat-checkbox\", 4);\r\n    i0.ɵɵlistener(\"change\", function ProductionPackingComponent_fieldset_0_Template_mat_checkbox_change_4_listener($event) { i0.ɵɵrestoreView(_r5); const ctx_r4 = i0.ɵɵnextContext(); return ctx_r4.setWithPacked($event.checked); });\r\n    i0.ɵɵi18n(5, 5);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(6, ProductionPackingComponent_fieldset_0_ng_container_6_Template, 1, 2, \"ng-container\", 6);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(3, _c4));\r\n    i0.ɵɵadvance(4);\r\n    i0.ɵɵproperty(\"checked\", ctx_r0.withPacked);\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.poConfig);\r\n} }\r\nfunction ProductionPackingComponent_div_1_Template(rf, ctx) { if (rf & 1) {\r\n    const _r7 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"div\");\r\n    i0.ɵɵelementStart(1, \"export-import\", 8);\r\n    i0.ɵɵlistener(\"submitExIm\", function ProductionPackingComponent_div_1_Template_export_import_submitExIm_1_listener($event) { i0.ɵɵrestoreView(_r7); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.submit($event); });\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r1 = i0.ɵɵnextContext();\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"beginData\", ctx_r1.putData)(\"newUsed\", ctx_r1.newUsed)(\"posArray\", ctx_r1.posArray)(\"mainLabel\", \"Pack\");\r\n} }\r\nexport class ProductionPackingComponent {\r\n    constructor(_Activatedroute, router, fb, cdRef, localService, dialog) {\r\n        this._Activatedroute = _Activatedroute;\r\n        this.router = router;\r\n        this.fb = fb;\r\n        this.cdRef = cdRef;\r\n        this.localService = localService;\r\n        this.dialog = dialog;\r\n        this.isDataAvailable = false;\r\n        this.isFormAvailable = false;\r\n        this.withPacked = false;\r\n    }\r\n    submit(value) {\r\n        this.localService.addEditPackingTransfer(value, this.putData ? false : true).pipe(take(1)).subscribe(val => {\r\n            const dialogRef = this.dialog.open(ProductionDetailsDialogComponent, {\r\n                width: '80%',\r\n                data: { productionCheck: cloneDeep(val), fromNew: true, type: 'Packing' }\r\n            });\r\n            dialogRef.afterClosed().subscribe(result => {\r\n                if (result === $localize `Edit`) {\r\n                    this.isFormAvailable = false;\r\n                    this.cdRef.detectChanges();\r\n                    if (val['weightedPos']) {\r\n                        let pos = val['weightedPos'].map(a => a.poCode.id);\r\n                        this.withPacked = dialogRef.componentInstance.withPacked;\r\n                        this.setEditData(val['id'], pos, dialogRef.componentInstance.addPos);\r\n                    }\r\n                    else {\r\n                        this.localService.getProductionWithStorage(val['id'], val['poCode']['id'], this.withPacked || dialogRef.componentInstance.withPacked ? 'toPackWithPacked' : 'toPack').pipe(take(1)).subscribe(val => {\r\n                            this.putData = val[0];\r\n                            this.newUsed = val[1];\r\n                            this.isFormAvailable = true;\r\n                        });\r\n                    }\r\n                }\r\n                else if (result === $localize `Go to full production report`) {\r\n                    this.router.navigate(['Main/reports/ProductionsByTime']);\r\n                }\r\n                else {\r\n                    this.router.navigate(['../Productions', { number: 3 }], { relativeTo: this._Activatedroute });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    setEditData(id, pos, addPos) {\r\n        if (addPos) {\r\n            this.form = this.fb.group({});\r\n            this.form.addControl('mixPos', this.fb.control(''));\r\n            this.isDataAvailable = true;\r\n            this.form.get('mixPos').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\r\n                if (selectedValue && selectedValue.hasOwnProperty('weightedPos')) {\r\n                    this.posArray = selectedValue['weightedPos'];\r\n                    pos = pos.concat(selectedValue['weightedPos'].map(a => a.poCode.id));\r\n                    this.localService.getMixProductionWithStorage(id, pos, this.withPacked).pipe(take(1)).subscribe(val => {\r\n                        this.putData = val[0];\r\n                        this.newUsed = val[1];\r\n                        this.isFormAvailable = true;\r\n                    });\r\n                    this.isDataAvailable = false;\r\n                }\r\n            });\r\n            this.setPoConfig(this.withPacked, true);\r\n        }\r\n        else {\r\n            this.localService.getMixProductionWithStorage(id, pos, this.withPacked).pipe(take(1)).subscribe(val => {\r\n                this.putData = val[0];\r\n                this.newUsed = val[1];\r\n                this.isFormAvailable = true;\r\n            });\r\n        }\r\n    }\r\n    ngOnInit() {\r\n        this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\r\n            if (params.get('id')) {\r\n                this.withPacked = params.get('withPacked') === 'true';\r\n                this.setEditData(+params.get('id'), (params.get('poCodes')).split(',').map(Number), params.get('addPos') === 'true');\r\n            }\r\n            else {\r\n                this.setBeginChoose();\r\n            }\r\n        });\r\n        this.navigationSubscription = this.router.events.subscribe((e) => {\r\n            // If it is a NavigationEnd event re-initalise the component\r\n            if (e instanceof NavigationEnd) {\r\n                this.isDataAvailable = false;\r\n                this.isFormAvailable = false;\r\n                this.putData = null;\r\n                this.newUsed = null;\r\n                this.posArray = null;\r\n                if (this.poConfig) {\r\n                    this.form.get('poCode').setValue(null);\r\n                    this.form.get('mixPos').setValue(null);\r\n                }\r\n                else {\r\n                    this.setBeginChoose();\r\n                }\r\n                this.cdRef.detectChanges();\r\n                this.isDataAvailable = true;\r\n            }\r\n        });\r\n    }\r\n    setBeginChoose() {\r\n        this.form = this.fb.group({});\r\n        this.form.addControl('poCode', this.fb.control(''));\r\n        this.form.addControl('mixPos', this.fb.control(''));\r\n        this.form.get('mixPos').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\r\n            if (selectedValue && selectedValue.hasOwnProperty('weightedPos')) { //&& selectedValue['poCode']\r\n                this.posArray = selectedValue['weightedPos'];\r\n                let pos = selectedValue['weightedPos'].map(a => a.poCode.id);\r\n                this.localService.getMixStorageToPackPos(pos, this.withPacked).pipe(take(1)).subscribe(val => {\r\n                    this.newUsed = val;\r\n                    this.isFormAvailable = true;\r\n                });\r\n                this.isDataAvailable = false;\r\n            }\r\n        });\r\n        this.form.get('poCode').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\r\n            if (selectedValue && selectedValue.hasOwnProperty('id')) {\r\n                this.localService.getStorageToPackPo(selectedValue['id'], this.withPacked).pipe(take(1)).subscribe(val => {\r\n                    this.newUsed = val;\r\n                    this.isFormAvailable = true;\r\n                });\r\n                this.isDataAvailable = false;\r\n            }\r\n        });\r\n        this.isDataAvailable = true;\r\n        this.setPoConfig(false, false);\r\n    }\r\n    setPoConfig(withPack, onlyMix) {\r\n        this.poConfig = [\r\n            ...onlyMix ? [] : [\r\n                {\r\n                    type: 'selectgroup',\r\n                    inputType: 'supplierName',\r\n                    options: this.localService.getAllPosToPack(withPack),\r\n                    collections: [\r\n                        {\r\n                            type: 'select',\r\n                            label: $localize `Supplier`,\r\n                        },\r\n                        {\r\n                            type: 'select',\r\n                            label: $localize `#PO`,\r\n                            name: 'poCode',\r\n                            collections: 'somewhere',\r\n                        },\r\n                    ]\r\n                }\r\n            ],\r\n            {\r\n                type: 'popup',\r\n                label: $localize `Mix #PO`,\r\n                name: 'mixPos',\r\n                collections: [\r\n                    {\r\n                        type: 'bigexpand',\r\n                        name: 'weightedPos',\r\n                        label: $localize `Mixed PO#s`,\r\n                        options: 'aloneInline',\r\n                        collections: [\r\n                            {\r\n                                type: 'selectgroup',\r\n                                inputType: 'supplierName',\r\n                                options: this.localService.getAllPosToPack(withPack),\r\n                                collections: [\r\n                                    {\r\n                                        type: 'select',\r\n                                        label: $localize `Supplier`,\r\n                                    },\r\n                                    {\r\n                                        type: 'select',\r\n                                        label: $localize `#PO`,\r\n                                        name: 'poCode',\r\n                                        collections: 'somewhere',\r\n                                    },\r\n                                ]\r\n                            },\r\n                            {\r\n                                type: 'divider',\r\n                                inputType: 'divide'\r\n                            },\r\n                        ]\r\n                    },\r\n                    {\r\n                        type: 'button',\r\n                        label: $localize `Submit`,\r\n                        name: 'submit',\r\n                    }\r\n                ]\r\n            },\r\n        ];\r\n    }\r\n    setWithPacked($event) {\r\n        this.withPacked = $event;\r\n        this.setPoConfig($event, !this.form.contains('poCode'));\r\n    }\r\n    ngOnDestroy() {\r\n        if (this.navigationSubscription) {\r\n            this.navigationSubscription.unsubscribe();\r\n        }\r\n    }\r\n}\r\nProductionPackingComponent.ɵfac = function ProductionPackingComponent_Factory(t) { return new (t || ProductionPackingComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i3.ProductionService), i0.ɵɵdirectiveInject(i4.MatDialog)); };\r\nProductionPackingComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ProductionPackingComponent, selectors: [[\"production-packing\"]], decls: 2, vars: 2, consts: function () { let i18n_0; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_875292911519766523$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__1 = goog.getMsg(\"Packing cashew process\");\r\n        i18n_0 = MSG_EXTERNAL_875292911519766523$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__1;\r\n    }\r\n    else {\r\n        i18n_0 = $localize `:␟cc28d20e3f03256b946cfcb5b14061db1ba679be␟875292911519766523:Packing cashew process`;\r\n    } let i18n_2; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_3218216255085474685$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__3 = goog.getMsg(\"With packed\");\r\n        i18n_2 = MSG_EXTERNAL_3218216255085474685$$SRC_APP_PRODUCTION_PRODUCTION_PACKING_COMPONENT_TS__3;\r\n    }\r\n    else {\r\n        i18n_2 = $localize `:␟9daae7cfa2f794a1abf77b58f8c968be95cef9bc␟3218216255085474685:With packed`;\r\n    } return [[3, \"ngStyle\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"ngStyle\"], i18n_0, [2, \"padding-right\", \"10px\", 3, \"checked\", \"change\"], i18n_2, [\"dynamicField\", \"\", 3, \"field\", \"group\", 4, \"ngFor\", \"ngForOf\"], [\"dynamicField\", \"\", 3, \"field\", \"group\"], [3, \"beginData\", \"newUsed\", \"posArray\", \"mainLabel\", \"submitExIm\"]]; }, template: function ProductionPackingComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵtemplate(0, ProductionPackingComponent_fieldset_0_Template, 7, 4, \"fieldset\", 0);\r\n        i0.ɵɵtemplate(1, ProductionPackingComponent_div_1_Template, 2, 4, \"div\", 1);\r\n    } if (rf & 2) {\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isDataAvailable);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isFormAvailable);\r\n    } }, directives: [i5.NgIf, i5.NgStyle, i6.MatCheckbox, i5.NgForOf, i7.DynamicFieldDirective, i8.ExportImportComponent], encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}
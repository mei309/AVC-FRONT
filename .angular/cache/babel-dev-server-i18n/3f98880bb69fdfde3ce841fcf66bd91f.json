{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { distinctUntilChanged, take } from 'rxjs/operators';\nimport { cloneDeep } from 'lodash-es';\nimport { RelocationsDetailsDialogComponent } from './relocations-details-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"./relocations.service\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../components/dynamic-field/dynamic-field.directive\";\nimport * as i7 from \"./exp-imp-relocation.component\";\n\nfunction RelocationWeighingComponent_fieldset_0_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0, 5);\n  }\n\n  if (rf & 2) {\n    const field_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"field\", field_r3)(\"group\", ctx_r2.form);\n  }\n}\n\nconst _c2 = function () {\n  return {\n    \"width\": \"90%\"\n  };\n};\n\nfunction RelocationWeighingComponent_fieldset_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"fieldset\", 2);\n    i0.ɵɵelementStart(1, \"legend\");\n    i0.ɵɵelementStart(2, \"h1\");\n    i0.ɵɵi18n(3, 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, RelocationWeighingComponent_fieldset_0_ng_container_4_Template, 1, 2, \"ng-container\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(2, _c2));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.poConfig);\n  }\n}\n\nfunction RelocationWeighingComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"exp-imp-relocation\", 6);\n    i0.ɵɵlistener(\"submitExIm\", function RelocationWeighingComponent_div_1_Template_exp_imp_relocation_submitExIm_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.submit($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"beginData\", ctx_r1.putData)(\"newUsed\", ctx_r1.newUsed)(\"num\", ctx_r1.num);\n  }\n}\n\nexport class RelocationWeighingComponent {\n  constructor(_Activatedroute, router, fb, cdRef, localService, dialog) {\n    this._Activatedroute = _Activatedroute;\n    this.router = router;\n    this.fb = fb;\n    this.cdRef = cdRef;\n    this.localService = localService;\n    this.dialog = dialog;\n    this.isDataAvailable = false;\n    this.isFormAvailable = false;\n    this.num = 0;\n  }\n\n  submit(value) {\n    this.localService.addEditRelocationTransfer(value, this.putData ? false : true).pipe(take(1)).subscribe(val => {\n      const dialogRef = this.dialog.open(RelocationsDetailsDialogComponent, {\n        width: '80%',\n        data: {\n          relocationsItem: cloneDeep(val),\n          fromNew: true,\n          type: this.num ? 'Clean transfering amounts' : 'Raw transfering amounts'\n        }\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result === \"Edit\") {\n          this.isFormAvailable = false;\n          this.cdRef.detectChanges();\n          this.localService.getStorageTransferWithStorage(val['id'], [val['poCode']['id']], this.num).pipe(take(1)).subscribe(val1 => {\n            this.putData = val1[0];\n            this.newUsed = val1[1];\n            this.isFormAvailable = true;\n          });\n        } else {\n          this.router.navigate(['../RelocationsReports', {\n            number: this.num\n          }], {\n            relativeTo: this._Activatedroute\n          });\n        }\n      });\n    });\n  }\n\n  ngOnInit() {\n    this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\n      if (params.get('num')) {\n        this.num = +params.get('num');\n      }\n\n      if (params.get('id')) {\n        this.localService.getStorageTransferWithStorage(+params.get('id'), params.getAll('poCodes').map(el => parseInt(el)), this.num).pipe(take(1)).subscribe(val => {\n          this.putData = val[0];\n          this.newUsed = val[1];\n          this.isFormAvailable = true;\n        });\n      } else {\n        this.setBeginChoose();\n        this.setRegConfig();\n      }\n    });\n\n    this.navigationSubscription = this.router.events.subscribe(e => {\n      // If it is a NavigationEnd event re-initalise the component\n      if (e instanceof NavigationEnd) {\n        this.isDataAvailable = false;\n        this.isFormAvailable = false;\n        this.putData = null;\n        this.newUsed = null;\n\n        this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\n          if (params.get('num')) {\n            this.num = +params.get('num');\n          } else {\n            this.num = 0;\n          }\n        });\n\n        if (this.poConfig) {\n          this.form.get('poCode').setValue(null);\n        } else {\n          this.setBeginChoose();\n        }\n\n        this.setRegConfig();\n        this.cdRef.detectChanges();\n        this.isDataAvailable = true;\n      }\n    });\n  }\n\n  setBeginChoose() {\n    this.form = this.fb.group({});\n    this.form.addControl('poCode', this.fb.control(''));\n    this.form.get('poCode').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\n      if (selectedValue && selectedValue.hasOwnProperty('id')) {\n        this.localService.getStorageByPo(selectedValue['id'], this.num).pipe(take(1)).subscribe(val => {\n          this.newUsed = val;\n          this.isFormAvailable = true;\n        });\n        this.isDataAvailable = false;\n      }\n    });\n    this.isDataAvailable = true;\n  }\n\n  setRegConfig() {\n    this.poConfig = [{\n      type: 'selectgroup',\n      inputType: 'supplierName',\n      options: this.localService.getAllPos(this.num),\n      collections: [{\n        type: 'select',\n        label: \"Supplier\"\n      }, {\n        type: 'select',\n        label: \"#PO\",\n        name: 'poCode',\n        collections: 'somewhere'\n      }]\n    }];\n  }\n\n  ngOnDestroy() {\n    if (this.navigationSubscription) {\n      this.navigationSubscription.unsubscribe();\n    }\n  }\n\n}\n\nRelocationWeighingComponent.ɵfac = function RelocationWeighingComponent_Factory(t) {\n  return new (t || RelocationWeighingComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i3.RelocationsService), i0.ɵɵdirectiveInject(i4.MatDialog));\n};\n\nRelocationWeighingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RelocationWeighingComponent,\n  selectors: [[\"relocation-weighing\"]],\n  decls: 2,\n  vars: 2,\n  consts: function () {\n    let i18n_0;\n\n    if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n      const MSG_EXTERNAL_1428462997297418419$$SRC_APP_RELOCATIONS_RELOCATION_WEIGHING_COMPONENT_TS__1 = goog.getMsg(\"Cleaning cashew process\");\n      i18n_0 = MSG_EXTERNAL_1428462997297418419$$SRC_APP_RELOCATIONS_RELOCATION_WEIGHING_COMPONENT_TS__1;\n    } else {\n      i18n_0 = \"Cleaning cashew process\";\n    }\n\n    return [[3, \"ngStyle\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"ngStyle\"], i18n_0, [\"dynamicField\", \"\", 3, \"field\", \"group\", 4, \"ngFor\", \"ngForOf\"], [\"dynamicField\", \"\", 3, \"field\", \"group\"], [3, \"beginData\", \"newUsed\", \"num\", \"submitExIm\"]];\n  },\n  template: function RelocationWeighingComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, RelocationWeighingComponent_fieldset_0_Template, 5, 3, \"fieldset\", 0);\n      i0.ɵɵtemplate(1, RelocationWeighingComponent_div_1_Template, 2, 3, \"div\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.isDataAvailable);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isFormAvailable);\n    }\n  },\n  directives: [i5.NgIf, i5.NgStyle, i5.NgForOf, i6.DynamicFieldDirective, i7.ExpImpRelocationComponent],\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/isral/OneDrive/Documents/AVC-FRONT/src/app/relocations/relocation-weighing.component.ts"],"names":["NavigationEnd","distinctUntilChanged","take","cloneDeep","RelocationsDetailsDialogComponent","i0","i1","i2","i3","i4","i5","i6","i7","RelocationWeighingComponent_fieldset_0_ng_container_4_Template","rf","ctx","ɵɵelementContainer","field_r3","$implicit","ctx_r2","ɵɵnextContext","ɵɵproperty","form","_c2","RelocationWeighingComponent_fieldset_0_Template","ɵɵelementStart","ɵɵi18n","ɵɵelementEnd","ɵɵtemplate","ctx_r0","ɵɵpureFunction0","ɵɵadvance","poConfig","RelocationWeighingComponent_div_1_Template","_r5","ɵɵgetCurrentView","ɵɵlistener","RelocationWeighingComponent_div_1_Template_exp_imp_relocation_submitExIm_1_listener","$event","ɵɵrestoreView","ctx_r4","submit","ctx_r1","putData","newUsed","num","RelocationWeighingComponent","constructor","_Activatedroute","router","fb","cdRef","localService","dialog","isDataAvailable","isFormAvailable","value","addEditRelocationTransfer","pipe","subscribe","val","dialogRef","open","width","data","relocationsItem","fromNew","type","afterClosed","result","detectChanges","getStorageTransferWithStorage","val1","navigate","number","relativeTo","ngOnInit","paramMap","params","get","getAll","map","el","parseInt","setBeginChoose","setRegConfig","navigationSubscription","events","e","setValue","group","addControl","control","valueChanges","selectedValue","hasOwnProperty","getStorageByPo","inputType","options","getAllPos","collections","label","name","ngOnDestroy","unsubscribe","ɵfac","RelocationWeighingComponent_Factory","t","ɵɵdirectiveInject","ActivatedRoute","Router","FormBuilder","ChangeDetectorRef","RelocationsService","MatDialog","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","i18n_0","ngI18nClosureMode","MSG_EXTERNAL_1428462997297418419$$SRC_APP_RELOCATIONS_RELOCATION_WEIGHING_COMPONENT_TS__1","goog","getMsg","template","RelocationWeighingComponent_Template","directives","NgIf","NgStyle","NgForOf","DynamicFieldDirective","ExpImpRelocationComponent","encapsulation"],"mappings":"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","sourcesContent":["import { NavigationEnd } from '@angular/router';\r\nimport { distinctUntilChanged, take } from 'rxjs/operators';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { RelocationsDetailsDialogComponent } from './relocations-details-dialog.component';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/router\";\r\nimport * as i2 from \"@angular/forms\";\r\nimport * as i3 from \"./relocations.service\";\r\nimport * as i4 from \"@angular/material/dialog\";\r\nimport * as i5 from \"@angular/common\";\r\nimport * as i6 from \"../components/dynamic-field/dynamic-field.directive\";\r\nimport * as i7 from \"./exp-imp-relocation.component\";\r\nfunction RelocationWeighingComponent_fieldset_0_ng_container_4_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainer(0, 5);\r\n} if (rf & 2) {\r\n    const field_r3 = ctx.$implicit;\r\n    const ctx_r2 = i0.ɵɵnextContext(2);\r\n    i0.ɵɵproperty(\"field\", field_r3)(\"group\", ctx_r2.form);\r\n} }\r\nconst _c2 = function () { return { \"width\": \"90%\" }; };\r\nfunction RelocationWeighingComponent_fieldset_0_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"fieldset\", 2);\r\n    i0.ɵɵelementStart(1, \"legend\");\r\n    i0.ɵɵelementStart(2, \"h1\");\r\n    i0.ɵɵi18n(3, 3);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(4, RelocationWeighingComponent_fieldset_0_ng_container_4_Template, 1, 2, \"ng-container\", 4);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(2, _c2));\r\n    i0.ɵɵadvance(4);\r\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.poConfig);\r\n} }\r\nfunction RelocationWeighingComponent_div_1_Template(rf, ctx) { if (rf & 1) {\r\n    const _r5 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"div\");\r\n    i0.ɵɵelementStart(1, \"exp-imp-relocation\", 6);\r\n    i0.ɵɵlistener(\"submitExIm\", function RelocationWeighingComponent_div_1_Template_exp_imp_relocation_submitExIm_1_listener($event) { i0.ɵɵrestoreView(_r5); const ctx_r4 = i0.ɵɵnextContext(); return ctx_r4.submit($event); });\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r1 = i0.ɵɵnextContext();\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"beginData\", ctx_r1.putData)(\"newUsed\", ctx_r1.newUsed)(\"num\", ctx_r1.num);\r\n} }\r\nexport class RelocationWeighingComponent {\r\n    constructor(_Activatedroute, router, fb, cdRef, localService, dialog) {\r\n        this._Activatedroute = _Activatedroute;\r\n        this.router = router;\r\n        this.fb = fb;\r\n        this.cdRef = cdRef;\r\n        this.localService = localService;\r\n        this.dialog = dialog;\r\n        this.isDataAvailable = false;\r\n        this.isFormAvailable = false;\r\n        this.num = 0;\r\n    }\r\n    submit(value) {\r\n        this.localService.addEditRelocationTransfer(value, this.putData ? false : true).pipe(take(1)).subscribe(val => {\r\n            const dialogRef = this.dialog.open(RelocationsDetailsDialogComponent, {\r\n                width: '80%',\r\n                data: { relocationsItem: cloneDeep(val), fromNew: true, type: this.num ? 'Clean transfering amounts' : 'Raw transfering amounts' }\r\n            });\r\n            dialogRef.afterClosed().subscribe(result => {\r\n                if (result === $localize `Edit`) {\r\n                    this.isFormAvailable = false;\r\n                    this.cdRef.detectChanges();\r\n                    this.localService.getStorageTransferWithStorage(val['id'], [val['poCode']['id']], this.num).pipe(take(1)).subscribe(val1 => {\r\n                        this.putData = val1[0];\r\n                        this.newUsed = val1[1];\r\n                        this.isFormAvailable = true;\r\n                    });\r\n                }\r\n                else {\r\n                    this.router.navigate(['../RelocationsReports', { number: this.num }], { relativeTo: this._Activatedroute });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    ngOnInit() {\r\n        this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\r\n            if (params.get('num')) {\r\n                this.num = +params.get('num');\r\n            }\r\n            if (params.get('id')) {\r\n                this.localService.getStorageTransferWithStorage(+params.get('id'), (params.getAll('poCodes')).map(el => parseInt(el)), this.num).pipe(take(1)).subscribe(val => {\r\n                    this.putData = val[0];\r\n                    this.newUsed = val[1];\r\n                    this.isFormAvailable = true;\r\n                });\r\n            }\r\n            else {\r\n                this.setBeginChoose();\r\n                this.setRegConfig();\r\n            }\r\n        });\r\n        this.navigationSubscription = this.router.events.subscribe((e) => {\r\n            // If it is a NavigationEnd event re-initalise the component\r\n            if (e instanceof NavigationEnd) {\r\n                this.isDataAvailable = false;\r\n                this.isFormAvailable = false;\r\n                this.putData = null;\r\n                this.newUsed = null;\r\n                this._Activatedroute.paramMap.pipe(take(1)).subscribe(params => {\r\n                    if (params.get('num')) {\r\n                        this.num = +params.get('num');\r\n                    }\r\n                    else {\r\n                        this.num = 0;\r\n                    }\r\n                });\r\n                if (this.poConfig) {\r\n                    this.form.get('poCode').setValue(null);\r\n                }\r\n                else {\r\n                    this.setBeginChoose();\r\n                }\r\n                this.setRegConfig();\r\n                this.cdRef.detectChanges();\r\n                this.isDataAvailable = true;\r\n            }\r\n        });\r\n    }\r\n    setBeginChoose() {\r\n        this.form = this.fb.group({});\r\n        this.form.addControl('poCode', this.fb.control(''));\r\n        this.form.get('poCode').valueChanges.pipe(distinctUntilChanged()).subscribe(selectedValue => {\r\n            if (selectedValue && selectedValue.hasOwnProperty('id')) {\r\n                this.localService.getStorageByPo(selectedValue['id'], this.num).pipe(take(1)).subscribe(val => {\r\n                    this.newUsed = val;\r\n                    this.isFormAvailable = true;\r\n                });\r\n                this.isDataAvailable = false;\r\n            }\r\n        });\r\n        this.isDataAvailable = true;\r\n    }\r\n    setRegConfig() {\r\n        this.poConfig = [\r\n            {\r\n                type: 'selectgroup',\r\n                inputType: 'supplierName',\r\n                options: this.localService.getAllPos(this.num),\r\n                collections: [\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `Supplier`,\r\n                    },\r\n                    {\r\n                        type: 'select',\r\n                        label: $localize `#PO`,\r\n                        name: 'poCode',\r\n                        collections: 'somewhere',\r\n                    },\r\n                ]\r\n            },\r\n        ];\r\n    }\r\n    ngOnDestroy() {\r\n        if (this.navigationSubscription) {\r\n            this.navigationSubscription.unsubscribe();\r\n        }\r\n    }\r\n}\r\nRelocationWeighingComponent.ɵfac = function RelocationWeighingComponent_Factory(t) { return new (t || RelocationWeighingComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i3.RelocationsService), i0.ɵɵdirectiveInject(i4.MatDialog)); };\r\nRelocationWeighingComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: RelocationWeighingComponent, selectors: [[\"relocation-weighing\"]], decls: 2, vars: 2, consts: function () { let i18n_0; if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\r\n        const MSG_EXTERNAL_1428462997297418419$$SRC_APP_RELOCATIONS_RELOCATION_WEIGHING_COMPONENT_TS__1 = goog.getMsg(\"Cleaning cashew process\");\r\n        i18n_0 = MSG_EXTERNAL_1428462997297418419$$SRC_APP_RELOCATIONS_RELOCATION_WEIGHING_COMPONENT_TS__1;\r\n    }\r\n    else {\r\n        i18n_0 = $localize `:␟6a6c9e86963742ac999bdcf7b682a4483e4a26c7␟1428462997297418419:Cleaning cashew process`;\r\n    } return [[3, \"ngStyle\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"ngStyle\"], i18n_0, [\"dynamicField\", \"\", 3, \"field\", \"group\", 4, \"ngFor\", \"ngForOf\"], [\"dynamicField\", \"\", 3, \"field\", \"group\"], [3, \"beginData\", \"newUsed\", \"num\", \"submitExIm\"]]; }, template: function RelocationWeighingComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵtemplate(0, RelocationWeighingComponent_fieldset_0_Template, 5, 3, \"fieldset\", 0);\r\n        i0.ɵɵtemplate(1, RelocationWeighingComponent_div_1_Template, 2, 3, \"div\", 1);\r\n    } if (rf & 2) {\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isDataAvailable);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isFormAvailable);\r\n    } }, directives: [i5.NgIf, i5.NgStyle, i5.NgForOf, i6.DynamicFieldDirective, i7.ExpImpRelocationComponent], encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}